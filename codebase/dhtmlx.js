/*
Copyright DHTMLX LTD. http://www.dhtmlx.com
To use this library please contact sales@dhtmlx.com to obtain license
*/
dhtmlx=function(a){for(var c in a)dhtmlx[c]=a[c];return dhtmlx};dhtmlx.extend_api=function(a,c,b){var d=window[a];if(d)window[a]=function(a){if(a&&typeof a=="object"&&!a.tagName){var b=d.apply(this,c._init?c._init(a):arguments),g;for(g in dhtmlx)if(c[g])this[c[g]](dhtmlx[g]);for(g in a)if(c[g])this[c[g]](a[g]);else g.indexOf("on")==0&&this.attachEvent(g,a[g])}else b=d.apply(this,arguments);c._patch&&c._patch(this);return b||this},window[a].prototype=d.prototype,b&&dhtmlXHeir(window[a].prototype,b)};
dhtmlxAjax={get:function(a,c){var b=new dtmlXMLLoaderObject(!0);b.async=arguments.length<3;b.waitCall=c;b.loadXML(a);return b},post:function(a,c,b){var d=new dtmlXMLLoaderObject(!0);d.async=arguments.length<4;d.waitCall=b;d.loadXML(a,!0,c);return d},getSync:function(a){return this.get(a,null,!0)},postSync:function(a,c){return this.post(a,c,null,!0)}};
function dtmlXMLLoaderObject(a,c,b,d){this.xmlDoc="";this.async=typeof b!="undefined"?b:!0;this.onloadAction=a||null;this.mainObject=c||null;this.waitCall=null;this.rSeed=d||!1;return this}dtmlXMLLoaderObject.count=0;
dtmlXMLLoaderObject.prototype.waitLoadFunction=function(a){var c=!0;return this.check=function(){if(a&&a.onloadAction!=null&&(!a.xmlDoc.readyState||a.xmlDoc.readyState==4)&&c){c=!1;dtmlXMLLoaderObject.count++;if(typeof a.onloadAction=="function")a.onloadAction(a.mainObject,null,null,null,a);if(a.waitCall)a.waitCall.call(this,a),a.waitCall=null}}};
dtmlXMLLoaderObject.prototype.getXMLTopNode=function(a,c){if(this.xmlDoc.responseXML){var b=this.xmlDoc.responseXML.getElementsByTagName(a);b.length==0&&a.indexOf(":")!=-1&&(b=this.xmlDoc.responseXML.getElementsByTagName(a.split(":")[1]));var d=b[0]}else d=this.xmlDoc.documentElement;if(d)return this._retry=!1,d;if(_isIE&&!this._retry){var e=this.xmlDoc.responseText,c=this.xmlDoc;this._retry=!0;this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM");this.xmlDoc.async=!1;this.xmlDoc.loadXML(e);return this.getXMLTopNode(a,
c)}dhtmlxError.throwError("LoadXML","Incorrect XML",[c||this.xmlDoc,this.mainObject]);return document.createElement("DIV")};
dtmlXMLLoaderObject.prototype.loadXMLString=function(a){if(_isIE)this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(a);else{var c=new DOMParser;this.xmlDoc=c.parseFromString(a,"text/xml")}if(this.onloadAction)this.onloadAction(this.mainObject,null,null,null,this);if(this.waitCall)this.waitCall(),this.waitCall=null};
dtmlXMLLoaderObject.prototype.loadXML=function(a,c,b,d){this.rSeed&&(a+=(a.indexOf("?")!=-1?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf());this.filePath=a;this.xmlDoc=!_isIE&&window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(this.async)this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this);this.xmlDoc.open(c?"POST":"GET",a,this.async);d?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type",
"text/xml")):c&&this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded");this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(b);this.async||(new this.waitLoadFunction(this))()};
dtmlXMLLoaderObject.prototype.destructor=function(){return this.setXSLParamValue=this.getXMLTopNode=this.xmlNodeToJSON=this.doSerialization=this.loadXMLString=this.loadXML=this.doXSLTransToString=this.doXSLTransToObject=this.doXPathOpera=this.doXPath=this.xmlDoc=this.mainObject=this.onloadAction=this.filePath=this.rSeed=this.async=this._retry=this._getAllNamedChilds=this._filterXPath=null};
dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(a){for(var c={},b=0;b<a.attributes.length;b++)c[a.attributes[b].name]=a.attributes[b].value;c._tagvalue=a.firstChild?a.firstChild.nodeValue:"";for(b=0;b<a.childNodes.length;b++){var d=a.childNodes[b].tagName;d&&(c[d]||(c[d]=[]),c[d].push(this.xmlNodeToJSON(a.childNodes[b])))}return c};function callerFunction(a,c){return this.handler=function(b){if(!b)b=window.event;a(b,c);return!0}}function getAbsoluteLeft(a){return getOffset(a).left}
function getAbsoluteTop(a){return getOffset(a).top}function getOffsetSum(a){for(var c=0,b=0;a;)c+=parseInt(a.offsetTop),b+=parseInt(a.offsetLeft),a=a.offsetParent;return{top:c,left:b}}
function getOffsetRect(a){var c=a.getBoundingClientRect(),b=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||b.scrollTop,h=window.pageXOffset||d.scrollLeft||b.scrollLeft,g=d.clientTop||b.clientTop||0,f=d.clientLeft||b.clientLeft||0,i=c.top+e-g,j=c.left+h-f;return{top:Math.round(i),left:Math.round(j)}}function getOffset(a){return a.getBoundingClientRect?getOffsetRect(a):getOffsetSum(a)}
function convertStringToBoolean(a){typeof a=="string"&&(a=a.toLowerCase());switch(a){case "1":case "true":case "yes":case "y":case 1:case !0:return!0;default:return!1}}function getUrlSymbol(a){return a.indexOf("?")!=-1?"&":"?"}function dhtmlDragAndDropObject(){if(window.dhtmlDragAndDrop)return window.dhtmlDragAndDrop;this.dragStartObject=this.dragStartNode=this.dragNode=this.lastLanding=0;this.tempDOMM=this.tempDOMU=null;this.waitDrag=0;window.dhtmlDragAndDrop=this;return this}
dhtmlDragAndDropObject.prototype.removeDraggableItem=function(a){a.onmousedown=null;a.dragStarter=null;a.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(a,c){a.onmousedown=this.preCreateDragCopy;a.dragStarter=c;this.addDragLanding(a,c)};dhtmlDragAndDropObject.prototype.addDragLanding=function(a,c){a.dragLanding=c};
dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(a){if(!((a||window.event)&&(a||event).button==2)){if(window.dhtmlDragAndDrop.waitDrag)return window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1;window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(a);window.dhtmlDragAndDrop.waitDrag=1;window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;window.dhtmlDragAndDrop.tempDOMM=
document.body.onmousemove;window.dhtmlDragAndDrop.dragStartNode=this;window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;window.dhtmlDragAndDrop.downtime=(new Date).valueOf();a&&a.preventDefault&&a.preventDefault();return!1}};
dhtmlDragAndDropObject.prototype.callDrag=function(a){if(!a)a=window.event;dragger=window.dhtmlDragAndDrop;if(!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode)if(dragger.waitDrag){dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,a);if(!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1};dragger.gldragNode=dragger.dragNode;document.body.appendChild(dragger.dragNode);document.body.onmouseup=dragger.stopDrag;dragger.waitDrag=
0;dragger.dragNode.pWindow=window;dragger.initFrameRoute()}else return dragger.stopDrag(a,!0);if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var c=dragger.gldragNode;if(dragger.gldragNode.old)c=dragger.gldragNode.old;c.parentNode.removeChild(c);var b=dragger.dragNode.pWindow;c.pWindow&&c.pWindow.dhtmlDragAndDrop.lastLanding&&c.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(c.pWindow.dhtmlDragAndDrop.lastLanding);if(_isIE){var d=document.createElement("Div");d.innerHTML=
dragger.dragNode.outerHTML;dragger.dragNode=d.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(!0);dragger.dragNode.pWindow=window;dragger.gldragNode.old=dragger.dragNode;document.body.appendChild(dragger.dragNode);b.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=a.clientX+15+(dragger.fx?dragger.fx*-1:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";dragger.dragNode.style.top=a.clientY+3+(dragger.fy?dragger.fy*-1:0)+(document.body.scrollTop||
document.documentElement.scrollTop)+"px";var e=a.srcElement?a.srcElement:a.target;dragger.checkLanding(e,a)}};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(a){if(window.name){for(var c=parent.frames[window.name].frameElement.offsetParent,b=0,d=0;c;)b+=c.offsetLeft,d+=c.offsetTop,c=c.offsetParent;if(parent.dhtmlDragAndDrop){var e=parent.dhtmlDragAndDrop.calculateFramePosition(1);b+=e.split("_")[0]*1;d+=e.split("_")[1]*1}if(a)return b+"_"+d;else this.fx=b;this.fy=d}return"0_0"};
dhtmlDragAndDropObject.prototype.checkLanding=function(a,c){a&&a.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=a,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,c.clientX,c.clientY,c),this.lastLanding_scr=_isIE?c.srcElement:c.target):a&&a.tagName!="BODY"?this.checkLanding(a.parentNode,c):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,c.clientX,c.clientY,c),this.lastLanding=
0,this._onNotFound&&this._onNotFound())};
dhtmlDragAndDropObject.prototype.stopDrag=function(a,c){dragger=window.dhtmlDragAndDrop;if(!c){dragger.stopFrameRoute();var b=dragger.lastLanding;dragger.lastLanding=null;b&&b.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,b,_isIE?event.srcElement:a.target)}dragger.lastLanding=null;dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode);dragger.dragNode=0;dragger.gldragNode=0;dragger.fx=0;dragger.fy=0;dragger.dragStartNode=
0;dragger.dragStartObject=0;document.body.onmouseup=dragger.tempDOMU;document.body.onmousemove=dragger.tempDOMM;dragger.tempDOMU=null;dragger.tempDOMM=null;dragger.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(a){a&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var c=0;c<window.frames.length;c++)try{window.frames[c]!=a&&window.frames[c].dhtmlDragAndDrop&&window.frames[c].dhtmlDragAndDrop.stopFrameRoute(window)}catch(b){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=a&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(d){}};
dhtmlDragAndDropObject.prototype.initFrameRoute=function(a,c){if(a)window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=a.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=a.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=a.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=a.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&c&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition();
try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=a&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(b){}for(var d=0;d<window.frames.length;d++)try{window.frames[d]!=a&&window.frames[d].dhtmlDragAndDrop&&window.frames[d].dhtmlDragAndDrop.initFrameRoute(window,!a||c?1:0)}catch(e){}};_OperaRv=_KHTMLrv=_FFrv=_isChrome=_isMacOS=_isKHTML=_isOpera=_isIE=_isFF=!1;navigator.userAgent.indexOf("Macintosh")!=-1&&(_isMacOS=!0);navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0);
navigator.userAgent.indexOf("Safari")!=-1||navigator.userAgent.indexOf("Konqueror")!=-1?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):navigator.userAgent.indexOf("Opera")!=-1?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):navigator.appName.indexOf("Microsoft")!=-1?(_isIE=!0,navigator.appVersion.indexOf("MSIE 8.0")!=-1&&document.compatMode!="BackCompat"&&
(_isIE=8),navigator.appVersion.indexOf("MSIE 9.0")!=-1&&document.compatMode!="BackCompat"&&(_isIE=8)):(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1]));
dtmlXMLLoaderObject.prototype.doXPath=function(a,c,b,d){if(_isKHTML||!_isIE&&!window.XPathResult)return this.doXPathOpera(a,c);if(_isIE)return c||(c=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),c||dhtmlxError.throwError("LoadXML","Incorrect XML",[c||this.xmlDoc,this.mainObject]),b!=null&&c.setProperty("SelectionNamespaces","xmlns:xsl='"+b+"'"),d=="single"?c.selectSingleNode(a):c.selectNodes(a)||[];else{var e=c;c||(c=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML);c||dhtmlxError.throwError("LoadXML",
"Incorrect XML",[c||this.xmlDoc,this.mainObject]);c.nodeName.indexOf("document")!=-1?e=c:(e=c,c=c.ownerDocument);var h=XPathResult.ANY_TYPE;if(d=="single")h=XPathResult.FIRST_ORDERED_NODE_TYPE;var g=[],f=c.evaluate(a,e,function(){return b},h,null);if(h==XPathResult.FIRST_ORDERED_NODE_TYPE)return f.singleNodeValue;for(var i=f.iterateNext();i;)g[g.length]=i,i=f.iterateNext();return g}};function x(){if(!this.catches)this.catches=[];return this}x.prototype.catchError=function(a,c){this.catches[a]=c};
x.prototype.throwError=function(a,c,b){if(this.catches[a])return this.catches[a](a,c,b);if(this.catches.ALL)return this.catches.ALL(a,c,b);alert("Error type: "+a+"\nDescription: "+c);return null};window.dhtmlxError=new x;
dtmlXMLLoaderObject.prototype.doXPathOpera=function(a,c){var b=a.replace(/[\/]+/gi,"/").split("/"),d=null,e=1;if(!b.length)return[];if(b[0]==".")d=[c];else if(b[0]=="")d=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(b[e].replace(/\[[^\]]*\]/g,"")),e++;else return[];for(;e<b.length;e++)d=this._getAllNamedChilds(d,b[e]);b[e-1].indexOf("[")!=-1&&(d=this._filterXPath(d,b[e-1]));return d};
dtmlXMLLoaderObject.prototype._filterXPath=function(a,c){for(var b=[],c=c.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),d=0;d<a.length;d++)a[d].getAttribute(c)&&(b[b.length]=a[d]);return b};
dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(a,c){var b=[];_isKHTML&&(c=c.toUpperCase());for(var d=0;d<a.length;d++)for(var e=0;e<a[d].childNodes.length;e++)_isKHTML?a[d].childNodes[e].tagName&&a[d].childNodes[e].tagName.toUpperCase()==c&&(b[b.length]=a[d].childNodes[e]):a[d].childNodes[e].tagName==c&&(b[b.length]=a[d].childNodes[e]);return b};function dhtmlXHeir(a,c){for(var b in c)typeof c[b]=="function"&&(a[b]=c[b]);return a}
function dhtmlxEvent(a,c,b){a.addEventListener?a.addEventListener(c,b,!1):a.attachEvent&&a.attachEvent("on"+c,b)}dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(a,c,b){if(!b)b=this.xslDoc;if(b.responseXML)b=b.responseXML;var d=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+a+"']",b,"http://www.w3.org/1999/XSL/Transform","single");if(d!=null)d.firstChild.nodeValue=c};
dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(a,c){if(!a)a=this.xslDoc;if(a.responseXML)a=a.responseXML;if(!c)c=this.xmlDoc;if(c.responseXML)c=c.responseXML;if(_isIE){d=new ActiveXObject("Msxml2.DOMDocument.3.0");try{c.transformNodeToObject(a,d)}catch(b){d=c.transformNode(a)}}else{if(!this.XSLProcessor)this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(a);var d=this.XSLProcessor.transformToDocument(c)}return d};
dtmlXMLLoaderObject.prototype.doXSLTransToString=function(a,c){var b=this.doXSLTransToObject(a,c);return typeof b=="string"?b:this.doSerialization(b)};dtmlXMLLoaderObject.prototype.doSerialization=function(a){if(!a)a=this.xmlDoc;if(a.responseXML)a=a.responseXML;if(_isIE)return a.xml;else{var c=new XMLSerializer;return c.serializeToString(a)}};
dhtmlxEventable=function(a){a.attachEvent=function(a,b,d){a="ev_"+a.toLowerCase();this[a]||(this[a]=new this.eventCatcher(d||this));return a+":"+this[a].addEvent(b)};a.callEvent=function(a,b){a="ev_"+a.toLowerCase();return this[a]?this[a].apply(this,b):!0};a.checkEvent=function(a){return!!this["ev_"+a.toLowerCase()]};a.eventCatcher=function(a){var b=[],d=function(){for(var e=!0,d=0;d<b.length;d++)if(b[d]!=null)var g=b[d].apply(a,arguments),e=e&&g;return e};d.addEvent=function(a){typeof a!="function"&&
(a=eval(a));return a?b.push(a)-1:!1};d.removeEvent=function(a){b[a]=null};return d};a.detachEvent=function(a){if(a!=!1){var b=a.split(":");this[b[0]].removeEvent(b[1])}};a.detachAllEvents=function(){for(var a in this)a.indexOf("ev_")==0&&delete this[a]}};
(function(){var a=dhtmlx.message=function(c,b,d,e){if(!a.area)a.area=document.createElement("DIV"),a.area.style.cssText="position:absolute;right:5px;width:250px;z-index:100;",a.area.className="dhtmlx_message_area",a.area.style[a.defPosition]="5px",document.body.appendChild(a.area);typeof c!="object"&&(c={text:c,type:b,lifetime:d,id:e});c.type=c.type||"info";c.id=c.id||a.uid();c.lifetime=c.lifetime||a.defTimeout;a.hide(c.id);var h=document.createElement("DIV");h.style.cssText="border-radius:4px; padding:4px 4px 4px 20px;background-color:#FFFFCC;font-size:12px;font-family:Tahoma;color:navy;z-index: 10000;margin:5px;border:1px solid lightgrey;";
h.innerHTML=c.text;h.className=c.type;a.defPosition=="bottom"&&a.area.firstChild?a.area.insertBefore(h,a.area.firstChild):a.area.appendChild(h);a.timers[c.id]=window.setTimeout(function(){a.hide(c.id)},c.lifetime);a.pull[c.id]=h;return c.id};a.defTimeout=4E3;a.defPosition="top";a.pull={};a.timers={};a.seed=(new Date).valueOf();a.uid=function(){return a.seed++};a.hideAll=function(){for(var c in a.pull)a.hide(c)};a.hide=function(c){var b=a.pull[c];b&&b.parentNode&&(b.parentNode.removeChild(b),window.clearTimeout(a.timers[c]),
delete a.pull[c])}})();var globalActiveDHTMLGridObject;String.prototype._dhx_trim=function(){return this.replace(/&nbsp;/g," ").replace(/(^[ \t]*)|([ \t]*$)/g,"")};function dhtmlxArray(a){return dhtmlXHeir(a||[],dhtmlxArray._master)}
dhtmlxArray._master={_dhx_find:function(a){for(var c=0;c<this.length;c++)if(a==this[c])return c;return-1},_dhx_insertAt:function(a,c){this[this.length]=null;for(var b=this.length-1;b>=a;b--)this[b]=this[b-1];this[a]=c},_dhx_removeAt:function(a){this.splice(a,1)},_dhx_swapItems:function(a,c){var b=this[a];this[a]=this[c];this[c]=b}};
function dhtmlXGridObject(a){if(_isIE)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(c){}a?typeof a=="object"?(this.entBox=a,this.entBox.id="cgrid2_"+this.uid()):this.entBox=document.getElementById(a):(this.entBox=document.createElement("DIV"),this.entBox.id="cgrid2_"+this.uid());this.entBox.innerHTML="";dhtmlxEventable(this);var b=this;this._wcorr=0;this.fontWidth=7;this.row=this.cell=null;this.iconURL="";this.editor=null;this._dclE=this._f2kE=!0;this.combos=[];this.defVal=[];this.rowsAr=
{};this.rowsBuffer=dhtmlxArray();this.rowsCol=dhtmlxArray();this._data_cache={};this._ecache={};this._ud_enabled=!0;this.xmlLoader=new dtmlXMLLoaderObject(this.doLoadDetails,this,!0,this.no_cashe);this._maskArr=[];this.selectedRows=dhtmlxArray();this.UserData={};this._sizeFix=this._borderFix=0;this.entBox.className+=" gridbox";this.entBox.style.width=this.entBox.getAttribute("width")||(window.getComputedStyle?this.entBox.style.width||window.getComputedStyle(this.entBox,null).width:this.entBox.currentStyle?
this.entBox.currentStyle.width:this.entBox.style.width||0)||"100%";this.entBox.style.height=this.entBox.getAttribute("height")||(window.getComputedStyle?this.entBox.style.height||window.getComputedStyle(this.entBox,null).height:this.entBox.currentStyle?this.entBox.currentStyle.height:this.entBox.style.height||0)||"100%";this.entBox.style.cursor="default";this.entBox.onselectstart=function(){return!1};var d=function(a){var b=document.createElement("TABLE");b.cellSpacing=b.cellPadding=0;b.style.cssText=
"width:100%;table-layout:fixed;";b.className=a.substr(2);return b};this.obj=d("c_obj");this.hdr=d("c_hdr");this.hdr.style.marginRight="20px";this.hdr.style.paddingRight="20px";this.objBox=document.createElement("DIV");this.objBox.style.width="100%";this.objBox.style.overflow="auto";this.objBox.appendChild(this.obj);this.objBox.className="objbox";this.hdrBox=document.createElement("DIV");this.hdrBox.style.width="100%";this.hdrBox.style.height="25px";this.hdrBox.style.overflow="hidden";this.hdrBox.className=
"xhdr";this.preloadImagesAr=[];this.sortImg=document.createElement("IMG");this.sortImg.style.display="none";this.hdrBox.appendChild(this.sortImg);this.hdrBox.appendChild(this.hdr);this.hdrBox.style.position="relative";this.entBox.appendChild(this.hdrBox);this.entBox.appendChild(this.objBox);this.entBox.grid=this;this.objBox.grid=this;this.hdrBox.grid=this;this.obj.grid=this;this.hdr.grid=this;this.cellWidthPX=[];this.cellWidthPC=[];this.cellWidthType=this.entBox.cellwidthtype||"px";this.delim=this.entBox.delimiter||
",";this._csvDelim=",";this.hdrLabels=[];this.columnIds=[];this.columnColor=[];this._hrrar=[];this.cellType=dhtmlxArray();this.cellAlign=[];this.initCellWidth=[];this.fldSort=[];this._srdh=_isIE&&document.compatMode!="BackCompat"?22:20;this.imgURL=window.dhx_globalImgPath||"";this.isActive=!1;this.isEditable=!0;this.pagingOn=this.useImagesInHeader=!1;this.rowsBufferOutSize=0;dhtmlxEvent(window,"unload",function(){try{b.destructor&&b.destructor()}catch(a){}});this.setSkin=function(a){this.skin_name=
a;this.entBox.className="gridbox gridbox_"+a;this.skin_h_correction=0;this.enableAlterCss("ev_"+a,"odd_"+a,this.isTreeGrid());this._fixAlterCss();switch(a){case "clear":this._topMb=document.createElement("DIV");this._topMb.className="topMumba";this._topMb.innerHTML="<img style='left:0px'   src='"+this.imgURL+"skinC_top_left.gif'><img style='right:20px' src='"+this.imgURL+"skinC_top_right.gif'>";this.entBox.appendChild(this._topMb);this._botMb=document.createElement("DIV");this._botMb.className="bottomMumba";
this._botMb.innerHTML="<img style='left:0px'   src='"+this.imgURL+"skinD_bottom_left.gif'><img style='right:20px' src='"+this.imgURL+"skinD_bottom_right.gif'>";this.entBox.appendChild(this._botMb);this.entBox.style.position="relative";this.skin_h_correction=20;break;case "dhx_skyblue":case "dhx_web":case "glassy_blue":case "dhx_black":case "dhx_blue":case "modern":case "light":this._srdh=20;this.forceDivInHeader=!0;break;case "xp":this.forceDivInHeader=!0;this._srdh=_isIE&&document.compatMode!="BackCompat"?
26:22;break;case "mt":this._srdh=_isIE&&document.compatMode!="BackCompat"?26:22;break;case "gray":if(_isIE&&document.compatMode!="BackCompat")this._srdh=22}if(_isIE&&this.hdr){var b=this.hdr.parentNode;b.removeChild(this.hdr);b.appendChild(this.hdr)}this.setSizes()};_isIE&&this.preventIECaching(!0);if(window.dhtmlDragAndDropObject)this.dragger=new dhtmlDragAndDropObject;this._doOnScroll=function(a,b){this.callEvent("onScroll",[this.objBox.scrollLeft,this.objBox.scrollTop]);this.doOnScroll(a,b)};this.doOnScroll=
function(a,c){this.hdrBox.scrollLeft=this.objBox.scrollLeft;if(this.ftr)this.ftr.parentNode.scrollLeft=this.objBox.scrollLeft;if(!c&&this._srnd)this._dLoadTimer&&window.clearTimeout(this._dLoadTimer),this._dLoadTimer=window.setTimeout(function(){b._update_srnd_view&&b._update_srnd_view()},100)};this.attachToObject=function(a){a.appendChild(this.globalBox?this.globalBox:this.entBox);this.setSizes()};this.init=function(a){if(this.isTreeGrid()&&!this._h2){this._h2=new dhtmlxHierarchy;if(this._fake&&
!this._realfake)this._fake._h2=this._h2;this._tgc={imgURL:null}}if(this._hstyles){this.editStop();this.fldSorted=this.r_fldSorted=this.resized=this.lastClicked=null;this.cellWidthPX=[];this.cellWidthPC=[];this.hdr.rows.length>0&&this.clearAll(!0);for(var c=this.hdr.insertRow(0),d=0;d<this.hdrLabels.length;d++)c.appendChild(document.createElement("TH")),c.childNodes[d]._cellIndex=d,c.childNodes[d].style.height="0px";_isIE&&_isIE<8?c.style.position="absolute":c.style.height="auto";c=this.hdr.insertRow(_isKHTML?
2:1);c._childIndexes=[];for(var f=0,d=0;d<this.hdrLabels.length;d++)c._childIndexes[d]=d-f,this.hdrLabels[d]==this.splitSign&&d!=0?(_isKHTML&&c.insertCell(d-f),c.cells[d-f-1].colSpan=(c.cells[d-f-1].colSpan||1)+1,c.childNodes[d-f-1]._cellIndex++,f++,c._childIndexes[d]=d-f):(c.insertCell(d-f),c.childNodes[d-f]._cellIndex=d,c.childNodes[d-f]._cellIndexS=d,this.setColumnLabel(d,this.hdrLabels[d]));if(f==0)c._childIndexes=null;this._cCount=this.hdrLabels.length;_isIE&&window.setTimeout(function(){b.setSizes&&
b.setSizes()},1);this.obj.firstChild||this.obj.appendChild(document.createElement("TBODY"));var i=this.obj.firstChild;if(!i.firstChild){i.appendChild(document.createElement("TR"));i=i.firstChild;_isIE&&_isIE<8?i.style.position="absolute":i.style.height="auto";for(d=0;d<this.hdrLabels.length;d++)i.appendChild(document.createElement("TH")),i.childNodes[d].style.height="0px"}this._c_order=null;this.multiLine!=!0&&(this.obj.className+=" row20px");this.sortImg.style.position="absolute";this.sortImg.style.display=
"none";this.sortImg.src=this.imgURL+"sort_desc.gif";this.sortImg.defLeft=0;this.noHeader?this.hdrBox.style.display="none":this.noHeader=!1;this._ivizcol&&this.setColHidden();this.attachHeader();this.attachHeader(0,0,"_aFoot");this.setSizes();a&&this.parseXML();this.obj.scrollTop=0;this.dragAndDropOff&&this.dragger.addDragLanding(this.entBox,this);this._initDrF&&this._initD();this._init_point&&this._init_point()}};this.setColumnSizes=function(a){for(var b=0,c=[],d=0,i=0;i<this._cCount;i++)if(this.initCellWidth[i]==
"*"&&!this._hrrar[i])this._awdth=!1,c.push(i);else{if(this.cellWidthType=="%"){typeof this.cellWidthPC[i]=="undefined"&&(this.cellWidthPC[i]=this.initCellWidth[i]);var j=a*this.cellWidthPC[i]/100||0;d>0.5&&(j++,d--);var k=this.cellWidthPX[i]=Math.floor(j),d=d+j-k}else typeof this.cellWidthPX[i]=="undefined"&&(this.cellWidthPX[i]=this.initCellWidth[i]);this._hrrar[i]||(b+=this.cellWidthPX[i]*1)}if(c.length){var l=Math.floor((a-b)/c.length);l<0&&(l=1);for(i=0;i<c.length;i++){var m=Math.max(this._drsclmW?
this._drsclmW[c[i]]||0:0,l);this.cellWidthPX[c[i]]=m;b+=m}if(a>b){var o=c[c.length-1];this.cellWidthPX[o]+=a-b;b=a}this._setAutoResize()}this.obj.style.width=b+"px";this.hdr.style.width=b+"px";if(this.ftr)this.ftr.style.width=b+"px";this.chngCellWidth();return b};this.setSizes=function(){if(this.hdr.rows[0]){var a=this.quirks=_isIE&&document.compatMode=="BackCompat",c=(this.entBox.offsetWidth-this.entBox.clientWidth)/2;if(this.globalBox){var d=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/
2;if(this._delta_x&&!this._realfake){var f=this.globalBox.clientWidth;this.globalBox.style.width=this._delta_x;this.entBox.style.width=Math.max(0,this.globalBox.clientWidth+(a?d*2:0)-this._fake.entBox.clientWidth)+"px";f!=this.globalBox.clientWidth&&this._fake._correctSplit(this._fake.entBox.clientWidth)}if(this._delta_y&&!this._realfake)this.globalBox.style.height=this._delta_y,this.entBox.style.overflow=this._fake.entBox.style.overflow="hidden",this.entBox.style.height=this._fake.entBox.style.height=
this.globalBox.clientHeight+(a?d*2:0)+"px"}else{if(this._delta_x)this.entBox.parentNode&&this.entBox.parentNode.tagName=="TD"?(this.entBox.style.width="1px",this.entBox.style.width=parseInt(this._delta_x)*this.entBox.parentNode.clientWidth/100-c*2+"px"):this.entBox.style.width=this._delta_x;if(this._delta_y)this.entBox.style.height=this._delta_y}window.clearTimeout(this._sizeTime);if(!this.entBox.offsetWidth&&(!this.globalBox||!this.globalBox.offsetWidth))this._sizeTime=window.setTimeout(function(){b.setSizes&&
b.setSizes()},250);else{var i=(this.entBox.cmp||this._delta_x)&&(this.skin_name||"").indexOf("dhx")==0&&!a?2:0,j=(this.entBox.cmp||this._delta_y)&&(this.skin_name||"").indexOf("dhx")==0&&!a?2:0,k=this.parentGrid?!1:this.objBox.scrollHeight>this.objBox.offsetHeight,l=_isFF?18:18,m=this.entBox.clientWidth-(this.skin_h_correction||0)*(a?0:1)-i,o=this.entBox.clientWidth-(this.skin_h_correction||0)-i,n=this.entBox.clientHeight-j,p=this.setColumnSizes(o-(k?l:0)-(this._correction_x||0)),r=this.parentGrid?
!1:this.objBox.scrollWidth>this.objBox.offsetWidth||this.objBox.style.overflowX=="scroll",t=this.hdr.clientHeight,s=this.ftr?this.ftr.clientHeight:0,u=m,q=n-t-s;this._awdth&&this._awdth[0]&&this._awdth[1]==99999&&(r=0);if(this._ahgr&&(q=this._ahgrMA?this.entBox.parentNode.clientHeight-t-s:this.obj.offsetHeight+(r?l:0)+(this._correction_y||0),this._ahgrM&&(q=this._ahgrF?Math.min(this._ahgrM,q+t+s)-t-s:Math.min(this._ahgrM,q)),k&&q>=this.obj.scrollHeight+(r?l:0)))k=!1,this.setColumnSizes(o-(this._correction_x||
0));if(this._awdth&&this._awdth[0]){if(this.cellWidthType=="%")this.cellWidthType="px";this._fake&&(p+=this._fake.entBox.clientWidth);u=Math.min(Math.max(p+(k?l:0),this._awdth[2]),this._awdth[1])+(this._correction_x||0);this._fake&&(u-=this._fake.entBox.clientWidth)}q=Math.max(0,q);this._ff_size_delta=this._ff_size_delta==0.1?0.2:0.1;if(!_isFF)this._ff_size_delta=0;this.entBox.style.width=Math.max(0,u+(a?2:0)*c+this._ff_size_delta)+"px";this.entBox.style.height=q+(a?2:0)*c+t+s+"px";this.objBox.style.height=
q+(a&&!k?2:0)*c+"px";this.hdrBox.style.height=t+"px";q!=n&&this.doOnScroll(0,!this._srnd);var v=this["setSizes_"+this.skin_name];v&&v.call(this);this.setSortImgPos();t!=this.hdr.clientHeight&&this._ahgr&&this.setSizes();this.callEvent("onSetSizes",[])}}};this.setSizes_clear=function(){var a=this.hdr.offsetHeight,b=this.entBox.offsetWidth,c=a+this.objBox.offsetHeight;this._topMb.style.top=(a||0)+"px";this._topMb.style.width=b+20+"px";this._botMb.style.top=c-3+"px";this._botMb.style.width=b+20+"px"};
this.chngCellWidth=function(){if(_isOpera&&this.ftr)this.ftr.width=this.objBox.scrollWidth+"px";for(var a=this._cCount,b=0;b<a;b++)if(this.hdr.rows[0].cells[b].style.width=this.cellWidthPX[b]+"px",this.obj.rows[0].childNodes[b].style.width=this.cellWidthPX[b]+"px",this.ftr)this.ftr.rows[0].cells[b].style.width=this.cellWidthPX[b]+"px"};this.setDelimiter=function(a){this.delim=a};this.setInitWidthsP=function(a,b){this.cellWidthType="%";this.initCellWidth=a.split(this.delim.replace(/px/gi,""));b||this._setAutoResize()};
this._setAutoResize=function(){if(!this._realfake){var a=window,b=this;dhtmlxEvent(window,"resize",function(){window.clearTimeout(b._resize_timer);if(b._setAutoResize)b._resize_timer=window.setTimeout(function(){b.setSizes&&b.setSizes();b._fake&&b._fake._correctSplit()},100)})}};this.setInitWidths=function(a){this.cellWidthType="px";this.initCellWidth=a.split(this.delim);if(_isFF)for(var b=0;b<this.initCellWidth.length;b++)this.initCellWidth[b]!="*"&&(this.initCellWidth[b]=parseInt(this.initCellWidth[b]))};
this.enableMultiline=function(a){this.multiLine=convertStringToBoolean(a)};this.enableMultiselect=function(a){this.selMultiRows=convertStringToBoolean(a)};this.setImagesPath=this.setImagePath=function(a){this.imgURL=a};this.setIconsPath=this.setIconPath=function(a){this.iconURL=a};this.changeCursorState=function(a){var b=a.target||a.srcElement;b.tagName!="TD"&&(b=this.getFirstParentOfType(b,"TD"));if(b){if(b.tagName=="TD"&&this._drsclmn&&!this._drsclmn[b._cellIndex])return b.style.cursor="default";
var c=(a.layerX||0)+(!_isIE&&a.target.tagName=="DIV"?b.offsetLeft:0);b.style.cursor=b.offsetWidth-(a.offsetX||(parseInt(this.getPosition(b,this.hdrBox))-c)*-1)<(_isOpera?20:10)?"E-resize":"default";if(_isOpera)this.hdrBox.scrollLeft=this.objBox.scrollLeft}};this.startColResize=function(a){this.resized&&this.stopColResize();this.resized=null;var c=a.target||a.srcElement;c.tagName!="TD"&&(c=this.getFirstParentOfType(c,"TD"));var d=a.clientX,f=this.hdr.offsetWidth,i=parseInt(c.offsetWidth);if(c.tagName==
"TD"&&c.style.cursor!="default"&&(!this._drsclmn||this._drsclmn[c._cellIndex]))b._old_d_mm=document.body.onmousemove,b._old_d_mu=document.body.onmouseup,document.body.onmousemove=function(a){b&&b.doColResize(a||window.event,c,i,d,f)},document.body.onmouseup=function(){b&&b.stopColResize()}};this.stopColResize=function(){document.body.onmousemove=b._old_d_mm||"";document.body.onmouseup=b._old_d_mu||"";this.setSizes();this.doOnScroll(0,1);this.callEvent("onResizeEnd",[this])};this.doColResize=function(a,
b,c,d,i){b.style.cursor="E-resize";this.resized=b;var j=c+(a.clientX-d),k=i+(a.clientX-d);if(this.callEvent("onResize",[b._cellIndex,j,this])){if(_isIE)this.objBox.scrollLeft=this.hdrBox.scrollLeft;if(b.colSpan>1){for(var l=[],m=0;m<b.colSpan;m++)l[m]=Math.round(j*this.hdr.rows[0].childNodes[b._cellIndexS+m].offsetWidth/b.offsetWidth);for(m=0;m<b.colSpan;m++)this._setColumnSizeR(b._cellIndexS+m*1,l[m])}else this._setColumnSizeR(b._cellIndex,j);this.doOnScroll(0,1);this.setSizes();this._fake&&this._awdth&&
this._fake._correctSplit()}};this._setColumnSizeR=function(a,b){if(b>(this._drsclmW&&!this._notresize?this._drsclmW[a]||10:10)){this.obj.rows[0].childNodes[a].style.width=b+"px";this.hdr.rows[0].childNodes[a].style.width=b+"px";if(this.ftr)this.ftr.rows[0].childNodes[a].style.width=b+"px";if(this.cellWidthType=="px")this.cellWidthPX[a]=b;else{var c=parseInt(this.entBox.offsetWidth);this.objBox.scrollHeight>this.objBox.offsetHeight&&(c-=17);var d=Math.round(b/c*100);this.cellWidthPC[a]=d}this.sortImg.style.display!=
"none"&&this.setSortImgPos()}};this.setSortImgState=function(a,b,c,d){c=(c||"asc").toLowerCase();if(convertStringToBoolean(a)){this.sortImg.src=c=="asc"?this.imgURL+"sort_asc.gif":this.imgURL+"sort_desc.gif";this.sortImg.style.display="";this.fldSorted=this.hdr.rows[0].childNodes[b];var i=this.hdr.rows[d||1];if(i){for(var j=0;j<i.childNodes.length;j++)if(i.childNodes[j]._cellIndexS==b)return this.r_fldSorted=i.childNodes[j],this.setSortImgPos();return this.setSortImgState(a,b,c,(d||1)+1)}}else this.sortImg.style.display=
"none",this.fldSorted=null};this.setSortImgPos=function(a,b,c,d){if(!this._hrrar||!this._hrrar[this.r_fldSorted?this.r_fldSorted._cellIndex:a])if(d||(d=a?this.hdr.rows[c||0].cells[a]:this.r_fldSorted),d!=null){var i=this.getPosition(d,this.hdrBox),j=d.offsetWidth;this.sortImg.style.left=Number(i[0]+j-13)+"px";this.sortImg.defLeft=parseInt(this.sortImg.style.left);this.sortImg.style.top=Number(i[1]+5)+"px";if(!this.useImagesInHeader&&!b)this.sortImg.style.display="inline";this.sortImg.style.left=this.sortImg.defLeft+
"px"}};this.setActive=function(a){arguments.length==0&&(a=!0);a==!0?(globalActiveDHTMLGridObject&&globalActiveDHTMLGridObject!=this&&(globalActiveDHTMLGridObject.editStop(),globalActiveDHTMLGridObject.callEvent("onBlur",[globalActiveDHTMLGridObject])),globalActiveDHTMLGridObject=this,this.isActive=!0):(this.isActive=!1,this.callEvent("onBlur",[this]))};this._doClick=function(a){var b=0,c=this.getFirstParentOfType(_isIE?a.srcElement:a.target,"TD");if(c){var d=!0;if(this.markedCells){var i=0;if(a.shiftKey||
a.metaKey)i=1;a.ctrlKey&&(i=2);this.doMark(c,i);return!0}if(this.selMultiRows!=!1&&(a.shiftKey&&this.row!=null&&this.selectedRows.length&&(b=1),a.ctrlKey||a.metaKey))b=2;this.doClick(c,d,b)}};this._doContClick=function(a){var b=this.getFirstParentOfType(_isIE?a.srcElement:a.target,"TD");if(!b||typeof b.parentNode.idd=="undefined")return!0;if(a.button==2||_isMacOS&&a.ctrlKey){if(!this.callEvent("onRightClick",[b.parentNode.idd,b._cellIndex,a])){var c=function(a){(a||event).cancelBubble=!0;return!1};
(a.srcElement||a.target).oncontextmenu=c;return c(a)}if(this._ctmndx){if(!this.callEvent("onBeforeContextMenu",[b.parentNode.idd,b._cellIndex,this]))return!0;if(_isIE)a.srcElement.oncontextmenu=function(){event.cancelBubble=!0;return!1};if(this._ctmndx.showContextMenu){var d=window.document.documentElement,i=window.document.body,j=[d.scrollLeft||i.scrollLeft,d.scrollTop||i.scrollTop];if(_isIE)var k=a.clientX+j[0],l=a.clientY+j[1];else k=a.pageX,l=a.pageY;this._ctmndx.showContextMenu(k-1,l-1);this.contextID=
this._ctmndx.contextMenuZoneId=b.parentNode.idd+"_"+b._cellIndex;this._ctmndx._skip_hide=!0}else b.contextMenuId=b.parentNode.idd+"_"+b._cellIndex,b.contextMenu=this._ctmndx,b.a=this._ctmndx._contextStart,b.a(b,a),b.a=null;a.cancelBubble=!0;return!1}}else this._ctmndx&&(this._ctmndx.hideContextMenu?this._ctmndx.hideContextMenu():this._ctmndx._contextEnd());return!0};this.doClick=function(a,c,d,f){this.selMultiRows||(d=0);var i=this.row?this.row.idd:0;this.setActive(!0);d||(d=0);if(this.cell!=null)this.cell.className=
this.cell.className.replace(/cellselected/g,"");if(a.tagName=="TD"){if(this.checkEvent("onSelectStateChanged"))var j=this.getSelectedId();var k=this.row;if(d==1){var l=this.rowsCol._dhx_find(a.parentNode),m=this.rowsCol._dhx_find(this.lastClicked);if(l>m)var o=m,n=l;else o=l,n=m;for(var p=0;p<this.rowsCol.length;p++)if(p>=o&&p<=n)if(this.rowsCol[p]&&!this.rowsCol[p]._sRow)this.rowsCol[p].className.indexOf("rowselected")==-1&&this.callEvent("onBeforeSelect",[this.rowsCol[p].idd,i])&&(this.rowsCol[p].className+=
" rowselected",this.selectedRows[this.selectedRows.length]=this.rowsCol[p]);else return this.clearSelection(),this.doClick(a,c,0,f)}else if(d==2&&a.parentNode.className.indexOf("rowselected")!=-1){a.parentNode.className=a.parentNode.className.replace(/rowselected/g,"");this.selectedRows._dhx_removeAt(this.selectedRows._dhx_find(a.parentNode));var r=!0}this.editStop();if(typeof a.parentNode.idd=="undefined")return!0;if(!r&&!a.parentNode._sRow)if(this.callEvent("onBeforeSelect",[a.parentNode.idd,i]))if(this.getSelectedRowId()!=
a.parentNode.idd){d==0&&this.clearSelection();this.cell=a;k==a.parentNode&&this._chRRS&&(c=!1);this.row=a.parentNode;this.row.className+=" rowselected";if(this.cell&&_isIE&&_isIE==8){var t=this.cell.nextSibling,s=this.cell.parentNode;s.removeChild(this.cell);s.insertBefore(this.cell,t)}if(this.selectedRows._dhx_find(this.row)==-1)this.selectedRows[this.selectedRows.length]=this.row}else this.cell=a;else c=!1;if(this.cell&&this.cell.parentNode.className.indexOf("rowselected")!=-1)this.cell.className=
this.cell.className.replace(/cellselected/g,"")+" cellselected";if(d!=1&&!this.row)return;this.lastClicked=a.parentNode;var u=this.row.idd,q=this.cell;c&&typeof u!="undefined"&&q&&!r?b.onRowSelectTime=setTimeout(function(){b.callEvent&&b.callEvent("onRowSelect",[u,q._cellIndex])},100):this.callEvent("onRowSelectRSOnly",[u]);if(this.checkEvent("onSelectStateChanged")){var v=this.getSelectedId();j!=v&&this.callEvent("onSelectStateChanged",[v,j])}}this.isActive=!0;f!==!1&&this.cell&&this.cell.parentNode.idd&&
this.moveToVisible(this.cell)};this.selectAll=function(){this.clearSelection();var a=this.rowsBuffer;if(this.pagingOn)a=this.rowsCol;for(var b=0;b<a.length;b++)this.render_row(b).className+=" rowselected";this.selectedRows=dhtmlxArray([].concat(a));if(this.selectedRows.length)this.row=this.selectedRows[0],this.cell=this.row.cells[0];this._fake&&!this._realfake&&this._fake.selectAll()};this.selectCell=function(a,b,c,d,i,j){c||(c=!1);typeof a!="object"&&(a=this.render_row(a));if(!a||a==-1)return null;
var k=a._childIndexes?a.childNodes[a._childIndexes[b]]:a.childNodes[b];k||(k=a.childNodes[0]);d?this.doClick(k,c,3,j):this.doClick(k,c,0,j);i&&this.editCell()};this.moveToVisible=function(a,b){if(this.pagingOn){var c=Math.floor(this.getRowIndex(a.parentNode.idd)/this.rowsBufferOutSize)+1;c!=this.currentPage&&this.changePage(c)}try{if(a.offsetHeight){var d=a.offsetLeft+a.offsetWidth+20,i=0;d>this.objBox.offsetWidth+this.objBox.scrollLeft?a.offsetLeft>this.objBox.scrollLeft&&(i=a.offsetLeft-5):a.offsetLeft<
this.objBox.scrollLeft&&(d-=a.offsetWidth*2/3,d<this.objBox.scrollLeft&&(i=a.offsetLeft-5));if(i&&!b)this.objBox.scrollLeft=i}if(a.offsetHeight)d=a.offsetTop;else var j=this._realfake?this._fake.rowsAr[a.parentNode.idd]:a.parentNode,d=this.rowsBuffer._dhx_find(j)*this._srdh;var k=d+a.offsetHeight+38;if(k>this.objBox.offsetHeight+this.objBox.scrollTop)var l=k-this.objBox.offsetHeight;else d<this.objBox.scrollTop&&(l=d-5);if(l)this.objBox.scrollTop=l}catch(m){}};this.editCell=function(){if(!(this.editor&&
this.cell==this.editor.cell)){this.editStop();if(this.isEditable!=!0||!this.cell)return!1;var a=this.cell;if(a.parentNode._locked)return!1;this.editor=this.cells4(a);if(this.editor!=null){if(this.editor.isDisabled())return this.editor=null,!1;this.callEvent("onEditCell",[0,this.row.idd,this.cell._cellIndex])!=!1&&this.editor.edit?(this._Opera_stop=(new Date).valueOf(),a.className+=" editable",this.editor.edit(),this.callEvent("onEditCell",[1,this.row.idd,this.cell._cellIndex])):this.editor=null}}};
this.editStop=function(a){if(_isOpera&&this._Opera_stop){if(this._Opera_stop*1+50>(new Date).valueOf())return;this._Opera_stop=null}if(this.editor&&this.editor!=null)if(this.editor.cell.className=this.editor.cell.className.replace("editable",""),a){var b=this.editor.val;this.editor.detach();this.editor.setValue(b);this.editor=null;this.callEvent("onEditCancel",[this.row.idd,this.cell._cellIndex,b])}else{if(this.editor.detach())this.cell.wasChanged=!0;var c=this.editor;this.editor=null;var d=this.callEvent("onEditCell",
[2,this.row.idd,this.cell._cellIndex,c.getValue(),c.val]);if(typeof d=="string"||typeof d=="number")c[c.setImage?"setLabel":"setValue"](d);else if(!d)c[c.setImage?"setLabel":"setValue"](c.val);this._ahgr&&this.multiLine&&this.setSizes()}};this._nextRowCell=function(a,b,c){a=this._nextRow((this._groups?this.rowsCol:this.rowsBuffer)._dhx_find(a),b);return!a?null:a.childNodes[a._childIndexes?a._childIndexes[c]:c]};this._getNextCell=function(a,b,c){var a=a||this.cell,d=a.parentNode;this._tabOrder?(c=
this._tabOrder[a._cellIndex],typeof c!="undefined"&&(a=c<0?this._nextRowCell(d,b,Math.abs(c)-1):d.childNodes[c])):(c=a._cellIndex+b,c>=0&&c<this._cCount?(d._childIndexes&&(c=d._childIndexes[a._cellIndex]+b),a=d.childNodes[c]):a=this._nextRowCell(d,b,b==1?0:this._cCount-1));return!a?(b==1&&this.tabEnd&&(this.tabEnd.focus(),this.tabEnd.focus(),this.setActive(!1)),b==-1&&this.tabStart&&(this.tabStart.focus(),this.tabStart.focus(),this.setActive(!1)),null):a.style.display!="none"&&(!this.smartTabOrder||
!this.cells(a.parentNode.idd,a._cellIndex).isDisabled())?a:this._getNextCell(a,b)};this._nextRow=function(a,b){var c=this.render_row(a+b);return!c||c==-1?null:c&&c.style.display=="none"?this._nextRow(a+b,b):c};this.scrollPage=function(a){if(this.rowsBuffer.length){var b=this._realfake?this._fake:this,c=Math.floor((b._r_select||this.getRowIndex(this.row.idd)||0)+a*this.objBox.offsetHeight/(this._srdh||20));c<0&&(c=0);c>=this.rowsBuffer.length&&(c=this.rowsBuffer.length-1);if(this._srnd&&!this.rowsBuffer[c]){this.objBox.scrollTop+=
Math.floor(a*this.objBox.offsetHeight/(this._srdh||20))*(this._srdh||20);if(this._fake)this._fake.objBox.scrollTop=this.objBox.scrollTop;b._r_select=c}else{this.selectCell(c,this.cell._cellIndex,!0,!1,!1,this.multiLine||this._srnd);if(!this.multiLine&&!this._srnd&&!this._realfake&&(this.objBox.scrollTop=this.getRowById(this.getRowId(c)).offsetTop,this._fake))this._fake.objBox.scrollTop=this.objBox.scrollTop;b._r_select=null}}};this.doKey=function(a){if(!a)return!0;if((a.target||a.srcElement).value!==
window.undefined){var b=a.target||a.srcElement;if(!b.parentNode||b.parentNode.className.indexOf("editable")==-1)return!0}if(globalActiveDHTMLGridObject&&this!=globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.doKey(a);if(this.isActive==!1)return!0;if(this._htkebl)return!0;if(!this.callEvent("onKeyPress",[a.keyCode,a.ctrlKey,a.shiftKey,a]))return!1;var c="k"+a.keyCode+"_"+(a.ctrlKey?1:0)+"_"+(a.shiftKey?1:0);if(this.cell){if(this._key_events[c]){if(!1===this._key_events[c].call(this))return!0;
a.preventDefault&&a.preventDefault();a.cancelBubble=!0;return!1}this._key_events.k_other&&this._key_events.k_other.call(this,a)}return!0};this.selectRow=function(a,b,c,d){typeof a!="object"&&(a=this.render_row(a));this.selectCell(a,0,b,c,!1,d)};this.wasDblClicked=function(a){var b=this.getFirstParentOfType(_isIE?a.srcElement:a.target,"TD");if(b){var c=b.parentNode.idd;return this.callEvent("onRowDblClicked",[c,b._cellIndex])}};this._onHeaderClick=function(a,b){var c=this.grid,b=b||c.getFirstParentOfType(_isIE?
event.srcElement:a.target,"TD");if(this.grid.resized==null){if(!this.grid.callEvent("onHeaderClick",[b._cellIndexS,a||window.event]))return!1;c.sortField(b._cellIndexS,!1,b)}this.grid.resized=null};this.deleteSelectedRows=function(){var a=this.selectedRows.length;if(a!=0){var b=this.selectedRows;this.selectedRows=dhtmlxArray();for(var c=a-1;c>=0;c--){var d=b[c];if(this.deleteRow(d.idd,d)){if(d==this.row)var i=c}else this.selectedRows[this.selectedRows.length]=d}if(i)try{i+1>this.rowsCol.length&&i--,
this.selectCell(i,0,!0)}catch(j){this.cell=this.row=null}}};this.getSelectedRowId=function(){for(var a=[],b={},c=0;c<this.selectedRows.length;c++){var d=this.selectedRows[c].idd;b[d]||(a[a.length]=d,b[d]=!0)}return a.length==0?null:a.join(this.delim)};this.getSelectedCellIndex=function(){return this.cell!=null?this.cell._cellIndex:-1};this.getColWidth=function(a){return parseInt(this.cellWidthPX[a])};this.setColWidth=function(a,b){this._hrrar[a]||(this.cellWidthType=="px"?this.cellWidthPX[a]=parseInt(b):
this.cellWidthPC[a]=parseInt(b),this.setSizes())};this.getRowIndex=function(a){for(var b=0;b<this.rowsBuffer.length;b++)if(this.rowsBuffer[b]&&this.rowsBuffer[b].idd==a)return b;return-1};this.getRowId=function(a){return this.rowsBuffer[a]?this.rowsBuffer[a].idd:this.undefined};this.setRowId=function(a,b){this.changeRowId(this.getRowId(a),b)};this.changeRowId=function(a,b){if(a!=b){var c=this.rowsAr[a];c.idd=b;this.UserData[a]&&(this.UserData[b]=this.UserData[a],this.UserData[a]=null);if(this._h2&&
this._h2.get[a])this._h2.get[b]=this._h2.get[a],this._h2.get[b].id=b,delete this._h2.get[a];this.rowsAr[a]=null;this.rowsAr[b]=c;for(var d=0;d<c.childNodes.length;d++)if(c.childNodes[d]._code)c.childNodes[d]._code=this._compileSCL(c.childNodes[d]._val,c.childNodes[d]);if(this._mat_links&&this._mat_links[a]){var i=this._mat_links[a];delete this._mat_links[a];for(var j in i)for(d=0;d<i[j].length;d++)this._compileSCL(i[j][d].original,i[j][d])}this.callEvent("onRowIdChange",[a,b])}};this.setColumnIds=
function(a){this.columnIds=a.split(this.delim)};this.setColumnId=function(a,b){this.columnIds[a]=b};this.getColIndexById=function(a){for(var b=0;b<this.columnIds.length;b++)if(this.columnIds[b]==a)return b};this.getColumnId=function(a){return this.columnIds[a]};this.getColLabel=this.getColumnLabel=function(a,b,c){for(var d=(c||this.hdr).rows[(b||0)+1],i=0;i<d.cells.length;i++)if(d.cells[i]._cellIndexS==a)return _isIE?d.cells[i].innerText:d.cells[i].textContent;return""};this.getFooterLabel=function(a,
b){return this.getColumnLabel(a,b,this.ftr)};this.setRowTextBold=function(a){var b=this.getRowById(a);if(b)b.style.fontWeight="bold"};this.setRowTextStyle=function(a,b){var c=this.getRowById(a);if(c)for(var d=0;d<c.childNodes.length;d++){var i=c.childNodes[d]._attrs.style||"";this._hrrar&&this._hrrar[d]&&(i="display:none;");c.childNodes[d].style.cssText=i+"width:"+c.childNodes[d].style.width+";"+b}};this.setRowColor=function(a,b){for(var c=this.getRowById(a),d=0;d<c.childNodes.length;d++)c.childNodes[d].bgColor=
b};this.setCellTextStyle=function(a,b,c){var d=this.getRowById(a);if(d){var i=d.childNodes[d._childIndexes?d._childIndexes[b]:b];if(i){var j="";this._hrrar&&this._hrrar[b]&&(j="display:none;");i.style.cssText=j+"width:"+i.style.width+";"+c}}};this.setRowTextNormal=function(a){var b=this.getRowById(a);if(b)b.style.fontWeight="normal"};this.doesRowExist=function(a){return this.getRowById(a)!=null?!0:!1};this.getColumnsNum=function(){return this._cCount};this.moveRowUp=function(a){var b=this.getRowById(a);
if(this.isTreeGrid())return this.moveRowUDTG(a,-1);var c=this.rowsCol._dhx_find(b);if(b.previousSibling&&c!=0){b.parentNode.insertBefore(b,b.previousSibling);this.rowsCol._dhx_swapItems(c,c-1);this.setSizes();var d=this.rowsBuffer._dhx_find(b);this.rowsBuffer._dhx_swapItems(d,d-1);this._cssEven&&this._fixAlterCss(c-1)}};this.moveRowDown=function(a){var b=this.getRowById(a);if(this.isTreeGrid())return this.moveRowUDTG(a,1);var c=this.rowsCol._dhx_find(b);if(b.nextSibling){this.rowsCol._dhx_swapItems(c,
c+1);b.nextSibling.nextSibling?b.parentNode.insertBefore(b,b.nextSibling.nextSibling):b.parentNode.appendChild(b);this.setSizes();var d=this.rowsBuffer._dhx_find(b);this.rowsBuffer._dhx_swapItems(d,d+1);this._cssEven&&this._fixAlterCss(c)}};this.getCombo=function(a){this.combos[a]||(this.combos[a]=new dhtmlXGridComboObject);return this.combos[a]};this.setUserData=function(a,b,c){a||(a="gridglobaluserdata");this.UserData[a]||(this.UserData[a]=new Hashtable);this.UserData[a].put(b,c)};this.getUserData=
function(a,b){a||(a="gridglobaluserdata");this.getRowById(a);var c=this.UserData[a];return c?c.get(b):""};this.setEditable=function(a){this.isEditable=convertStringToBoolean(a)};this.selectRowById=function(a,b,c,d){d||(d=!1);this.selectCell(this.getRowById(a),0,d,b,!1,c)};this.clearSelection=function(){this.editStop();for(var a=0;a<this.selectedRows.length;a++){var b=this.rowsAr[this.selectedRows[a].idd];if(b)b.className=b.className.replace(/rowselected/g,"")}this.selectedRows=dhtmlxArray();this.row=
null;if(this.cell!=null)this.cell.className=this.cell.className.replace(/cellselected/g,""),this.cell=null;this.callEvent("onSelectionCleared",[])};this.copyRowContent=function(a,b){var c=this.getRowById(a);if(this.isTreeGrid())this._copyTreeGridRowContent(c,a,b);else for(var d=0;d<c.cells.length;d++)this.cells(b,d).setValue(this.cells(a,d).getValue());if(!_isIE)this.getRowById(a).cells[0].height=c.cells[0].offsetHeight};this.setFooterLabel=function(a,b,c){return this.setColumnLabel(a,b,c,this.ftr)};
this.setColumnLabel=function(a,b,c,d){var i=(d||this.hdr).rows[c||1],j=i._childIndexes?i._childIndexes[a]:a;if(i.cells[j]){if(this.useImagesInHeader){i.cells[j].style.textAlign="left";i.cells[j].innerHTML="<img src='"+this.imgURL+""+b+"' onerror='this.src = \""+this.imgURL+"imageloaderror.gif\"'>";var k=new Image;k.src=this.imgURL+""+b.replace(/(\.[a-z]+)/,".des$1");this.preloadImagesAr[this.preloadImagesAr.length]=k;var l=new Image;l.src=this.imgURL+""+b.replace(/(\.[a-z]+)/,".asc$1");this.preloadImagesAr[this.preloadImagesAr.length]=
l}else{var m="<div class='hdrcell'>";if(b.indexOf("img:[")!=-1){var o=b.replace(/.*\[([^>]+)\].*/,"$1"),b=b.substr(b.indexOf("]")+1,b.length);m+="<img width='18px' height='18px' align='absmiddle' src='"+o+"' hspace='2'>"}m+=b;m+="</div>";i.cells[j].innerHTML=m;if(this._hstyles[j])i.cells[j].style.cssText=this._hstyles[j]}if((b||"").indexOf("#")!=-1){var n=b.match(/(^|{)#([^}]+)(}|$)/);if(n){var p="_in_header_"+n[2];if(this[p])this[p](this.forceDivInHeader?i.cells[j].firstChild:i.cells[j],j,b.split(n[0]))}}}};
this.setColLabel=function(a,b,c,d){return this.setColumnLabel(a,b,(c||0)+1,d)};this.clearAll=function(a){if(this.obj.rows[0]){if(this._h2&&(this._h2=new dhtmlxHierarchy,this._fake))this._realfake?this._h2=this._fake._h2:this._fake._h2=this._h2;this.limit=this._limitC=0;this.editStop(!0);this._dLoadTimer&&window.clearTimeout(this._dLoadTimer);if(this._dload)this.objBox.scrollTop=0,this.limit=this._limitC||0,this._initDrF=!0;for(var b=this.rowsCol.length,b=this.obj.rows.length,c=b-1;c>0;c--){var d=
this.obj.rows[c];d.parentNode.removeChild(d)}if(a){this._master_row=null;this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);for(c=this.hdr.rows.length-1;c>=0;c--)d=this.hdr.rows[c],d.parentNode.removeChild(d);if(this.ftr)this.ftr.parentNode.removeChild(this.ftr),this.ftr=null;this._aHead=this.ftr=this.cellWidth=this._aFoot=null;this.cellType=dhtmlxArray();this._hrrar=[];this.columnIds=[];this.combos=[];this._ivizcol=null}this.cell=this.row=null;this.rowsCol=dhtmlxArray();this.rowsAr={};this._RaSeCol=
[];this.rowsBuffer=dhtmlxArray();this.UserData=[];this.selectedRows=dhtmlxArray();if(this.pagingOn||this._srnd)this.xmlFileUrl="";this.pagingOn&&this.changePage(1);this._contextCallTimer&&window.clearTimeout(this._contextCallTimer);this._sst&&this.enableStableSorting(!0);this._fillers=this.undefined;this.setSortImgState(!1);this.setSizes();this.callEvent("onClearAll",[])}};this.sortField=function(a,b,c){if(this.getRowsNum()==0)return!1;var d=this.hdr.rows[0].cells[a];if(d&&d.tagName=="TH"&&this.fldSort.length-
1>=d._cellIndex&&this.fldSort[d._cellIndex]!="na"){var i=this.getSortingState(),j=i[0]==a&&i[1]=="asc"?"des":"asc";if(this.callEvent("onBeforeSorting",[a,this.fldSort[a],j])){this.sortImg.src=this.imgURL+"sort_"+(j=="asc"?"asc":"desc")+".gif";if(this.useImagesInHeader){var k=this.hdr.rows[1].cells[d._cellIndex].firstChild;if(this.fldSorted!=null){var l=this.hdr.rows[1].cells[this.fldSorted._cellIndex].firstChild;l.src=l.src.replace(/(\.asc\.)|(\.des\.)/,".")}k.src=k.src.replace(/(\.[a-z]+)$/,"."+
j+"$1")}this.sortRows(d._cellIndex,this.fldSort[d._cellIndex],j);this.fldSorted=d;this.r_fldSorted=c;var m=this.hdr.rows[1],m=c.parentNode,o=m._childIndexes?m._childIndexes[d._cellIndex]:d._cellIndex;this.setSortImgPos(!1,!1,!1,c)}}};this.setCustomSorting=function(a,b){if(!this._customSorts)this._customSorts=[];this._customSorts[b]=typeof a=="string"?eval(a):a;this.fldSort[b]="cus"};this.enableHeaderImages=function(a){this.useImagesInHeader=a};this.setHeader=function(a,b,c){for(var d=typeof a!="object"?
this._eSplit(a):[].concat(a),i=[],j=new dhtmlxArray(0),k=[],l=[],m=[],o=0;o<d.length;o++)i[i.length]=Math.round(100/d.length),j[j.length]="ed",k[k.length]="left",l[l.length]="middle",m[m.length]="na";this.splitSign=b||"#cspan";this.hdrLabels=d;this.cellWidth=i;this.initCellWidth.length||this.setInitWidthsP(i.join(this.delim),!0);this.cellType=j;this.cellAlign=k;this.cellVAlign=l;this.fldSort=m;this._hstyles=c||[]};this._eSplit=function(a){if(![].push)return a.split(this.delim);var b="r"+(new Date).valueOf(),
c=this.delim.replace(/([\|\+\*\^])/g,"\\$1");return(a||"").replace(RegExp(c,"g"),b).replace(RegExp("\\\\"+b,"g"),this.delim).split(b)};this.getColType=function(a){return this.cellType[a]};this.getColTypeById=function(a){return this.cellType[this.getColIndexById(a)]};this.setColTypes=function(a){this.cellType=dhtmlxArray(a.split(this.delim));this._strangeParams=[];for(var b=0;b<this.cellType.length;b++){if(this.cellType[b].indexOf("[")!=-1){var c=this.cellType[b].split(/[\[\]]+/g);this.cellType[b]=
c[0];this.defVal[b]=c[1];c[1].indexOf("=")==0&&(this.cellType[b]="math",this._strangeParams[b]=c[0])}window["eXcell_"+this.cellType[b]]||dhtmlxError.throwError("Configuration","Incorrect cell type: "+this.cellType[b],[this,this.cellType[b]])}};this.setColSorting=function(a){this.fldSort=a.split(this.delim);for(var b=0;b<this.fldSort.length;b++)if(this.fldSort[b].length>4&&typeof window[this.fldSort[b]]=="function"){if(!this._customSorts)this._customSorts=[];this._customSorts[b]=window[this.fldSort[b]];
this.fldSort[b]="cus"}};this.setColAlign=function(a){this.cellAlign=a.split(this.delim);for(var b=0;b<this.cellAlign.length;b++)this.cellAlign[b]=this.cellAlign[b]._dhx_trim()};this.setColVAlign=function(a){this.cellVAlign=a.split(this.delim)};this.setNoHeader=function(a){this.noHeader=convertStringToBoolean(a)};this.showRow=function(a){this.getRowById(a);this._h2&&this.openItem(this._h2.get[a].parent.id);for(var b=this.getRowById(a).childNodes[0];b&&b.style.display=="none";)b=b.nextSibling;b&&this.moveToVisible(b,
!0)};this.setStyle=function(a,b,c,d){this.ssModifier=[a,b,c,c,d];for(var i=["#"+this.entBox.id+" table.hdr td","#"+this.entBox.id+" table.obj td","#"+this.entBox.id+" table.obj tr.rowselected td.cellselected","#"+this.entBox.id+" table.obj td.cellselected","#"+this.entBox.id+" table.obj tr.rowselected td"],j=0;!_isIE;){try{var k=document.styleSheets[j].cssRules.length}catch(l){j++;continue}break}for(var m=0;m<i.length;m++)this.ssModifier[m]&&(_isIE?document.styleSheets[0].addRule(i[m],this.ssModifier[m]):
document.styleSheets[j].insertRule(i[m]+(" { "+this.ssModifier[m]+" }"),document.styleSheets[j].cssRules.length))};this.setColumnColor=function(a){this.columnColor=a.split(this.delim)};this.enableAlterCss=function(a,b,c,d){(a||b)&&this.attachEvent("onGridReconstructed",function(){this._fixAlterCss();this._fake&&this._fake._fixAlterCss()});this._cssSP=c;this._cssSU=d;this._cssEven=a;this._cssUnEven=b};this._fixAlterCss=function(a){if(this._h2&&(this._cssSP||this._cssSU))return this._fixAlterCssTGR(a);
if(this._cssEven||this._cssUnEven)for(var b=a=a||0,c=a;c<this.rowsCol.length;c++)if(this.rowsCol[c]&&this.rowsCol[c].style.display!="none")this.rowsCol[c]._cntr?b=1:(this.rowsCol[c].className=this.rowsCol[c].className.indexOf("rowselected")!=-1?b%2==1?this._cssUnEven+" rowselected "+(this.rowsCol[c]._css||""):this._cssEven+" rowselected "+(this.rowsCol[c]._css||""):b%2==1?this._cssUnEven+" "+(this.rowsCol[c]._css||""):this._cssEven+" "+(this.rowsCol[c]._css||""),b++)};this.clearChangedState=function(){for(var a=
0;a<this.rowsCol.length;a++)for(var b=this.rowsCol[a],c=b.childNodes.length,d=0;d<c;d++)b.childNodes[d].wasChanged=!1};this.getChangedRows=function(a){var b=[];this.forEachRow(function(c){var d=this.rowsAr[c];if(d.tagName=="TR"){var i=d.childNodes.length;if(a&&d._added)b[b.length]=d.idd;else for(var j=0;j<i;j++)if(d.childNodes[j].wasChanged){b[b.length]=d.idd;break}}});return b.join(this.delim)};this._sAll=this._sUDa=!1;this.setSerializationLevel=function(a,b,c,d,i,j){this._sUDa=a;this._sAll=b;this._sConfig=
c;this._chAttr=d;this._onlChAttr=i;this._asCDATA=j};this.setSerializableColumns=function(a){if(a){this._srClmn=(a||"").split(",");for(var b=0;b<this._srClmn.length;b++)this._srClmn[b]=convertStringToBoolean(this._srClmn[b])}else this._srClmn=null};this._serialise=function(){this.editStop();var a=[],b="</"+this.xml.s_row+">";if(this.isTreeGrid())this._h2.forEachChildF(0,function(b){var c=this._serializeRow(this.render_row_tree(-1,b.id));a.push(c);return c?!0:!1},this,function(){a.push(b)});else for(var c=
0;c<this.rowsBuffer.length;c++)if(this.rowsBuffer[c]){var d=this._serializeRow(this.render_row(c));a.push(d);d&&a.push(b)}return[a.join("")]};this._serializeRow=function(a,b){var c=[],d=this.xml.row_attrs,i=this.xml.cell_attrs;c.push("<"+this.xml.s_row);c.push(" id='"+a.idd+"'");this._sAll&&this.selectedRows._dhx_find(a)!=-1&&c.push(" selected='1'");this._h2&&this._h2.get[a.idd].state=="minus"&&c.push(" open='1'");if(d.length)for(b=0;b<d.length;b++)c.push(" "+d[b]+"='"+a._attrs[d[b]]+"'");c.push(">");
if(this._sUDa&&this.UserData[a.idd]){keysAr=this.UserData[a.idd].getKeys();for(var j=0;j<keysAr.length;j++)c.push("<userdata name='"+keysAr[j]+"'>"+(this._asCDATA?"<![CDATA[":"")+this.UserData[a.idd].get(keysAr[j])+(this._asCDATA?"]]\>":"")+"</userdata>")}for(var k=!1,l=0;l<this._cCount;l++)if(!this._srClmn||this._srClmn[l]){var m=this.cells3(a,l);c.push("<cell");if(i.length)for(b=0;b<i.length;b++)c.push(" "+i[b]+"='"+m.cell._attrs[i[b]]+"'");zxVal=m[this._agetm]();this._asCDATA&&(zxVal="<![CDATA["+
zxVal+"]]\>");this._ecspn&&m.cell.colSpan&&m.cell.colSpan>1&&c.push(' colspan="'+m.cell.colSpan+'" ');this._chAttr?m.wasChanged()&&(c.push(' changed="1"'),k=!0):this._onlChAttr&&m.wasChanged()&&(k=!0);this._sAll&&this.cellType[l]=="tree"?c.push((this._h2?" image='"+this._h2.get[a.idd].image+"'":"")+">"+zxVal+"</cell>"):c.push(">"+zxVal+"</cell>");if(this._ecspn&&m.cell.colSpan)for(var o=0;o<m.cell.colSpan-1;o++)c.push("<cell/>"),l++}return this._onlChAttr&&!k&&!a._added?"":c.join("")};this._serialiseConfig=
function(){for(var a="<head>",b=0;b<this.hdr.rows[0].cells.length;b++)if(!this._srClmn||this._srClmn[b]){var c=this.fldSort[b];c=="cus"&&(c=this._customSorts[b].toString(),c=c.replace(/function[\ ]*/,"").replace(/\([^\f]*/,""));a+="<column width='"+this.getColWidth(b)+"' align='"+this.cellAlign[b]+"' type='"+this.cellType[b]+"' sort='"+(c||"na")+"' color='"+this.columnColor[b]+"'"+(this.columnIds[b]?" id='"+this.columnIds[b]+"'":"")+">";a+=this._asCDATA?"<![CDATA["+this.getHeaderCol(b)+"]]\>":this.getHeaderCol(b);
var d=this.getCombo(b);if(d)for(var i=0;i<d.keys.length;i++)a+="<option value='"+d.keys[i]+"'>"+d.values[i]+"</option>";a+="</column>"}return a+="</head>"};this.serialize=function(){var a='<?xml version="1.0"?><rows>';this._agetm=this._mathSerialization?"getMathValue":"getValue";if(this._sUDa&&this.UserData.gridglobaluserdata)for(var b=this.UserData.gridglobaluserdata.getKeys(),c=0;c<b.length;c++)a+="<userdata name='"+b[c]+"'>"+this.UserData.gridglobaluserdata.get(b[c])+"</userdata>";this._sConfig&&
(a+=this._serialiseConfig());a+=this._serialise();a+="</rows>";return a};this.getPosition=function(a,b){if(!b&&!_isChrome){var c=getOffset(a);return[c.left,c.top]}for(var b=b||document.body,d=a,i=0,j=0;d&&d!=b;)i+=d.offsetLeft-d.scrollLeft,j+=d.offsetTop-d.scrollTop,d=d.offsetParent;b==document.body&&(_isIE?(j+=document.body.offsetTop||document.documentElement.offsetTop,i+=document.body.offsetLeft||document.documentElement.offsetLeft):_isFF||(i+=document.body.offsetLeft,j+=document.body.offsetTop));
return[i,j]};this.getFirstParentOfType=function(a,b){for(;a&&a.tagName!=b&&a.tagName!="BODY";)a=a.parentNode;return a};this.objBox.onscroll=function(){this.grid._doOnScroll()};if(!_isOpera||_OperaRv>8.5)this.hdr.onmousemove=function(a){this.grid.changeCursorState(a||window.event)},this.hdr.onmousedown=function(a){return this.grid.startColResize(a||window.event)};this.obj.onmousemove=this._drawTooltip;this.objBox.onclick=function(a){(a||event).cancelBubble=!0};this.obj.onclick=function(a){this.grid._doClick(a||
window.event);this.grid._sclE&&this.grid.editCell(a||window.event);(a||event).cancelBubble=!0};_isMacOS?this.entBox.oncontextmenu=function(a){a.cancelBubble=!0;a.returnValue=!1;return this.grid._doContClick(a||window.event)}:(this.entBox.onmousedown=function(a){return this.grid._doContClick(a||window.event)},this.entBox.oncontextmenu=function(a){if(this.grid._ctmndx)(a||event).cancelBubble=!0;return!this.grid._ctmndx});this.obj.ondblclick=function(a){if(!this.grid.wasDblClicked(a||window.event))return!1;
if(this.grid._dclE){var b=this.grid.getFirstParentOfType(_isIE?event.srcElement:a.target,"TR");b==this.grid.row&&this.grid.editCell(a||window.event)}(a||event).cancelBubble=!0;if(_isOpera)return!1};this.hdr.onclick=this._onHeaderClick;this.sortImg.onclick=function(){b._onHeaderClick.apply({grid:b},[null,b.r_fldSorted])};this.hdr.ondblclick=this._onHeaderDblClick;if(!document.body._dhtmlxgrid_onkeydown)dhtmlxEvent(document,_isOpera?"keypress":"keydown",function(a){if(globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.doKey(a||
window.event)}),document.body._dhtmlxgrid_onkeydown=!0;dhtmlxEvent(document.body,"click",function(){b.editStop&&b.editStop();b.isActive&&b.setActive(!1)});this.entBox.onbeforeactivate=function(){this._still_active=null;this.grid.setActive();event.cancelBubble=!0};this.entBox.onbeforedeactivate=function(){this.grid._still_active?this.grid._still_active=null:this.grid.isActive=!1;event.cancelBubble=!0};if(this.entBox.style.height.toString().indexOf("%")!=-1)this._delta_y=this.entBox.style.height;if(this.entBox.style.width.toString().indexOf("%")!=
-1)this._delta_x=this.entBox.style.width;(this._delta_x||this._delta_y)&&this._setAutoResize();this.setColHidden=this.setColumnsVisibility;this.enableCollSpan=this.enableColSpan;this.setMultiselect=this.enableMultiselect;this.setMultiLine=this.enableMultiline;this.deleteSelectedItem=this.deleteSelectedRows;this.getSelectedId=this.getSelectedRowId;this.getHeaderCol=this.getColumnLabel;this.isItemExists=this.doesRowExist;this.getColumnCount=this.getColumnsNum;this.setSelectedRow=this.selectRowById;
this.setHeaderCol=this.setColumnLabel;this.preventIECashing=this.preventIECaching;this.enableAutoHeigth=this.enableAutoHeight;this.getUID=this.uid;dhtmlx.image_path&&this.setImagePath(dhtmlx.image_path);dhtmlx.skin&&this.setSkin(dhtmlx.skin);return this}
dhtmlXGridObject.prototype={getRowAttribute:function(a,c){return this.getRowById(a)._attrs[c]},setRowAttribute:function(a,c,b){this.getRowById(a)._attrs[c]=b},isTreeGrid:function(){return this.cellType._dhx_find("tree")!=-1},setRowHidden:function(a,c){var b=convertStringToBoolean(c),d=this.getRowById(a);if(d){d.expand===""&&this.collapseKids(d);if(c&&d.style.display!="none"){d.style.display="none";var e=this.selectedRows._dhx_find(d);if(e!=-1){d.className=d.className.replace("rowselected","");for(var h=
0;h<d.childNodes.length;h++)d.childNodes[h].className=d.childNodes[h].className.replace(/cellselected/g,"");this.selectedRows._dhx_removeAt(e)}this.callEvent("onGridReconstructed",[])}if(!c&&d.style.display=="none")d.style.display="",this.callEvent("onGridReconstructed",[]);this.callEvent("onRowHide",[a,c]);this.setSizes()}},setColumnHidden:function(a,c){if(!this.hdr.rows.length){if(!this._ivizcol)this._ivizcol=[];return this._ivizcol[a]=c}if(this.fldSorted&&this.fldSorted.cellIndex==a&&c)this.sortImg.style.display=
"none";var b=convertStringToBoolean(c);if(b){if(this._hrrar){if(this._hrrar[a])return}else this._hrrar=[];this._hrrar[a]="display:none;";this._hideShowColumn(a,"none")}else{if(!this._hrrar||!this._hrrar[a])return;this._hrrar[a]="";this._hideShowColumn(a,"")}if(this.fldSorted&&this.fldSorted.cellIndex==a&&!c)this.sortImg.style.display="inline";this.setSortImgPos();this.callEvent("onColumnHidden",[a,c])},isColumnHidden:function(a){return this._hrrar&&this._hrrar[a]?!0:!1},setColumnsVisibility:function(a){if(a)this._ivizcol=
a.split(this.delim);if(this.hdr.rows.length&&this._ivizcol)for(var c=0;c<this._ivizcol.length;c++)this.setColumnHidden(c,this._ivizcol[c])},_fixHiddenRowsAll:function(a,c,b,d,e){for(var e=e||"_cellIndex",h=a.rows.length,g=0;g<h;g++){var f=a.rows[g].childNodes;if(f.length!=this._cCount)for(var i=0;i<f.length;i++){if(f[i][e]==c){f[i].style[b]=d;break}}else f[c].style[b]=d}},_hideShowColumn:function(a,c){var b=a;this.hdr.rows[1]._childIndexes&&this.hdr.rows[1]._childIndexes[a]!=a&&(b=this.hdr.rows[1]._childIndexes[a]);
if(c=="none"){this.hdr.rows[0].cells[a]._oldWidth=this.hdr.rows[0].cells[a].style.width||this.initCellWidth[a]+"px";this.hdr.rows[0].cells[a]._oldWidthP=this.cellWidthPC[a];this.obj.rows[0].cells[a].style.width="0px";var d={rows:[this.obj.rows[0]]};this.forEachRow(function(a){this.rowsAr[a].tagName=="TR"&&d.rows.push(this.rowsAr[a])});this._fixHiddenRowsAll(d,a,"display","none");this.isTreeGrid()&&this._fixHiddenRowsAllTG(a,"none");(_isOpera&&_OperaRv<9||_isKHTML||_isFF)&&this._fixHiddenRowsAll(this.hdr,
a,"display","none","_cellIndexS");this.ftr&&this._fixHiddenRowsAll(this.ftr.childNodes[0],a,"display","none");this._fixHiddenRowsAll(this.hdr,a,"whiteSpace","nowrap","_cellIndexS");if(!this.cellWidthPX.length&&!this.cellWidthPC.length)this.cellWidthPX=[].concat(this.initCellWidth);this.cellWidthPX[a]&&(this.cellWidthPX[a]=0);this.cellWidthPC[a]&&(this.cellWidthPC[a]=0)}else if(this.hdr.rows[0].cells[a]._oldWidth){var e=this.hdr.rows[0].cells[a];(_isOpera||_isKHTML||_isFF)&&this._fixHiddenRowsAll(this.hdr,
a,"display","","_cellIndexS");this.ftr&&this._fixHiddenRowsAll(this.ftr.childNodes[0],a,"display","");d={rows:[this.obj.rows[0]]};this.forEachRow(function(a){this.rowsAr[a].tagName=="TR"&&d.rows.push(this.rowsAr[a])});this._fixHiddenRowsAll(d,a,"display","");this.isTreeGrid()&&this._fixHiddenRowsAllTG(a,"");this._fixHiddenRowsAll(this.hdr,a,"whiteSpace","normal","_cellIndexS");if(e._oldWidthP)this.cellWidthPC[a]=e._oldWidthP;e._oldWidth&&(this.cellWidthPX[a]=parseInt(e._oldWidth))}this.setSizes();
if(!_isIE&&!_isFF)this.obj.border=1,this.obj.border=0},enableColSpan:function(a){this._ecspn=convertStringToBoolean(a)},enableRowsHover:function(a,c){this._unsetRowHover(!1,!0);this._hvrCss=c;if(convertStringToBoolean(a)){if(!this._elmnh)this.obj._honmousemove=this.obj.onmousemove,this.obj.onmousemove=this._setRowHover,_isIE?this.obj.onmouseleave=this._unsetRowHover:this.obj.onmouseout=this._unsetRowHover,this._elmnh=!0}else if(this._elmnh)this.obj.onmousemove=this.obj._honmousemove,_isIE?this.obj.onmouseleave=
null:this.obj.onmouseout=null,this._elmnh=!1},enableEditEvents:function(a,c,b){this._sclE=convertStringToBoolean(a);this._dclE=convertStringToBoolean(c);this._f2kE=convertStringToBoolean(b)},enableLightMouseNavigation:function(a){if(convertStringToBoolean(a)){if(!this._elmn)this.entBox._onclick=this.entBox.onclick,this.entBox.onclick=function(){return!0},this.obj._onclick=this.obj.onclick,this.obj.onclick=function(a){var b=this.grid.getFirstParentOfType(a?a.target:event.srcElement,"TD");if(b)this.grid.editStop(),
this.grid.doClick(b),this.grid.editCell(),(a||event).cancelBubble=!0},this.obj._onmousemove=this.obj.onmousemove,this.obj.onmousemove=this._autoMoveSelect,this._elmn=!0}else if(this._elmn)this.entBox.onclick=this.entBox._onclick,this.obj.onclick=this.obj._onclick,this.obj.onmousemove=this.obj._onmousemove,this._elmn=!1},_unsetRowHover:function(a,c){that=c?this:this.grid;if(that._lahRw&&that._lahRw!=c){for(var b=0;b<that._lahRw.childNodes.length;b++)that._lahRw.childNodes[b].className=that._lahRw.childNodes[b].className.replace(that._hvrCss,
"");that._lahRw=null}},_setRowHover:function(a){var c=this.grid.getFirstParentOfType(a?a.target:event.srcElement,"TD");if(c&&c.parentNode!=this.grid._lahRw){this.grid._unsetRowHover(0,c);c=c.parentNode;if(!c.idd||c.idd=="__filler__")return;for(var b=0;b<c.childNodes.length;b++)c.childNodes[b].className+=" "+this.grid._hvrCss;this.grid._lahRw=c}this._honmousemove(a)},_autoMoveSelect:function(a){if(!this.grid.editor){var c=this.grid.getFirstParentOfType(a?a.target:event.srcElement,"TD");c.parentNode.idd&&
this.grid.doClick(c,!0,0)}this._onmousemove(a)},enableDistributedParsing:function(a,c,b){convertStringToBoolean(a)?(this._ads_count=c||10,this._ads_time=b||250):this._ads_count=0},destructor:function(){this.editStop(!0);if(this._sizeTime)this._sizeTime=window.clearTimeout(this._sizeTime);this.entBox.className=(this.entBox.className||"").replace(/gridbox.*/,"");if(this.formInputs)for(var a=0;a<this.formInputs.length;a++)this.parentForm.removeChild(this.formInputs[a]);var c;this.xmlLoader=this.xmlLoader.destructor();
for(a=0;a<this.rowsCol.length;a++)if(this.rowsCol[a])this.rowsCol[a].grid=null;for(a in this.rowsAr)this.rowsAr[a]&&(this.rowsAr[a]=null);this.rowsCol=new dhtmlxArray;this.rowsAr={};this.entBox.innerHTML="";var b=function(){};this.setSizes=this._update_srnd_view=this.callEvent=this.entBox.onclick=this.entBox.onmousedown=this.entBox.onbeforeactivate=this.entBox.onbeforedeactivate=this.entBox.onbeforedeactivate=this.entBox.onselectstart=b;this.entBox.grid=this.objBox.grid=this.hdrBox.grid=this.obj.grid=
this.hdr.grid=null;if(this._fake)this.globalBox.innerHTML="",this._fake.setSizes=this._fake._update_srnd_view=this._fake.callEvent=b,this.globalBox.onclick=this.globalBox.onmousedown=this.globalBox.onbeforeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onselectstart=b;for(c in this){if(this[c]&&this[c].m_obj)this[c].m_obj=null;this[c]=null}this==globalActiveDHTMLGridObject&&(globalActiveDHTMLGridObject=null);return null},getSortingState:function(){var a=
[];if(this.fldSorted)a[0]=this.fldSorted._cellIndex,a[1]=this.sortImg.src.indexOf("sort_desc.gif")!=-1?"des":"asc";return a},enableAutoHeight:function(a,c,b){this._ahgr=convertStringToBoolean(a);this._ahgrF=convertStringToBoolean(b);this._ahgrM=c||null;if(arguments.length==1)this.objBox.style.overflowY=a?"hidden":"auto";if(c=="auto")this._ahgrM=null,this._ahgrMA=!0,this._setAutoResize()},enableStableSorting:function(a){this._sst=convertStringToBoolean(a);this.rowsCol.stablesort=function(a){for(var b=
this.length-1,d=0;d<this.length-1;d++){for(var e=0;e<b;e++)if(a(this[e],this[e+1])>0){var h=this[e];this[e]=this[e+1];this[e+1]=h}b--}}},enableKeyboardSupport:function(a){this._htkebl=!convertStringToBoolean(a)},enableContextMenu:function(a){this._ctmndx=a},setScrollbarWidthCorrection:function(){},enableTooltips:function(a){this._enbTts=a.split(",");for(var c=0;c<this._enbTts.length;c++)this._enbTts[c]=convertStringToBoolean(this._enbTts[c])},enableResizing:function(a){this._drsclmn=a.split(",");
for(var c=0;c<this._drsclmn.length;c++)this._drsclmn[c]=convertStringToBoolean(this._drsclmn[c])},setColumnMinWidth:function(a,c){if(arguments.length==2){if(!this._drsclmW)this._drsclmW=[];this._drsclmW[c]=a}else this._drsclmW=a.split(",")},enableCellIds:function(a){this._enbCid=convertStringToBoolean(a)},lockRow:function(a,c){var b=this.getRowById(a);if(b)b._locked=convertStringToBoolean(c),this.cell&&this.cell.parentNode.idd==a&&this.editStop()},_getRowArray:function(a){for(var c=[],b=0;b<a.childNodes.length;b++){var d=
this.cells3(a,b);c[b]=d.getValue()}return c},setDateFormat:function(a,c){this._dtmask=a;this._dtmask_inc=c},setNumberFormat:function(a,c,b,d){var e=a.replace(/[^0\,\.]*/g,""),h=e.indexOf(".");h>-1&&(h=e.length-h-1);var g=e.indexOf(",");g>-1&&(g=e.length-h-2-g);if(typeof b!="string")b=this.i18n.decimal_separator;if(typeof d!="string")d=this.i18n.group_separator;var f=a.split(e)[0],i=a.split(e)[1];this._maskArr[c]=[h,g,f,i,b,d]},_aplNFb:function(a,c){var b=this._maskArr[c];if(!b)return a;var d=parseFloat(a.toString().replace(/[^0-9]*/g,
""));a.toString().substr(0,1)=="-"&&(d*=-1);b[0]>0&&(d/=Math.pow(10,b[0]));return d},_aplNF:function(a,c){var b=this._maskArr[c];if(!b)return a;var d=(parseFloat(a)<0?"-":"")+b[2],a=Math.abs(Math.round(parseFloat(a)*Math.pow(10,b[0]>0?b[0]:0))).toString(),a=(a.length<b[0]?Math.pow(10,b[0]+1-a.length).toString().substr(1,b[0]+1)+a.toString():a).split("").reverse();a[b[0]]=(a[b[0]]||"0")+b[4];if(b[1]>0)for(var e=(b[0]>0?0:1)+b[0]+b[1];e<a.length;e+=b[1])a[e]+=b[5];return d+a.reverse().join("")+b[3]},
_launchCommands:function(a){for(var c=0;c<a.length;c++){for(var b=[],d=0;d<a[c].childNodes.length;d++)if(a[c].childNodes[d].nodeType==1)b[b.length]=a[c].childNodes[d].firstChild.data;this[a[c].getAttribute("command")].apply(this,b)}},_parseHead:function(a){var c=this.xmlLoader.doXPath("./head",a);if(c.length){var b=this.xmlLoader.doXPath("./column",c[0]),d=this.xmlLoader.doXPath("./settings",c[0]),e="setInitWidths",h=!1;if(d[0])for(var g=0;g<d[0].childNodes.length;g++)switch(d[0].childNodes[g].tagName){case "colwidth":d[0].childNodes[g].firstChild&&
d[0].childNodes[g].firstChild.data=="%"&&(e="setInitWidthsP");break;case "splitat":h=d[0].childNodes[g].firstChild?d[0].childNodes[g].firstChild.data:!1}this._launchCommands(this.xmlLoader.doXPath("./beforeInit/call",c[0]));if(b.length>0){this.hdr.rows.length>0&&this.clearAll(!0);for(var f=[[],[],[],[],[],[],[],[],[]],i=",width,type,align,sort,color,format,hidden,id".split(","),j=["",e,"setColTypes","setColAlign","setColSorting","setColumnColor","","","setColumnIds"],k=0;k<b.length;k++){for(var l=
1;l<i.length;l++)f[l].push(b[k].getAttribute(i[l]));f[0].push((b[k].firstChild?b[k].firstChild.data:"").replace(/^\s*((\s\S)*.+)\s*$/gi,"$1"))}this.setHeader(f[0]);for(k=0;k<j.length;k++)if(j[k])this[j[k]](f[k].join(this.delim));for(k=0;k<b.length;k++)if(this.cellType[k].indexOf("co")==0||this.cellType[k]=="clist"){var m=this.xmlLoader.doXPath("./option",b[k]);if(m.length){var o=[];if(this.cellType[k]=="clist"){for(l=0;l<m.length;l++)o[o.length]=m[l].firstChild?m[l].firstChild.data:"";this.registerCList(k,
o)}else for(var n=this.getCombo(k),l=0;l<m.length;l++)n.put(m[l].getAttribute("value"),m[l].firstChild?m[l].firstChild.data:"")}}else f[6][k]&&(this.cellType[k].toLowerCase().indexOf("calendar")!=-1||this.fldSort[k]=="date"?this.setDateFormat(f[6][k]):this.setNumberFormat(f[6][k],k));this.init();var p=f[7].join(this.delim);this.setColHidden&&p.replace(/,/g,"")!=""&&this.setColHidden(p);h&&this.splitAt&&this.splitAt(h)}this._launchCommands(this.xmlLoader.doXPath("./afterInit/call",c[0]))}var r=this.xmlLoader.doXPath("//rows/userdata",
a);if(r.length>0){this.UserData.gridglobaluserdata||(this.UserData.gridglobaluserdata=new Hashtable);for(l=0;l<r.length;l++){for(var t="",s=0;s<r[l].childNodes.length;s++)t+=r[l].childNodes[s].nodeValue;this.UserData.gridglobaluserdata.put(r[l].getAttribute("name"),t)}}},getCheckedRows:function(a){var c=[];this.forEachRowA(function(b){this.cells(b,a).getValue()!=0&&c.push(b)},!0);return c.join(",")},checkAll:function(){for(var a=arguments.length?arguments[0]:1,c=0;c<this.getColumnsNum();c++)this.getColType(c)==
"ch"&&this.setCheckedRows(c,a)},uncheckAll:function(){this.checkAll(0)},setCheckedRows:function(a,c){this.forEachRowA(function(b){this.cells(b,a).isCheckbox()&&this.cells(b,a).setValue(c)})},_drawTooltip:function(a){var c=this.grid.getFirstParentOfType(a?a.target:event.srcElement,"TD");if(!c||this.grid.editor&&this.grid.editor.cell==c)return!0;var b=c.parentNode;if(b.idd&&b.idd!="__filler__"){var d=a?a.target:event.srcElement;if(b.idd==window.unknown)return!0;if(!this.grid.callEvent("onMouseOver",
[b.idd,c._cellIndex,a||window.event]))return!0;if(this.grid._enbTts&&!this.grid._enbTts[c._cellIndex]){if(d.title)d.title="";return!0}if(!(c._cellIndex>=this.grid._cCount)){var e=this.grid.cells3(b,c._cellIndex);if(e&&e.cell&&e.cell._attrs){if(d._title)e.cell.title="";if(!e.cell._attrs.title)d._title=!0;if(e)d.title=e.cell._attrs.title||(e.getTitle?e.getTitle():(e.getValue()||"").toString().replace(/<[^>]*>/gi,""));return!0}}}},enableCellWidthCorrection:function(a){if(_isFF)this._wcorr=parseInt(a)},
getAllRowIds:function(a){for(var c=[],b=0;b<this.rowsBuffer.length;b++)this.rowsBuffer[b]&&c.push(this.rowsBuffer[b].idd);return c.join(a||this.delim)},getAllItemIds:function(){return this.getAllRowIds()},setColspan:function(a,c,b){if(this._ecspn){var d=this.getRowById(a);if(d._childIndexes&&d.childNodes[d._childIndexes[c]]){var e=d._childIndexes[c],h=d.childNodes[e],g=h.colSpan;h.colSpan=1;if(g&&g!=1)for(var f=1;f<g;f++){var i=document.createElement("TD");h.nextSibling?d.insertBefore(i,h.nextSibling):
d.appendChild(i);d._childIndexes[c+f]=e+f;i._cellIndex=c+f;i.style.textAlign=this.cellAlign[f];i.style.verticalAlign=this.cellVAlign[f];h=i;this.cells3(d,c+f).setValue("")}for(var j=c*1+1*g;j<d._childIndexes.length;j++)d._childIndexes[j]+=(g-1)*1}if(b&&b>1){if(d._childIndexes)e=d._childIndexes[c];else{e=c;d._childIndexes=[];for(j=0;j<d.childNodes.length;j++)d._childIndexes[j]=j}d.childNodes[e].colSpan=b;for(j=1;j<b;j++)d._childIndexes[d.childNodes[e+1]._cellIndex]=e,d.removeChild(d.childNodes[e+1]);
for(var k=d.childNodes[d._childIndexes[c]]._cellIndex,j=k*1+1*b;j<d._childIndexes.length;j++)d._childIndexes[j]-=b-1}}},preventIECaching:function(a){this.no_cashe=convertStringToBoolean(a);this.xmlLoader.rSeed=this.no_cashe},enableColumnAutoSize:function(a){this._eCAS=convertStringToBoolean(a)},_onHeaderDblClick:function(a){var c=this.grid,b=c.getFirstParentOfType(_isIE?event.srcElement:a.target,"TD");if(!c._eCAS)return!1;c.adjustColumnSize(b._cellIndexS)},adjustColumnSize:function(a,c){if(!this._hrrar||
!this._hrrar[a]){this._notresize=!0;var b=0;this._setColumnSizeR(a,20);for(var d=1;d<this.hdr.rows.length;d++){var e=this.hdr.rows[d];if((e=e.childNodes[e._childIndexes?e._childIndexes[a]:a])&&(!e.colSpan||e.colSpan<2)&&e._cellIndex==a)e.childNodes[0]&&e.childNodes[0].className=="hdrcell"&&(e=e.childNodes[0]),b=Math.max(b,_isFF||_isOpera?e.textContent.length*this.fontWidth:e.scrollWidth)}for(var h=this.obj.rows.length,g=1;g<h;g++){var f=this.obj.rows[g];this.rowsAr[f.idd]&&!(f._childIndexes&&f._childIndexes[a]!=
a)&&f.childNodes[a]&&(f=_isFF||_isOpera||c?f.childNodes[a].textContent.length*this.fontWidth:f.childNodes[a].scrollWidth,f>b&&(b=f))}b+=20+(c||0);this._setColumnSizeR(a,b);this._notresize=!1;this.setSizes()}},detachHeader:function(a,c){var c=c||this.hdr,b=c.rows[a+1];b&&b.parentNode.removeChild(b);this.setSizes()},detachFooter:function(a){this.detachHeader(a,this.ftr)},attachHeader:function(a,c,b){typeof a=="string"&&(a=this._eSplit(a));typeof c=="string"&&(c=c.split(this.delim));b=b||"_aHead";if(this.hdr.rows.length)if(a)this._createHRow([a,
c],this[b=="_aHead"?"hdr":"ftr"]);else{if(this[b])for(var d=0;d<this[b].length;d++)this.attachHeader.apply(this,this[b][d])}else this[b]||(this[b]=[]),this[b][this[b].length]=[a,c,b]},_createHRow:function(a,c){if(!c){if(this.entBox.style.position!="absolute")this.entBox.style.position="relative";var b=document.createElement("DIV");b.className="ftr";this.entBox.appendChild(b);var d=document.createElement("TABLE");d.cellPadding=d.cellSpacing=0;if(!_isIE)d.width="100%",d.style.paddingRight="20px";d.style.marginRight=
"20px";d.style.tableLayout="fixed";b.appendChild(d);d.appendChild(document.createElement("TBODY"));this.ftr=c=d;for(var e=d.insertRow(0),h=this.hdrLabels.length<=1?a[0].length:this.hdrLabels.length,g=0;g<h;g++)e.appendChild(document.createElement("TH")),e.childNodes[g]._cellIndex=g;_isIE&&_isIE<8?e.style.position="absolute":e.style.height="auto"}var f=a[1],b=document.createElement("TR");c.rows[0].parentNode.appendChild(b);for(g=0;g<a[0].length;g++)if(a[0][g]=="#cspan"){var i=b.cells[b.cells.length-
1];i.colSpan=(i.colSpan||1)+1}else if(a[0][g]=="#rspan"&&c.rows.length>1){for(var j=c.rows.length-2,k=!1,i=null;!k;){for(var i=c.rows[j],l=0;l<i.cells.length;l++)if(i.cells[l]._cellIndex==g){k=l+1;break}j--}i=i.cells[k-1];i.rowSpan=(i.rowSpan||1)+1}else{var m=document.createElement("TD");m._cellIndex=m._cellIndexS=g;if(this._hrrar&&this._hrrar[g]&&!_isIE)m.style.display="none";if(typeof a[0][g]=="object")m.appendChild(a[0][g]);else if(m.innerHTML=this.forceDivInHeader?"<div class='hdrcell'>"+(a[0][g]||
"&nbsp;")+"</div>":a[0][g]||"&nbsp;",(a[0][g]||"").indexOf("#")!=-1)if(d=a[0][g].match(/(^|{)#([^}]+)(}|$)/)){var o="_in_header_"+d[2];if(this[o])this[o](this.forceDivInHeader?m.firstChild:m,g,a[0][g].split(d[0]))}if(f)m.style.cssText=f[g];b.appendChild(m)}var n=c;if(_isKHTML)c._kTimer&&window.clearTimeout(c._kTimer),c._kTimer=window.setTimeout(function(){c.rows[1].style.display="none";window.setTimeout(function(){c.rows[1].style.display=""},1)},500)},attachFooter:function(a,c){this.attachHeader(a,
c,"_aFoot")},setCellExcellType:function(a,c,b){this.changeCellType(this.getRowById(a),c,b)},changeCellType:function(a,c,b){var b=b||this.cellType[c],d=this.cells3(a,c),e=d.getValue();d.cell._cellType=b;d=this.cells3(a,c);d.setValue(e)},setRowExcellType:function(a,c){for(var b=this.rowsAr[a],d=0;d<b.childNodes.length;d++)this.changeCellType(b,d,c)},setColumnExcellType:function(a,c){for(var b=0;b<this.rowsBuffer.length;b++)this.rowsBuffer[b]&&this.rowsBuffer[b].tagName=="TR"&&this.changeCellType(this.rowsBuffer[b],
a,c);this.cellType[a]=="math"?this._strangeParams[b]=c:this.cellType[a]=c},forEachRow:function(a){for(var c in this.rowsAr)this.rowsAr[c]&&this.rowsAr[c].idd&&a.apply(this,[this.rowsAr[c].idd])},forEachRowA:function(a){for(var c=0;c<this.rowsBuffer.length;c++)this.rowsBuffer[c]&&a.call(this,this.render_row(c).idd)},forEachCell:function(a,c){var b=this.getRowById(a);if(b)for(var d=0;d<this._cCount;d++)c(this.cells3(b,d),d)},enableAutoWidth:function(a,c,b){this._awdth=[convertStringToBoolean(a),parseInt(c||
99999),parseInt(b||0)];if(arguments.length==1)this.objBox.style.overflowX=a?"hidden":"auto"},updateFromXML:function(a,c,b,d){typeof c=="undefined"&&(c=!0);this._refresh_mode=[!0,c,b];this.load(a,d)},_refreshFromXML:function(a){this._f_rowsBuffer&&this.filterBy(0,"");reset=!1;if(window.eXcell_tree)eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue,eXcell_tree.prototype.setValue=function(a){var b=this.grid._h2.get[this.cell.parentNode.idd];b&&this.cell.parentNode.valTag?this.setLabel(a):
this.setValueX(a)};var c=this.cellType._dhx_find("tree");a.getXMLTopNode("rows");var b=a.doXPath("//rows")[0].getAttribute("parent")||0,d={};this._refresh_mode[2]&&(c!=-1?this._h2.forEachChild(b,function(a){d[a.id]=!0},this):this.forEachRow(function(a){d[a]=!0}));for(var e=a.doXPath("//row"),h=0;h<e.length;h++){var g=e[h],f=g.getAttribute("id");d[f]=!1;b=g.parentNode.getAttribute("id")||b;if(this.rowsAr[f]&&this.rowsAr[f].tagName!="TR")this._h2?this._h2.get[f].buff.data=g:this.rowsBuffer[this.getRowIndex(f)].data=
g,this.rowsAr[f]=g;else if(this.rowsAr[f])this._process_xml_row(this.rowsAr[f],g,-1),this._postRowProcessing(this.rowsAr[f],!0);else if(this._refresh_mode[1]){var i={idd:f,data:g,_parser:this._process_xml_row,_locator:this._get_xml_data},j=this.rowsBuffer.length;this._refresh_mode[1]=="top"?(this.rowsBuffer.unshift(i),j=0):this.rowsBuffer.push(i);if(this._h2)reset=!0,this._h2.add(f,g.parentNode.getAttribute("id")||g.parentNode.getAttribute("parent")).buff=this.rowsBuffer[this.rowsBuffer.length-1];
this.rowsAr[f]=g;g=this.render_row(j);this._insertRowAt(g,j?-1:0)}}if(this._refresh_mode[2])for(f in d)d[f]&&this.rowsAr[f]&&this.deleteRow(f);this._refresh_mode=null;if(window.eXcell_tree)eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX;reset&&this._renderSort();if(this._f_rowsBuffer)this._f_rowsBuffer=null,this.filterByAll()},getCustomCombo:function(a,c){var b=this.cells(a,c).cell;if(!b._combo)b._combo=new dhtmlXGridComboObject;return b._combo},setTabOrder:function(a){var c=a.split(this.delim);
this._tabOrder=[];for(var b=this._cCount||a.length,d=0;d<b;d++)c[d]={c:parseInt(c[d]),ind:d};c.sort(function(a,b){return a.c>b.c?1:-1});for(d=0;d<b;d++)this._tabOrder[c[d].ind]=!c[d+1]||typeof c[d].c=="undefined"?(c[0].ind+1)*-1:c[d+1].ind},i18n:{loading:"Loading",decimal_separator:".",group_separator:","},_key_events:{k13_1_0:function(){var a=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[a+1],this.cell._cellIndex,!0)},k13_0_1:function(){var a=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[a-
1],this.cell._cellIndex,!0)},k13_0_0:function(){this.editStop();this.callEvent("onEnter",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},k9_0_0:function(){this.editStop();if(!this.callEvent("onTab",[!0]))return!0;var a=this._getNextCell(null,1);if(a)this.selectCell(a.parentNode,a._cellIndex,this.row!=a.parentNode,!1,!0),this._still_active=!0},k9_0_1:function(){this.editStop();if(!this.callEvent("onTab",[!1]))return!1;var a=this._getNextCell(null,-1);if(a)this.selectCell(a.parentNode,
a._cellIndex,this.row!=a.parentNode,!1,!0),this._still_active=!0},k113_0_0:function(){this._f2kE&&this.editCell()},k32_0_0:function(){var a=this.cells4(this.cell);if(!a.changeState||a.changeState()===!1)return!1},k27_0_0:function(){this.editStop(!0)},k33_0_0:function(){this.pagingOn?this.changePage(this.currentPage-1):this.scrollPage(-1)},k34_0_0:function(){this.pagingOn?this.changePage(this.currentPage+1):this.scrollPage(1)},k37_0_0:function(){if(!this.editor&&this.isTreeGrid())this.collapseKids(this.row);
else return!1},k39_0_0:function(){if(!this.editor&&this.isTreeGrid())this.expandKids(this.row);else return!1},k40_0_0:function(){var a=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftNext();else{if(!this.row.idd)return;var c=Math.max(a._r_select||0,this.getRowIndex(this.row.idd))+1;if(this.rowsBuffer[c])a._r_select=null,this.selectCell(c,this.cell._cellIndex,!0),a.pagingOn&&a.showRow(a.getRowId(c));else{if(!this.callEvent("onLastRow",[]))return!1;this._key_events.k34_0_0.apply(this,
[]);this.pagingOn&&this.rowsCol[c]&&this.selectCell(c,0,!0)}}this._still_active=!0},k38_0_0:function(){var a=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftPrev();else{if(!this.row.idd)return;var c=this.getRowIndex(this.row.idd)+1;if(c!=-1&&(!this.pagingOn||c!=1)){var b=this._nextRow(c-1,-1);this.selectCell(b,this.cell._cellIndex,!0);a.pagingOn&&b&&a.showRow(b.idd)}else this._key_events.k33_0_0.apply(this,[])}this._still_active=!0}},_build_master_row:function(){for(var a=
document.createElement("DIV"),c=["<table><tr>"],b=0;b<this._cCount;b++)c.push("<td></td>");c.push("</tr></table>");a.innerHTML=c.join("");this._master_row=a.firstChild.rows[0]},_prepareRow:function(a){this._master_row||this._build_master_row();for(var c=this._master_row.cloneNode(!0),b=0;b<c.childNodes.length;b++){c.childNodes[b]._cellIndex=b;if(this._enbCid)c.childNodes[b].id="c_"+a+"_"+b;this.dragAndDropOff&&this.dragger.addDraggableItem(c.childNodes[b],this)}c.idd=a;c.grid=this;return c},_process_jsarray_row:function(a,
c){a._attrs={};for(var b=0;b<a.childNodes.length;b++)a.childNodes[b]._attrs={};this._fillRow(a,this._c_order?this._swapColumns(c):c);return a},_get_jsarray_data:function(a,c){return a[c]},_process_json_row:function(a,c){a._attrs={};for(var b=0;b<a.childNodes.length;b++)a.childNodes[b]._attrs={};this._fillRow(a,this._c_order?this._swapColumns(c.data):c.data);return a},_get_json_data:function(a,c){return a.data[c]},_process_csv_row:function(a,c){a._attrs={};for(var b=0;b<a.childNodes.length;b++)a.childNodes[b]._attrs=
{};this._fillRow(a,this._c_order?this._swapColumns(c.split(this.csv.cell)):c.split(this.csv.cell));return a},_get_csv_data:function(a,c){return a.split(this.csv.cell)[c]},_process_store_row:function(a,c){for(var b=[],d=0;d<this.columnIds.length;d++)b[d]=c[this.columnIds[d]];for(var e=0;e<a.childNodes.length;e++)a.childNodes[e]._attrs={};a._attrs=c;this._fillRow(a,this._c_order?this._swapColumns(b):b)},_process_xml_row:function(a,c){var b=this.xmlLoader.doXPath(this.xml.cell,c),d=[];a._attrs=this._xml_attrs(c);
if(this._ud_enabled)for(var e=this.xmlLoader.doXPath("./userdata",c),h=e.length-1;h>=0;h--){for(var g="",f=0;f<e[h].childNodes.length;f++)g+=e[h].childNodes[f].nodeValue;this.setUserData(a.idd,e[h].getAttribute("name"),g)}for(f=0;f<b.length;f++){var i=b[this._c_order?this._c_order[f]:f];if(i){var j=a._childIndexes?a._childIndexes[f]:f,k=i.getAttribute("type");if(a.childNodes[j]){if(k)a.childNodes[j]._cellType=k;a.childNodes[j]._attrs=this._xml_attrs(i)}i.getAttribute("xmlcontent")||(i=i.firstChild?
i.firstChild.data:"");d.push(i)}}for(;f<a.childNodes.length;f++)a.childNodes[f]._attrs={};a.parentNode&&a.parentNode.tagName=="row"&&(a._attrs.parent=a.parentNode.getAttribute("idd"));this._fillRow(a,d);return a},_get_xml_data:function(a,c){for(a=a.firstChild;;){if(!a)return"";a.tagName=="cell"&&c--;if(c<0)break;a=a.nextSibling}return a.firstChild?a.firstChild.data:""},_fillRow:function(a,c){this.editor&&this.editStop();for(var b=0;b<a.childNodes.length;b++)if(b<c.length||this.defVal[b]){var d=a.childNodes[b]._cellIndex,
e=c[d],h=this.cells4(a.childNodes[b]);if(this.defVal[d]&&(e==""||typeof e=="undefined"))e=this.defVal[d];h&&h.setValue(e)}else a.childNodes[b].innerHTML="&nbsp;",a.childNodes[b]._clearCell=!0;return a},_postRowProcessing:function(a,c){if(a._attrs["class"])a._css=a.className=a._attrs["class"];if(a._attrs.locked)a._locked=!0;if(a._attrs.bgColor)a.bgColor=a._attrs.bgColor;for(var b=0,d=0;d<a.childNodes.length;d++){var e=a.childNodes[d],h=e._cellIndex,g=e._attrs.style||a._attrs.style;g&&(e.style.cssText+=
";"+g);if(e._attrs["class"])e.className=e._attrs["class"];if(g=e._attrs.align||this.cellAlign[h])e.align=g;e.vAlign=e._attrs.valign||this.cellVAlign[h];var f=e._attrs.bgColor||this.columnColor[h];if(f)e.bgColor=f;e._attrs.colspan&&!c&&(this.setColspan(a.idd,d+b,e._attrs.colspan),b+=e._attrs.colspan-1);if(this._hrrar&&this._hrrar[h]&&!c)e.style.display="none"}this.callEvent("onRowCreated",[a.idd,a,null])},load:function(a,c,b){this.callEvent("onXLS",[this]);arguments.length==2&&typeof c!="function"&&
(b=c,c=null);b=b||"xml";if(!this.xmlFileUrl)this.xmlFileUrl=a;this._data_type=b;this.xmlLoader.onloadAction=function(a,e,h,g,f){a.callEvent&&(f=a["_process_"+b](f),a._contextCallTimer||a.callEvent("onXLE",[a,0,0,f]),c&&(c(),c=null))};this.xmlLoader.loadXML(a)},loadXMLString:function(a,c){var b=new dtmlXMLLoaderObject(function(){});b.loadXMLString(a);this.parse(b,c,"xml")},loadXML:function(a,c){this.load(a,c,"xml")},parse:function(a,c,b){arguments.length==2&&typeof c!="function"&&(b=c,c=null);this._data_type=
b=b||"xml";a=this["_process_"+b](a);this._contextCallTimer||this.callEvent("onXLE",[this,0,0,a]);c&&c()},xml:{top:"rows",row:"./row",cell:"./cell",s_row:"row",s_cell:"cell",row_attrs:[],cell_attrs:[]},csv:{row:"\n",cell:","},_xml_attrs:function(a){var c={};if(a.attributes.length)for(var b=0;b<a.attributes.length;b++)c[a.attributes[b].name]=a.attributes[b].value;return c},_process_xml:function(a){if(!a.doXPath){var c=new dtmlXMLLoaderObject(function(){});typeof a=="string"?c.loadXMLString(a):(c.xmlDoc=
a.responseXML?a:{},c.xmlDoc.responseXML=a);a=c}if(this._refresh_mode)return this._refreshFromXML(a);this._parsing=!0;var b=a.getXMLTopNode(this.xml.top);if(b.tagName.toLowerCase()==this.xml.top){this._parseHead(b);var d=a.doXPath(this.xml.row,b),e=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0),h=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0),g=!1;h&&(this.rowsBuffer[h-1]||(this.rowsBuffer.length&&(g=!0),this.rowsBuffer[h-1]=null),h<this.rowsBuffer.length&&
(this.rowsBuffer.splice(h,this.rowsBuffer.length-h),g=!0));if(this.isTreeGrid())return this._process_tree_xml(a);for(var f=0;f<d.length;f++)if(!this.rowsBuffer[f+e]){var i=d[f].getAttribute("id")||f+e+1;this.rowsBuffer[f+e]={idd:i,data:d[f],_parser:this._process_xml_row,_locator:this._get_xml_data};this.rowsAr[i]=d[f]}if(g&&this._srnd){var j=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=j}else this.render_dataset();this._parsing=!1;return a.xmlDoc.responseXML?a.xmlDoc.responseXML:
a.xmlDoc}},_process_jsarray:function(a){this._parsing=!0;if(a&&a.xmlDoc)eval("dhtmlx.temp="+a.xmlDoc.responseText+";"),a=dhtmlx.temp;for(var c=0;c<a.length;c++){var b=c+1;this.rowsBuffer.push({idd:b,data:a[c],_parser:this._process_jsarray_row,_locator:this._get_jsarray_data});this.rowsAr[b]=a[c]}this.render_dataset();this._parsing=!1},_process_csv:function(a){this._parsing=!0;if(a.xmlDoc)a=a.xmlDoc.responseText;a=a.replace(/\r/g,"");a=a.split(this.csv.row);if(this._csvHdr){this.clearAll();var c=a.splice(0,
1)[0].split(this.csv.cell);this._csvAID||c.splice(0,1);this.setHeader(c.join(this.delim));this.init()}for(var b=0;b<a.length;b++)if(a[b]||b!=a.length-1){if(this._csvAID){var d=b+1;this.rowsBuffer.push({idd:d,data:a[b],_parser:this._process_csv_row,_locator:this._get_csv_data})}else{var e=a[b].split(this.csv.cell),d=e.splice(0,1)[0];this.rowsBuffer.push({idd:d,data:e,_parser:this._process_jsarray_row,_locator:this._get_jsarray_data})}this.rowsAr[d]=a[b]}this.render_dataset();this._parsing=!1},_process_json:function(a){this._parsing=
!0;if(a&&a.xmlDoc)eval("dhtmlx.temp="+a.xmlDoc.responseText+";"),a=dhtmlx.temp;for(var c=0;c<a.rows.length;c++){var b=a.rows[c].id;this.rowsBuffer.push({idd:b,data:a.rows[c],_parser:this._process_json_row,_locator:this._get_json_data});this.rowsAr[b]=a[c]}this.render_dataset();this._parsing=!1},render_dataset:function(a,c){if(this._srnd){if(this._fillers)return this._update_srnd_view();c=Math.min(this._get_view_size()+(this._srnd_pr||0),this.rowsBuffer.length)}this.pagingOn?(a=Math.max(a||0,(this.currentPage-
1)*this.rowsBufferOutSize),c=Math.min(this.currentPage*this.rowsBufferOutSize,this.rowsBuffer.length)):(a=a||0,c=c||this.rowsBuffer.length);for(var b=a;b<c;b++){var d=this.render_row(b);if(d==-1){if(this.xmlFileUrl&&this.callEvent("onDynXLS",[b,this._dpref?this._dpref:c-b]))this.load(this.xmlFileUrl+getUrlSymbol(this.xmlFileUrl)+"posStart="+b+"&count="+(this._dpref?this._dpref:c-b),this._data_type);c=b;break}if(!d.parentNode||!d.parentNode.tagName)if(this._insertRowAt(d,b),d._attrs.selected||d._attrs.select)this.selectRow(d,
d._attrs.call?!0:!1,!0),d._attrs.selected=d._attrs.select=null;if(this._ads_count&&b-a==this._ads_count){var e=this;this._context_parsing=this._context_parsing||this._parsing;return this._contextCallTimer=window.setTimeout(function(){e._contextCallTimer=null;e.render_dataset(b,c);if(!e._contextCallTimer)e._context_parsing?e.callEvent("onXLE",[]):e._fixAlterCss(),e.callEvent("onDistributedEnd",[]),e._context_parsing=!1},this._ads_time)}}if(this._srnd&&!this._fillers)this._fillers=[this._add_filler(c,
this.rowsBuffer.length-c)];this.setSizes()},render_row:function(a){if(!this.rowsBuffer[a])return-1;if(this.rowsBuffer[a]._parser){var c=this.rowsBuffer[a];if(this.rowsAr[c.idd]&&this.rowsAr[c.idd].tagName=="TR")return this.rowsBuffer[a]=this.rowsAr[c.idd];var b=this._prepareRow(c.idd);this.rowsBuffer[a]=b;this.rowsAr[c.idd]=b;c._parser.call(this,b,c.data);this._postRowProcessing(b);return b}return this.rowsBuffer[a]},_get_cell_value:function(a,c,b){return a._locator?(this._c_order&&(c=this._c_order[c]),
a._locator.call(this,a.data,c)):this.cells3(a,c)[b?b:"getValue"]()},sortRows:function(a,c,b){b=(b||"asc").toLowerCase();c=c||this.fldSort[a];a=a||0;if(this.isTreeGrid())this.sortTreeRows(a,c,b);else{var d={},e=this.cellType[a],h="getValue";e=="link"&&(h="getContent");if(e=="dhxCalendar"||e=="dhxCalendarA")h="getDate";for(var g=0;g<this.rowsBuffer.length;g++)d[this.rowsBuffer[g].idd]=this._get_cell_value(this.rowsBuffer[g],a,h);this._sortRows(a,c,b,d)}this.callEvent("onAfterSorting",[a,c,b])},_sortCore:function(a,
c,b,d,e){var h="sort";if(this._sst)e.stablesort=this.rowsCol.stablesort,h="stablesort";c.length>4&&(c=window[c]);if(c=="cus"){var g=this._customSorts[a];e[h](function(a,c){return g(d[a.idd],d[c.idd],b,a.idd,c.idd)})}else if(typeof c=="function")e[h](function(a,e){return c(d[a.idd],d[e.idd],b,a.idd,e.idd)});else if(c=="str")e[h](function(a,c){return b=="asc"?d[a.idd]>d[c.idd]?1:-1:d[a.idd]<d[c.idd]?1:-1});else if(c=="int")e[h](function(a,c){var e=parseFloat(d[a.idd]),e=isNaN(e)?-99999999999999:e,g=
parseFloat(d[c.idd]),g=isNaN(g)?-99999999999999:g;return b=="asc"?e-g:g-e});else if(c=="date")e[h](function(a,c){var e=Date.parse(d[a.idd])||Date.parse("01/01/1900"),g=Date.parse(d[c.idd])||Date.parse("01/01/1900");return b=="asc"?e-g:g-e})},_sortRows:function(a,c,b,d){this._sortCore(a,c,b,d,this.rowsBuffer);this._reset_view();this.callEvent("onGridReconstructed",[])},_reset_view:function(a){if(this.obj.rows[0]){this.callEvent("onResetView",[]);var c=this.obj.rows[0].parentNode,b=c.removeChild(c.childNodes[0],
!0);if(_isKHTML)for(var d=c.parentNode.childNodes.length-1;d>=0;d--)c.parentNode.childNodes[d].tagName=="TR"&&c.parentNode.removeChild(c.parentNode.childNodes[d],!0);else if(_isIE)for(d=c.childNodes.length-1;d>=0;d--)c.childNodes[d].removeNode(!0);else c.innerHTML="";c.appendChild(b);this.rowsCol=dhtmlxArray();this._sst&&this.enableStableSorting(!0);this._fillers=this.undefined;a||this.render_dataset()}},deleteRow:function(a,c){c||(c=this.getRowById(a));if(c){this.editStop();if(!this._realfake&&this.callEvent("onBeforeRowDeleted",
[a])==!1)return!1;var b=0;if(this.cellType._dhx_find("tree")!=-1&&!this._realfake)b=this._h2.get[a].parent.id,this._removeTrGrRow(c);else{c.parentNode&&c.parentNode.removeChild(c);var d=this.rowsCol._dhx_find(c);d!=-1&&this.rowsCol._dhx_removeAt(d);for(var e=0;e<this.rowsBuffer.length;e++)if(this.rowsBuffer[e]&&this.rowsBuffer[e].idd==a){this.rowsBuffer._dhx_removeAt(e);d=e;break}}this.rowsAr[a]=null;for(e=0;e<this.selectedRows.length;e++)this.selectedRows[e].idd==a&&this.selectedRows._dhx_removeAt(e);
if(this._srnd){for(e=0;e<this._fillers.length;e++){var h=this._fillers[e];h&&(h[0]>=d?h[0]-=1:h[1]>=d&&(h[1]-=1))}this._update_srnd_view()}this.pagingOn&&this.changePage();this._realfake||this.callEvent("onAfterRowDeleted",[a,b]);this.callEvent("onGridReconstructed",[]);this._ahgr&&this.setSizes();return!0}},_addRow:function(a,c,b){if(b==-1||typeof b=="undefined")b=this.rowsBuffer.length;typeof c=="string"&&(c=c.split(this.delim));var d=this._prepareRow(a);d._attrs={};for(var e=0;e<d.childNodes.length;e++)d.childNodes[e]._attrs=
{};this.rowsAr[d.idd]=d;if(this._h2)this._h2.get[d.idd].buff=d;this._fillRow(d,c);this._postRowProcessing(d);if(this._skipInsert)return this._skipInsert=!1,this.rowsAr[d.idd]=d;if(this.pagingOn)return this.rowsBuffer._dhx_insertAt(b,d),this.rowsAr[d.idd]=d;if(this._fillers){this.rowsCol._dhx_insertAt(b,null);this.rowsBuffer._dhx_insertAt(b,d);this._fake&&this._fake.rowsCol._dhx_insertAt(b,null);this.rowsAr[d.idd]=d;for(var h=!1,g=0;g<this._fillers.length;g++){var f=this._fillers[g];if(f&&f[0]<=b&&
f[0]+f[1]>=b)f[1]+=1,f[2].firstChild.style.height=parseInt(f[2].firstChild.style.height)+this._srdh+"px",h=!0,this._fake&&this._fake._fillers[g][1]++;f&&f[0]>b&&(f[0]+=1,this._fake&&this._fake._fillers[g][0]++)}h||this._fillers.push(this._add_filler(b,1,b==0?{parentNode:this.obj.rows[0].parentNode,nextSibling:this.rowsCol[1]}:this.rowsCol[b-1],!0));return d}this.rowsBuffer._dhx_insertAt(b,d);return this._insertRowAt(d,b)},addRow:function(a,c,b){var d=this._addRow(a,c,b);this.dragContext||this.callEvent("onRowAdded",
[a]);this.pagingOn&&this.changePage(this.currentPage);this._srnd&&this._update_srnd_view();d._added=!0;this._ahgr&&this.setSizes();this.callEvent("onGridReconstructed",[]);return d},_insertRowAt:function(a,c,b){this.rowsAr[a.idd]=a;if(this._skipInsert)return this._skipInsert=!1,a;if(c<0||!c&&parseInt(c)!==0)c=this.rowsCol.length;else if(c>this.rowsCol.length)c=this.rowsCol.length;this._cssEven&&(a.className+=(this._cssSP?this.getLevel(a.idd):c)%2==1?" "+this._cssUnEven+(this._cssSU?" "+this._cssUnEven+
"_"+this.getLevel(a.idd):""):" "+this._cssEven+(this._cssSU?" "+this._cssEven+"_"+this.getLevel(a.idd):""));b||(c==this.obj.rows.length-1||!this.rowsCol[c]?_isKHTML?this.obj.appendChild(a):this.obj.firstChild.appendChild(a):this.rowsCol[c].parentNode.insertBefore(a,this.rowsCol[c]));this.rowsCol._dhx_insertAt(c,a);this.callEvent("onRowInserted",[a,c]);return a},getRowById:function(a){var c=this.rowsAr[a];if(c){if(c.tagName!="TR"){for(var b=0;b<this.rowsBuffer.length;b++)if(this.rowsBuffer[b]&&this.rowsBuffer[b].idd==
a)return this.render_row(b);if(this._h2)return this.render_row(null,c.idd)}return c}return null},cellById:function(a,c){return this.cells(a,c)},cells:function(a,c){if(arguments.length==0)return this.cells4(this.cell);else var b=this.getRowById(a);var d=b._childIndexes?b.childNodes[b._childIndexes[c]]:b.childNodes[c];return this.cells4(d)},cellByIndex:function(a,c){return this.cells2(a,c)},cells2:function(a,c){var b=this.render_row(a),d=b._childIndexes?b.childNodes[b._childIndexes[c]]:b.childNodes[c];
return this.cells4(d)},cells3:function(a,c){var b=a._childIndexes?a.childNodes[a._childIndexes[c]]:a.childNodes[c];return this.cells4(b)},cells4:function(a){var c=window["eXcell_"+(a._cellType||this.cellType[a._cellIndex])];if(c)return new c(a)},cells5:function(a,c){c=c||a._cellType||this.cellType[a._cellIndex];if(!this._ecache[c]){var b=window["eXcell_"+c]?window["eXcell_"+c]:eXcell_ro;this._ecache[c]=new b(a)}this._ecache[c].cell=a;return this._ecache[c]},dma:function(a){if(!this._ecache)this._ecache=
{};if(a&&!this._dma)this._dma=this.cells4,this.cells4=this.cells5;else if(!a&&this._dma)this.cells4=this._dma,this._dma=null},getRowsNum:function(){return this.rowsBuffer.length},enableEditTabOnly:function(a){this.smartTabOrder=arguments.length>0?convertStringToBoolean(a):!0},setExternalTabOrder:function(a,c){var b=this;this.tabStart=typeof a=="object"?a:document.getElementById(a);this.tabStart.onkeydown=function(a){var c=a||window.event;if(c.keyCode==9)return c.cancelBubble=!0,b.selectCell(0,0,0,
0,1),b.smartTabOrder&&b.cells2(0,0).isDisabled()&&b._key_events.k9_0_0.call(b),this.blur(),!1};if(_isOpera)this.tabStart.onkeypress=this.tabStart.onkeydown;this.tabEnd=typeof c=="object"?c:document.getElementById(c);this.tabEnd.onkeydown=this.tabEnd.onkeypress=function(a){var c=a||window.event;if(c.keyCode==9&&c.shiftKey)return c.cancelBubble=!0,b.selectCell(b.getRowsNum()-1,b.getColumnCount()-1,0,0,1),b.smartTabOrder&&b.cells2(b.getRowsNum()-1,b.getColumnCount()-1).isDisabled()&&b._key_events.k9_0_1.call(b),
this.blur(),!1};if(_isOpera)this.tabEnd.onkeypress=this.tabEnd.onkeydown},uid:function(){if(!this._ui_seed)this._ui_seed=(new Date).valueOf();return this._ui_seed++},clearAndLoad:function(){var a=this._pgn_skin;this._pgn_skin=null;this.clearAll();this._pgn_skin=a;this.load.apply(this,arguments)},getStateOfView:function(){if(this.pagingOn){var a=(this.currentPage-1)*this.rowsBufferOutSize;return[this.currentPage,a,Math.min(a+this.rowsBufferOutSize,this.rowsBuffer.length),this.rowsBuffer.length]}return[Math.floor(this.objBox.scrollTop/
this._srdh),Math.ceil(parseInt(this.objBox.offsetHeight)/this._srdh),this.rowsBuffer.length]}};
(function(){function a(a,b){this[a]=b}function c(a,b){this[a].call(this,b)}function b(a,b){this[a].call(this,b.join(this.delim))}function d(a,b){for(var c=0;c<b.length;c++)if(typeof b[c]=="object"){var d=this.getCombo(c),e;for(e in b[c])d.put(e,b[c][e])}}function e(a,b){function c(a,b,d){e[b]||(e[b]=[]);if(typeof d=="object")d.toString=function(){return this.text};e[b][a]=d}for(var d=1,e=[],h=0;h<b.length;h++)if(typeof b[h]=="object"&&b[h].length)for(var m=0;m<b[h].length;m++)c(h,m,b[h][m]);else c(h,
0,b[h]);for(h=0;h<e.length;h++)for(m=0;m<e[0].length;m++){var o=e[h][m];e[h][m]=(o||"").toString()||"&nbsp;";if(o&&o.colspan)for(var n=1;n<o.colspan;n++)c(m+n,h,"#cspan");if(o&&o.rowspan)for(n=1;n<o.rowspan;n++)c(m,h+n,"#rspan")}this.setHeader(e[0]);for(h=1;h<e.length;h++)this.attachHeader(e[h])}var h=[{name:"label",def:"&nbsp;",operation:"setHeader",type:e},{name:"id",def:"",operation:"columnIds",type:a},{name:"width",def:"*",operation:"setInitWidths",type:b},{name:"align",def:"left",operation:"cellAlign",
type:a},{name:"valign",def:"middle",operation:"cellVAlign",type:a},{name:"sort",def:"na",operation:"fldSort",type:a},{name:"type",def:"ro",operation:"setColTypes",type:b},{name:"options",def:"",operation:"",type:d}];dhtmlx.extend_api("dhtmlXGridObject",{_init:function(a){return[a.parent]},image_path:"setImagePath",columns:"columns",rows:"rows",headers:"headers",skin:"setSkin",smart_rendering:"enableSmartRendering",css:"enableAlterCss",auto_height:"enableAutoHeight",save_hidden:"enableAutoHiddenColumnsSaving",
save_cookie:"enableAutoSaving",save_size:"enableAutoSizeSaving",auto_width:"enableAutoWidth",block_selection:"enableBlockSelection",csv_id:"enableCSVAutoID",csv_header:"enableCSVHeader",cell_ids:"enableCellIds",colspan:"enableColSpan",column_move:"enableColumnMove",context_menu:"enableContextMenu",distributed:"enableDistributedParsing",drag:"enableDragAndDrop",drag_order:"enableDragOrder",tabulation:"enableEditTabOnly",header_images:"enableHeaderImages",header_menu:"enableHeaderMenu",keymap:"enableKeyboardSupport",
mouse_navigation:"enableLightMouseNavigation",markers:"enableMarkedCells",math_editing:"enableMathEditing",math_serialization:"enableMathSerialization",drag_copy:"enableMercyDrag",multiline:"enableMultiline",multiselect:"enableMultiselect",save_column_order:"enableOrderSaving",hover:"enableRowsHover",rowspan:"enableRowspan",smart:"enableSmartRendering",save_sorting:"enableSortingSaving",stable_sorting:"enableStableSorting",undo:"enableUndoRedo",csv_cell:"setCSVDelimiter",date_format:"setDateFormat",
drag_behavior:"setDragBehavior",editable:"setEditable",without_header:"setNoHeader",submit_changed:"submitOnlyChanged",submit_serialization:"submitSerialization",submit_selected:"submitOnlySelected",submit_id:"submitOnlyRowID",xml:"load"},{columns:function(a){for(var b=0;b<h.length;b++){for(var d=[],e=0;e<a.length;e++)d[e]=a[e][h[b].name]||h[b].def;var k=h[b].type||c;k.call(this,h[b].operation,d,a)}this.init()},rows:function(){},headers:function(a){for(var b=0;b<a.length;b++)this.attachHeader(a[b])}})})();
dhtmlXGridObject.prototype._dp_init=function(a){a.attachEvent("insertCallback",function(a,b){this.obj._h2?this.obj.addRow(b,d,null,parent):this.obj.addRow(b,[],0);var d=this.obj.getRowById(b);d&&(this.obj._process_xml_row(d,a.firstChild),this.obj._postRowProcessing(d))});a.attachEvent("updateCallback",function(a,b){var d=this.obj.getRowById(b);d&&(this.obj._process_xml_row(d,a.firstChild),this.obj._postRowProcessing(d))});a.attachEvent("deleteCallback",function(a,b){this.obj.setUserData(b,this.action_param,
"true_deleted");this.obj.deleteRow(b)});a._methods=["setRowTextStyle","setCellTextStyle","changeRowId","deleteRow"];this.attachEvent("onEditCell",function(c,b,d){if(a._columns&&!a._columns[d])return!0;var e=this.cells(b,d);c==1?e.isCheckbox()&&a.setUpdated(b,!0):c==2&&e.wasChanged()&&a.setUpdated(b,!0);return!0});this.attachEvent("onRowPaste",function(c){a.setUpdated(c,!0)});this.attachEvent("onRowIdChange",function(c,b){var d=a.findRow(c);d<a.updatedRows.length&&(a.updatedRows[d]=b)});this.attachEvent("onSelectStateChanged",
function(){a.updateMode=="row"&&a.sendData();return!0});this.attachEvent("onEnter",function(){a.updateMode=="row"&&a.sendData();return!0});this.attachEvent("onBeforeRowDeleted",function(c){if(!this.rowsAr[c])return!0;if(this.dragContext&&a.dnd)return window.setTimeout(function(){a.setUpdated(c,!0)},1),!0;var b=a.getState(c);this._h2&&this._h2.forEachChild(c,function(b){a.setUpdated(b.id,!1);a.markRow(b.id,!0,"deleted")},this);if(b=="inserted")return a.set_invalid(c,!1),a.setUpdated(c,!1),!0;if(b==
"deleted")return!1;if(b=="true_deleted")return a.setUpdated(c,!1),!0;a.setUpdated(c,!0,"deleted");return!1});this.attachEvent("onBindUpdate",function(c){a.setUpdated(c,!0)});this.attachEvent("onRowAdded",function(c){if(this.dragContext&&a.dnd)return!0;a.setUpdated(c,!0,"inserted");return!0});a._getRowData=function(a){var b=[];b.gr_id=a;this.obj.isTreeGrid()&&(b.gr_pid=this.obj.getParentId(a));for(var d=this.obj.getRowById(a),e=0;e<this.obj._cCount;e++){var h=this.obj._c_order?this.obj._c_order[e]:
e,g=this.obj.cells(d.idd,e);if(!this._changed||g.wasChanged())this._endnm?b[this.obj.getColumnId(e)]=g.getValue():b["c"+h]=g.getValue()}var f=this.obj.UserData[a];if(f)for(var i=0;i<f.keys.length;i++)f.keys[i].indexOf("__")!=0&&(b[f.keys[i]]=f.values[i]);if(f=this.obj.UserData.gridglobaluserdata)for(i=0;i<f.keys.length;i++)b[f.keys[i]]=f.values[i];return b};a._clearUpdateFlag=function(a){var b=this.obj.getRowById(a);if(b)for(var d=0;d<this.obj._cCount;d++)this.obj.cells(a,d).cell.wasChanged=!1};a.checkBeforeUpdate=
function(a){for(var b=!0,d=[],e=0;e<this.obj._cCount;e++)if(this.mandatoryFields[e]){var h=this.mandatoryFields[e].call(this.obj,this.obj.cells(a,e).getValue(),a,e);typeof h=="string"?(this.messages.push(h),b=!1):(b&=h,d[e]=!h)}b||(this.set_invalid(a,"invalid",d),this.setUpdated(a,!1));return b}};
function dhtmlXGridCellObject(a){this.destructor=function(){return this.base=this.grid=this.cell=this.cell.obj=null};this.cell=a;this.getValue=function(){return this.cell.firstChild&&this.cell.firstChild.tagName=="TEXTAREA"?this.cell.firstChild.value:this.cell.innerHTML._dhx_trim()};this.getMathValue=function(){return this.cell.original?this.cell.original:this.getValue()};this.getFont=function(){arOut=Array(3);if(this.cell.style.fontFamily)arOut[0]=this.cell.style.fontFamily;if(this.cell.style.fontWeight==
"bold"||this.cell.parentNode.style.fontWeight=="bold")arOut[1]="bold";if(this.cell.style.fontStyle=="italic"||this.cell.parentNode.style.fontWeight=="italic")arOut[1]+="italic";arOut[2]=this.cell.style.fontSize?this.cell.style.fontSize:"";return arOut.join("-")};this.getTextColor=function(){return this.cell.style.color?this.cell.style.color:"#000000"};this.getBgColor=function(){return this.cell.bgColor?this.cell.bgColor:"#FFFFFF"};this.getHorAlign=function(){return this.cell.style.textAlign?this.cell.style.textAlign:
this.cell.style.textAlign?this.cell.style.textAlign:"left"};this.getWidth=function(){return this.cell.scrollWidth};this.setFont=function(a){fntAr=a.split("-");this.cell.style.fontFamily=fntAr[0];this.cell.style.fontSize=fntAr[fntAr.length-1];if(fntAr.length==3){if(/bold/.test(fntAr[1]))this.cell.style.fontWeight="bold";if(/italic/.test(fntAr[1]))this.cell.style.fontStyle="italic";if(/underline/.test(fntAr[1]))this.cell.style.textDecoration="underline"}};this.setTextColor=function(a){this.cell.style.color=
a};this.setBgColor=function(a){a==""&&(a=null);this.cell.bgColor=a};this.setHorAlign=function(a){this.cell.style.textAlign=a.length==1?a=="c"?"center":a=="l"?"left":"right":a};this.wasChanged=function(){return this.cell.wasChanged?!0:!1};this.isCheckbox=function(){var a=this.cell.firstChild;return a&&a.tagName=="INPUT"?(type=a.type,type=="radio"||type=="checkbox"?!0:!1):!1};this.isChecked=function(){if(this.isCheckbox())return this.cell.firstChild.checked};this.isDisabled=function(){return this.cell._disabled};
this.setChecked=function(a){if(this.isCheckbox())a!="true"&&a!=1&&(a=!1),this.cell.firstChild.checked=a};this.setDisabled=function(a){a!="true"&&a!=1&&(a=!1);if(this.isCheckbox())this.cell.firstChild.disabled=a,this.disabledF&&this.disabledF(a);this.cell._disabled=a}}
dhtmlXGridCellObject.prototype={getAttribute:function(a){return this.cell._attrs[a]},setAttribute:function(a,c){this.cell._attrs[a]=c},getInput:function(){if(this.obj&&(this.obj.tagName=="INPUT"||this.obj.tagName=="TEXTAREA"))return this.obj;var a=(this.obj||this.cell).getElementsByTagName("TEXTAREA");a.length||(a=(this.obj||this.cell).getElementsByTagName("INPUT"));return a[0]}};
dhtmlXGridCellObject.prototype.setValue=function(a){typeof a!="number"&&(!a||a.toString()._dhx_trim()=="")?(a="&nbsp;",this.cell._clearCell=!0):this.cell._clearCell=!1;this.setCValue(a)};dhtmlXGridCellObject.prototype.getTitle=function(){return _isIE?this.cell.innerText:this.cell.textContent};dhtmlXGridCellObject.prototype.setCValue=function(a,c){this.cell.innerHTML=a;this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,arguments.length>1?c:a])};
dhtmlXGridCellObject.prototype.setCTxtValue=function(a){this.cell.innerHTML="";this.cell.appendChild(document.createTextNode(a));this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,a])};dhtmlXGridCellObject.prototype.setLabel=function(a){this.cell.innerHTML=a};dhtmlXGridCellObject.prototype.getMath=function(){return this._val?this.val:this.getValue()};
function eXcell(){this.val=this.obj=null;this.changeState=function(){return!1};this.edit=function(){this.val=this.getValue()};this.detach=function(){return!1};this.getPosition=function(a){for(var c=a,b=0,d=0;c.tagName!="BODY";)b+=c.offsetLeft,d+=c.offsetTop,c=c.offsetParent;return[b,d]}}eXcell.prototype=new dhtmlXGridCellObject;
function eXcell_ed(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.edit=function(){this.cell.atag=!this.grid.multiLine&&(_isKHTML||_isMacOS||_isFF)?"INPUT":"TEXTAREA";this.val=this.getValue();this.obj=document.createElement(this.cell.atag);this.obj.setAttribute("autocomplete","off");this.obj.style.height=this.cell.offsetHeight-(_isIE?4:4)+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(a){(a||event).cancelBubble=
!0};this.obj.onmousedown=function(a){(a||event).cancelBubble=!0};this.obj.value=this.val;this.cell.innerHTML="";this.cell.appendChild(this.obj);if(_isFF&&!window._KHTMLrv&&(this.obj.style.overflow="visible",this.grid.multiLine&&this.obj.offsetHeight>=18&&this.obj.offsetHeight<40))this.obj.style.height="36px",this.obj.style.overflow="scroll";this.obj.onselectstart=function(a){a||(a=event);return a.cancelBubble=!0};_isIE&&this.obj.focus();this.obj.focus()};this.getValue=function(){return this.cell.firstChild&&
this.cell.atag&&this.cell.firstChild.tagName==this.cell.atag?this.cell.firstChild.value:this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()};this.detach=function(){this.setValue(this.obj.value);return this.val!=this.getValue()}}eXcell_ed.prototype=new eXcell;
function eXcell_edtxt(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.getValue=function(){return this.cell.firstChild&&this.cell.atag&&this.cell.firstChild.tagName==this.cell.atag?this.cell.firstChild.value:this.cell._clearCell?"":_isIE?this.cell.innerText:this.cell.textContent};this.setValue=function(a){!a||a.toString()._dhx_trim()==""?(a=" ",this.cell._clearCell=!0):this.cell._clearCell=!1;this.setCTxtValue(a)}}eXcell_edtxt.prototype=new eXcell_ed;
function eXcell_edn(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.getValue=function(){return this.cell.firstChild&&this.cell.firstChild.tagName=="TEXTAREA"?this.cell.firstChild.value:this.cell._clearCell?"":this.cell._orig_value||this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)};this.detach=function(){var a=this.obj.value;this.setValue(a);return this.val!=this.getValue()}}eXcell_edn.prototype=new eXcell_ed;
eXcell_edn.prototype.setValue=function(a){if(!a||a.toString()._dhx_trim()=="")return this.cell._clearCell=!0,this.setCValue("&nbsp;",0);else this.cell._clearCell=!1,this.cell._orig_value=a;this.setCValue(this.grid._aplNF(a,this.cell._cellIndex),a)};
function eXcell_ch(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.disabledF=function(a){this.cell.innerHTML=a==!0||a==1?this.cell.innerHTML.replace("item_chk0.","item_chk0_dis.").replace("item_chk1.","item_chk1_dis."):this.cell.innerHTML.replace("item_chk0_dis.","item_chk0.").replace("item_chk1_dis.","item_chk1.")};this.changeState=function(a){a===!0&&!this.grid.isActive&&(window.globalActiveDHTMLGridObject!=null&&window.globalActiveDHTMLGridObject!=this.grid&&window.globalActiveDHTMLGridObject.isActive&&
window.globalActiveDHTMLGridObject.setActive(!1),this.grid.setActive(!0));if(this.grid.isEditable&&!this.cell.parentNode._locked&&!this.isDisabled())this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])?(this.val=this.getValue(),this.val=="1"?this.setValue("0"):this.setValue("1"),this.cell.wasChanged=!0,this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!=
"1"]),this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!="1"])):this.editor=null};this.getValue=function(){return this.cell.chstate?this.cell.chstate.toString():"0"};this.isCheckbox=function(){return!0};this.isChecked=function(){return this.getValue()=="1"?!0:!1};this.setChecked=function(a){this.setValue(a.toString())};this.detach=function(){return this.val!=this.getValue()};this.edit=null}eXcell_ch.prototype=new eXcell;
eXcell_ch.prototype.setValue=function(a){this.cell.style.verticalAlign="middle";if(a&&(a=a.toString()._dhx_trim(),a=="false"||a=="0"))a="";a?(a="1",this.cell.chstate="1"):(a="0",this.cell.chstate="0");var c=this;this.setCValue("<img src='"+this.grid.imgURL+"item_chk"+a+".gif' onclick='new eXcell_ch(this.parentNode).changeState(true); (arguments[0]||event).cancelBubble=true; '>",this.cell.chstate)};
function eXcell_ra(a){this.base=eXcell_ch;this.base(a);this.grid=a.parentNode.grid;this.disabledF=function(a){this.cell.innerHTML=a==!0||a==1?this.cell.innerHTML.replace("radio_chk0.","radio_chk0_dis.").replace("radio_chk1.","radio_chk1_dis."):this.cell.innerHTML.replace("radio_chk0_dis.","radio_chk0.").replace("radio_chk1_dis.","radio_chk1.")};this.changeState=function(a){if(!(a===!1&&this.getValue()==1)&&this.grid.isEditable&&!this.cell.parentNode._locked)this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,
this.cell._cellIndex])!=!1?(this.val=this.getValue(),this.val=="1"?this.setValue("0"):this.setValue("1"),this.cell.wasChanged=!0,this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!="1"]),this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!="1"])):this.editor=null};this.edit=null}eXcell_ra.prototype=new eXcell_ch;
eXcell_ra.prototype.setValue=function(a){this.cell.style.verticalAlign="middle";if(a&&(a=a.toString()._dhx_trim(),a=="false"||a=="0"))a="";if(a){if(!this.grid._RaSeCol)this.grid._RaSeCol=[];if(this.grid._RaSeCol[this.cell._cellIndex]){var c=this.grid.cells4(this.grid._RaSeCol[this.cell._cellIndex]);c.setValue("0");this.grid.rowsAr[c.cell.parentNode.idd]&&this.grid.callEvent("onEditCell",[1,c.cell.parentNode.idd,c.cell._cellIndex])}this.grid._RaSeCol[this.cell._cellIndex]=this.cell;a="1";this.cell.chstate=
"1"}else a="0",this.cell.chstate="0";this.setCValue("<img src='"+this.grid.imgURL+"radio_chk"+a+".gif' onclick='new eXcell_ra(this.parentNode).changeState(false);'>",this.cell.chstate)};
function eXcell_txt(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.edit=function(){this.val=this.getValue();this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_textarea";this.obj.onclick=function(a){(a||event).cancelBubble=!0};var a=this.grid.getPosition(this.cell);this.obj.value=this.val;this.obj.style.display="";this.obj.style.textAlign=this.cell.style.textAlign;if(_isFF){var b=document.createElement("DIV");b.appendChild(this.obj);b.style.overflow="auto";b.className=
"dhx_textarea";this.obj.style.margin="0px 0px 0px 0px";this.obj.style.border="0px";this.obj=b}document.body.appendChild(this.obj);if(_isOpera)this.obj.onkeypress=function(a){if(a.keyCode==9)return!1};this.obj.onkeydown=function(a){var b=a||event;if(b.keyCode==9)return globalActiveDHTMLGridObject.entBox.focus(),globalActiveDHTMLGridObject.doKey({keyCode:b.keyCode,shiftKey:b.shiftKey,srcElement:"0"}),!1};this.obj.style.left=a[0]+"px";this.obj.style.top=a[1]+this.cell.offsetHeight+"px";var d=this.cell.offsetWidth<
200?200:this.cell.offsetWidth;this.obj.style.width=d+(_isFF?18:16)+"px";if(_isFF)this.obj.firstChild.style.width=parseInt(this.obj.style.width)+"px",this.obj.firstChild.style.height=this.obj.offsetHeight-3+"px";if(_isIE)this.obj.select(),this.obj.value=this.obj.value;_isFF?this.obj.firstChild.focus():this.obj.focus()};this.detach=function(){var a="",a=_isFF?this.obj.firstChild.value:this.obj.value;this.cell._clearCell=a==""?!0:!1;this.setValue(a);document.body.removeChild(this.obj);this.obj=null;
return this.val!=this.getValue()};this.getValue=function(){return this.obj?_isFF?this.obj.firstChild.value:this.obj.value:this.cell._clearCell?"":this.grid.multiLine?this.cell.innerHTML.replace(/<br[^>]*>/gi,"\n")._dhx_trim():this.cell._brval||this.cell.innerHTML}}eXcell_txt.prototype=new eXcell;
function eXcell_txttxt(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.getValue=function(){return this.cell.firstChild&&this.cell.firstChild.tagName=="TEXTAREA"?this.cell.firstChild.value:this.cell._clearCell?"":!this.grid.multiLine&&this.cell._brval?this.cell._brval:_isIE?this.cell.innerText:this.cell.textContent};this.setValue=function(a){this.cell._brval=a;!a||a.toString()._dhx_trim()==""?(a=" ",this.cell._clearCell=!0):this.cell._clearCell=!1;this.setCTxtValue(a)}}
eXcell_txttxt.prototype=new eXcell_txt;eXcell_txt.prototype.setValue=function(a){!a||a.toString()._dhx_trim()==""?(a="&nbsp;",this.cell._clearCell=!0):this.cell._clearCell=!1;this.cell._brval=a;this.grid.multiLine?this.setCValue(a.replace(/\n/g,"<br/>"),a):this.setCValue(a,a)};
function eXcell_co(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid,this.combo=this.cell._combo||this.grid.getCombo(this.cell._cellIndex),this.editable=!0;this.shiftNext=function(){var a=this.list.options[this.list.selectedIndex+1];if(a)a.selected=!0;this.obj.value=this.list.options[this.list.selectedIndex].text;return!0};this.shiftPrev=function(){if(this.list.selectedIndex!=0){var a=this.list.options[this.list.selectedIndex-1];if(a)a.selected=!0;this.obj.value=this.list.options[this.list.selectedIndex].text}return!0};
this.edit=function(){this.val=this.getValue();this.text=this.getText()._dhx_trim();var a=this.grid.getPosition(this.cell);this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_combo_edit";this.obj.style.height=this.cell.offsetHeight-4+"px";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(a){(a||event).cancelBubble=!0};this.obj.onmousedown=function(a){(a||event).cancelBubble=!0};this.obj.value=this.text;this.obj.onselectstart=function(a){a||
(a=event);return a.cancelBubble=!0};var b=this;this.obj.onkeyup=function(a){var c=(a||event).keyCode;if(!(c==38||c==40||c==9))for(var d=this.readonly?String.fromCharCode(c):this.value,e=b.list.options,f=0;f<e.length;f++)if(e[f].text.indexOf(d)==0)return e[f].selected=!0};this.list=document.createElement("SELECT");this.list.className="dhx_combo_select";this.list.style.width=this.cell.offsetWidth+"px";this.list.style.left=a[0]+"px";this.list.style.top=a[1]+this.cell.offsetHeight+"px";this.list.onclick=
function(a){var c=a||window.event,d=c.target||c.srcElement;if(d.tagName=="OPTION")d=d.parentNode;b.editable=!1;b.grid.editStop();c.cancelBubble=!0};for(var d=this.combo.getKeys(),e=!1,h=0,g=0;g<d.length;g++){var f=this.combo.get(d[g]);this.list.options[this.list.options.length]=new Option(f,d[g]);d[g]==this.val&&(h=this.list.options.length-1,e=!0)}e==!1&&(this.list.options[this.list.options.length]=new Option(this.text,this.val===null?"":this.val),h=this.list.options.length-1);document.body.appendChild(this.list);
this.list.size="6";this.cstate=1;this.editable?this.cell.innerHTML="":(this.obj.style.width="1px",this.obj.style.height="1px");this.cell.appendChild(this.obj);this.list.options[h].selected=!0;if(!_isFF||this.editable)this.obj.focus(),this.obj.focus();if(!this.editable)this.obj.style.visibility="hidden",this.list.focus(),this.list.onkeydown=function(a){a=a||window.event;b.grid.setActive(!0);if(a.keyCode<30)return b.grid.doKey({target:b.cell,keyCode:a.keyCode,shiftKey:a.shiftKey,ctrlKey:a.ctrlKey})}};
this.getValue=function(){return this.cell.combo_value==window.undefined?"":this.cell.combo_value};this.detach=function(){if(this.val!=this.getValue())this.cell.wasChanged=!0;if(this.list.parentNode!=null)if(this.editable){var a=this.list.options[this.list.selectedIndex];if(a&&a.text==this.obj.value)this.setValue(this.list.value);else{var b=this.cell._combo||this.grid.getCombo(this.cell._cellIndex),d=b.values._dhx_find(this.obj.value);d!=-1?this.setValue(b.keys[d]):this.setCValue(this.cell.combo_value=
this.obj.value)}}else this.setValue(this.list.value);this.list.parentNode&&this.list.parentNode.removeChild(this.list);this.obj.parentNode&&this.obj.parentNode.removeChild(this.obj);return this.val!=this.getValue()}}eXcell_co.prototype=new eXcell;eXcell_co.prototype.getText=function(){return this.cell.innerHTML};
eXcell_co.prototype.setValue=function(a){if(typeof a=="object"){var c=this.grid.xmlLoader.doXPath("./option",a);if(c.length)this.cell._combo=new dhtmlXGridComboObject;for(var b=0;b<c.length;b++)this.cell._combo.put(c[b].getAttribute("value"),c[b].firstChild?c[b].firstChild.data:"");a=a.firstChild.data}if((a||"").toString()._dhx_trim()=="")a=null;this.cell.combo_value=a;if(a!==null){var d=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(a);this.setCValue(d===null?a:d,a)}else this.setCValue("&nbsp;",
a)};function eXcell_coro(a){this.base=eXcell_co;this.base(a);this.editable=!1}eXcell_coro.prototype=new eXcell_co;function eXcell_cotxt(a){this.base=eXcell_co;this.base(a)}eXcell_cotxt.prototype=new eXcell_co;eXcell_cotxt.prototype.getText=function(){return _isIE?this.cell.innerText:this.cell.textContent};
eXcell_cotxt.prototype.setValue=function(a){if(typeof a=="object"){var c=this.grid.xmlLoader.doXPath("./option",a);if(c.length)this.cell._combo=new dhtmlXGridComboObject;for(var b=0;b<c.length;b++)this.cell._combo.put(c[b].getAttribute("value"),c[b].firstChild?c[b].firstChild.data:"");a=a.firstChild.data}if((a||"").toString()._dhx_trim()=="")a=null;a!==null?this.setCTxtValue((this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(a)||a,a):this.setCTxtValue(" ",a);this.cell.combo_value=a};
function eXcell_corotxt(a){this.base=eXcell_co;this.base(a);this.editable=!1}eXcell_corotxt.prototype=new eXcell_cotxt;
function eXcell_cp(a){try{this.cell=a,this.grid=this.cell.parentNode.grid}catch(c){}this.edit=function(){this.val=this.getValue();this.obj=document.createElement("SPAN");this.obj.style.border="1px solid black";this.obj.style.position="absolute";var a=this.grid.getPosition(this.cell);this.colorPanel(4,this.obj);document.body.appendChild(this.obj);this.obj.style.left=a[0]+"px";this.obj.style.zIndex=1;this.obj.style.top=a[1]+this.cell.offsetHeight+"px"};this.toolDNum=function(a){a.length==1&&(a="0"+
a);return a};this.colorPanel=function(a,c){var e=document.createElement("TABLE");c.appendChild(e);e.cellSpacing=0;e.editor_obj=this;e.style.cursor="default";e.onclick=function(a){var b=a||window.event,c=b.target||b.srcElement,d=c.parentNode.parentNode.parentNode.editor_obj;d.setValue(c._bg);d.grid.editStop()};for(var h=256/a,g=0;g<=256/h;g++)for(var f=e.insertRow(g),i=0;i<=256/h;i++)for(var j=0;j<=256/h;j++){R=new Number(h*g)-(g==0?0:1);G=new Number(h*i)-(i==0?0:1);B=new Number(h*j)-(j==0?0:1);var k=
this.toolDNum(R.toString(16))+""+this.toolDNum(G.toString(16))+""+this.toolDNum(B.toString(16)),l=f.insertCell(i);l.width="10px";l.innerHTML="&nbsp;";l.title=k.toUpperCase();l.style.backgroundColor="#"+k;l._bg="#"+k;if(this.val!=null&&"#"+k.toUpperCase()==this.val.toUpperCase())l.style.border="2px solid white"}};this.getValue=function(){return this.cell.firstChild._bg||""};this.getRed=function(){return Number(parseInt(this.getValue().substr(1,2),16))};this.getGreen=function(){return Number(parseInt(this.getValue().substr(3,
2),16))};this.getBlue=function(){return Number(parseInt(this.getValue().substr(5,2),16))};this.detach=function(){this.obj.offsetParent!=null&&document.body.removeChild(this.obj);return this.val!=this.getValue()}}eXcell_cp.prototype=new eXcell;eXcell_cp.prototype.setValue=function(a){this.setCValue("<div style='width:100%;height:"+(this.grid.multiLine?this.cell.offsetHeight-2:16)+";background-color:"+(a||"")+";border:0px;'>&nbsp;</div>",a);this.cell.firstChild._bg=a};
function eXcell_img(a){try{this.cell=a,this.grid=this.cell.parentNode.grid}catch(c){}this.getValue=function(){if(this.cell.firstChild.tagName=="IMG")return this.cell.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"");else if(this.cell.firstChild.tagName=="A"){var a=this.cell.firstChild.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"");a+="^"+this.cell.lnk;this.cell.trg&&(a+="^"+this.cell.trg);return a}};this.isDisabled=function(){return!0}}eXcell_img.prototype=new eXcell;
eXcell_img.prototype.getTitle=function(){return this.cell._brval};eXcell_img.prototype.setValue=function(a){var c=a;if(a.indexOf("^")!=-1){var b=a.split("^"),a=b[0],c=this.cell._attrs.title||b[1];if(b.length>2&&(this.cell.lnk=b[2],b[3]))this.cell.trg=b[3];this.cell.titFl="1"}this.setCValue("<img src='"+this.grid.iconURL+(a||"")._dhx_trim()+"' border='0'>",a);if(this.cell.lnk)this.cell.innerHTML="<a href='"+this.cell.lnk+"' target='"+this.cell.trg+"'>"+this.cell.innerHTML+"</a>";this.cell._brval=c};
function eXcell_price(a){this.base=eXcell_ed;this.base(a);this.getValue=function(){return this.cell.childNodes.length>1?this.cell.childNodes[1].innerHTML.toString()._dhx_trim():"0"}}eXcell_price.prototype=new eXcell_ed;eXcell_price.prototype.setValue=function(a){isNaN(parseFloat(a))&&(a=this.val||0);var c="green";a<0&&(c="red");this.setCValue("<span>$</span><span style='padding-right:2px;color:"+c+";'>"+a+"</span>",a)};
function eXcell_dyn(a){this.base=eXcell_ed;this.base(a);this.getValue=function(){return this.cell.firstChild.childNodes[1].innerHTML.toString()._dhx_trim()}}eXcell_dyn.prototype=new eXcell_ed;
eXcell_dyn.prototype.setValue=function(a){if(!a||isNaN(Number(a)))a!==""&&(a=0);if(a>0)var c="green",b="dyn_up.gif";else a==0?(c="black",b="dyn_.gif"):(c="red",b="dyn_down.gif");this.setCValue("<div style='position:relative;padding-right:2px; width:100%;overflow:hidden; white-space:nowrap;'><img src='"+this.grid.imgURL+""+b+"' height='15' style='position:absolute;top:0px;left:0px;'><span style=' padding-left:20px; width:100%;color:"+c+";'>"+a+"</span></div>",a)};
function eXcell_ro(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return!0};this.getValue=function(){return this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()}}eXcell_ro.prototype=new eXcell;
function eXcell_ron(a){this.cell=a;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return!0};this.getValue=function(){return this.cell._clearCell?"":this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)}}eXcell_ron.prototype=new eXcell;
eXcell_ron.prototype.setValue=function(a){if(a!==0&&(!a||a.toString()._dhx_trim()==""))return this.setCValue("&nbsp;"),this.cell._clearCell=!0;this.cell._clearCell=!1;this.setCValue(a?this.grid._aplNF(a,this.cell._cellIndex):"0")};
function eXcell_rotxt(a){this.cell=a;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return!0};this.setValue=function(a){a?this.cell._clearCell=!1:(a=" ",this.cell._clearCell=!0);this.setCTxtValue(a)};this.getValue=function(){return this.cell._clearCell?"":_isIE?this.cell.innerText:this.cell.textContent}}eXcell_rotxt.prototype=new eXcell;
function dhtmlXGridComboObject(){this.keys=new dhtmlxArray;this.values=new dhtmlxArray;this.put=function(a,c){for(var b=0;b<this.keys.length;b++)if(this.keys[b]==a)return this.values[b]=c,!0;this.values[this.values.length]=c;this.keys[this.keys.length]=a};this.get=function(a){for(var c=0;c<this.keys.length;c++)if(this.keys[c]==a)return this.values[c];return null};this.clear=function(){this.keys=new dhtmlxArray;this.values=new dhtmlxArray};this.remove=function(a){for(var c=0;c<this.keys.length;c++)if(this.keys[c]==
a)return this.keys._dhx_removeAt(c),this.values._dhx_removeAt(c),!0};this.size=function(){for(var a=0,c=0;c<this.keys.length;c++)this.keys[c]!=null&&a++;return a};this.getKeys=function(){for(var a=[],c=0;c<this.keys.length;c++)this.keys[c]!=null&&(a[a.length]=this.keys[c]);return a};this.save=function(){this._save=[];for(var a=0;a<this.keys.length;a++)this._save[a]=[this.keys[a],this.values[a]]};this.restore=function(){if(this._save){this.keys[a]=[];this.values[a]=[];for(var a=0;a<this._save.length;a++)this.keys[a]=
this._save[a][0],this.values[a]=this._save[a][1]}};return this}function Hashtable(){this.keys=new dhtmlxArray;this.values=new dhtmlxArray;return this}Hashtable.prototype=new dhtmlXGridComboObject;
dhtmlXGridObject.prototype._process_json_row=function(a,c){a._attrs=c;for(var b=0;b<a.childNodes.length;b++)a.childNodes[b]._attrs={};if(c.userdata)for(var d in c.userdata)this.setUserData(a.idd,d,c.userdata[d]);for(var e=0;e<c.data.length;e++)if(typeof c.data[e]=="object"&&c.data[e]!=null){a.childNodes[e]._attrs=c.data[e];if(c.data[e].type)a.childNodes[e]._cellType=c.data[e].type;c.data[e]=c.data[e].value}this._fillRow(a,this._c_order?this._swapColumns(c.data):c.data);return a};
dhtmlXGridObject.prototype.updateFromJSON=function(a,c,b,d){typeof c=="undefined"&&(c=!0);this._refresh_mode=[!0,c,b];this.load(a,d,"json")};
dhtmlXGridObject.prototype._refreshFromJSON=function(a){this._f_rowsBuffer&&this.filterBy(0,"");reset=!1;if(window.eXcell_tree)eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue,eXcell_tree.prototype.setValue=function(a){var b=this.grid._h2.get[this.cell.parentNode.idd];b&&this.cell.parentNode.valTag?this.setLabel(a):this.setValueX(a)};var c=this.cellType._dhx_find("tree"),b=a.parent||0,d={};this._refresh_mode[2]&&(c!=-1?this._h2.forEachChild(b,function(a){d[a.id]=!0},this):this.forEachRow(function(a){d[a]=
!0}));for(var e=a.rows,h=0;h<e.length;h++){var g=e[h],f=g.id;d[f]=!1;if(this.rowsAr[f]&&this.rowsAr[f].tagName!="TR")this._h2?this._h2.get[f].buff.data=g:this.rowsBuffer[this.getRowIndex(f)].data=g,this.rowsAr[f]=g;else if(this.rowsAr[f])this._process_json_row(this.rowsAr[f],g,-1),this._postRowProcessing(this.rowsAr[f],!0);else if(this._refresh_mode[1]){var i={idd:f,data:g,_parser:this._process_json_row,_locator:this._get_json_data},j=this.rowsBuffer.length;this._refresh_mode[1]=="top"?(this.rowsBuffer.unshift(i),
j=0):this.rowsBuffer.push(i);if(this._h2)reset=!0,this._h2.add(f,b).buff=this.rowsBuffer[this.rowsBuffer.length-1];this.rowsAr[f]=g;g=this.render_row(j);this._insertRowAt(g,j?-1:0)}}if(this._refresh_mode[2])for(f in d)d[f]&&this.rowsAr[f]&&this.deleteRow(f);this._refresh_mode=null;if(window.eXcell_tree)eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX;reset&&this._renderSort();if(this._f_rowsBuffer)this._f_rowsBuffer=null,this.filterByAll()};
dhtmlXGridObject.prototype._process_json=function(a){this._parsing=!0;try{if(a&&a.xmlDoc)eval("dhtmlx.temp="+a.xmlDoc.responseText+";"),a=dhtmlx.temp;else if(typeof a=="string")eval("dhtmlx.temp="+a+";"),a=dhtmlx.temp}catch(c){dhtmlxError.throwError("LoadXML","Incorrect JSON",[a.xmlDoc||a,this]),a={rows:[]}}if(this._refresh_mode)return this._refreshFromJSON(a);var b=parseInt(a.pos||0),d=parseInt(a.total_count||0),e=!1;d&&(this.rowsBuffer[d-1]||(this.rowsBuffer.length&&(e=!0),this.rowsBuffer[d-1]=
null),d<this.rowsBuffer.length&&(this.rowsBuffer.splice(d,this.rowsBuffer.length-d),e=!0));for(var h in a)h!="rows"&&this.setUserData("",h,a[h]);if(this.isTreeGrid())return this._process_tree_json(a);for(var g=0;g<a.rows.length;g++)if(!this.rowsBuffer[g+b]){var f=a.rows[g].id;this.rowsBuffer[g+b]={idd:f,data:a.rows[g],_parser:this._process_json_row,_locator:this._get_json_data};this.rowsAr[f]=a.rows[g]}if(e&&this._srnd){var i=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=i}else this.render_dataset();
this._parsing=!1};dhtmlXGridObject.prototype._get_json_data=function(a,c){return typeof a.data[c]=="object"?a.data[c].value:a.data[c]};
dhtmlXGridObject.prototype._process_tree_json=function(a,c,b){this._parsing=!0;var d=!1;if(!c){this.render_row=this.render_row_tree;d=!0;c=a;b=c.parent||0;b=="0"&&(b=0);if(!this._h2)this._h2=new dhtmlxHierarchy;if(this._fake)this._fake._h2=this._h2}if(c.rows)for(var e=0;e<c.rows.length;e++){var h=c.rows[e].id,g=this._h2.add(h,b);g.buff={idd:h,data:c.rows[e],_parser:this._process_json_row,_locator:this._get_json_data};if(c.rows[e].open)g.state="minus";this.rowsAr[h]=g.buff;this._process_tree_json(c.rows[e],
c.rows[e],h)}if(d)b!=0&&this._h2.change(b,"state","minus"),this._updateTGRState(this._h2.get[b]),this._h2_to_buff(),b!=0&&(this._srnd||this.pagingOn)?this._renderSort():this.render_dataset(),this._slowParse===!1&&this.forEachRow(function(a){this.render_row_tree(0,a)}),this._parsing=!1};
dhtmlXGridObject.prototype._process_xmlA=function(a){if(!a.doXPath){var c=new dtmlXMLLoaderObject(function(){});typeof a=="string"?c.loadXMLString(a):(c.xmlDoc=a.responseXML?a:{},c.xmlDoc.responseXML=a);a=c}this._parsing=!0;var b=a.getXMLTopNode(this.xml.top);this._parseHead(b);var d=a.doXPath(this.xml.row,b),e=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0),h=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0);h&&!this.rowsBuffer[h-1]&&(this.rowsBuffer[h-1]=
null);if(this.isTreeGrid())return this._get_xml_data=this._get_xml_dataA,this._process_xml_row=this._process_xml_rowA,this._process_tree_xml(a);for(var g=0;g<d.length;g++)if(!this.rowsBuffer[g+e]){var f=d[g].getAttribute("id")||this.uid();this.rowsBuffer[g+e]={idd:f,data:d[g],_parser:this._process_xml_rowA,_locator:this._get_xml_dataA};this.rowsAr[f]=d[g]}this.render_dataset();this._parsing=!1;return a.xmlDoc.responseXML?a.xmlDoc.responseXML:a.xmlDoc};
dhtmlXGridObject.prototype._process_xmlB=function(a){if(!a.doXPath){var c=new dtmlXMLLoaderObject(function(){});typeof a=="string"?c.loadXMLString(a):(c.xmlDoc=a.responseXML?a:{},c.xmlDoc.responseXML=a);a=c}this._parsing=!0;var b=a.getXMLTopNode(this.xml.top);this._parseHead(b);var d=a.doXPath(this.xml.row,b),e=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0),h=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0);h&&!this.rowsBuffer[h-1]&&(this.rowsBuffer[h-1]=
null);if(this.isTreeGrid())return this._get_xml_data=this._get_xml_dataB,this._process_xml_row=this._process_xml_rowB,this._process_tree_xml(a);for(var g=0;g<d.length;g++)if(!this.rowsBuffer[g+e]){var f=d[g].getAttribute("id")||this.uid();this.rowsBuffer[g+e]={idd:f,data:d[g],_parser:this._process_xml_rowB,_locator:this._get_xml_dataB};this.rowsAr[f]=d[g]}this.render_dataset();this._parsing=!1;return a.xmlDoc.responseXML?a.xmlDoc.responseXML:a.xmlDoc};
dhtmlXGridObject.prototype._process_xml_rowA=function(a,c){var b=[];a._attrs=this._xml_attrs(c);for(var d=0;d<this.columnIds.length;d++){var e=this.columnIds[d],h=a._attrs[e]||"";if(a.childNodes[d])a.childNodes[d]._attrs={};b.push(h)}this._fillRow(a,this._c_order?this._swapColumns(b):b);return a};dhtmlXGridObject.prototype._get_xml_dataA=function(a,c){return a.getAttribute(this.getColumnId(c))};
dhtmlXGridObject.prototype._process_xml_rowB=function(a,c){var b=[];a._attrs=this._xml_attrs(c);if(this._ud_enabled)for(var d=this.xmlLoader.doXPath("./userdata",c),e=d.length-1;e>=0;e--)this.setUserData(d[e].getAttribute("name"),d[e].firstChild?d[e].firstChild.data:"");for(var h=0;h<c.childNodes.length;h++){var g=c.childNodes[h];if(g.tagName){var f=this.getColIndexById(g.tagName);if(!isNaN(f)){var i=g.getAttribute("type");if(i)a.childNodes[f]._cellType=i;a.childNodes[f]._attrs=this._xml_attrs(g);
g.getAttribute("xmlcontent")||(g=g.firstChild?g.firstChild.data:"");b[f]=g}}}for(e=0;e<a.childNodes.length;e++)if(!a.childNodes[e]._attrs)a.childNodes[e]._attrs={};this._fillRow(a,this._c_order?this._swapColumns(b):b);return a};dhtmlXGridObject.prototype._get_xml_dataB=function(a,c){for(var b=this.getColumnId(c),a=a.firstChild;;){if(!a)break;if(a.tagName==b)return a.firstChild?a.firstChild.data:"";a=a.nextSibling}return""};
dhtmlXGridObject.prototype.enableHeaderMenu=function(a){typeof a=="string"&&(a=a.split(","));this._hm_config=a;var c=this;this.attachEvent("onInit",function(){this.hdr.oncontextmenu=function(a){return c._doHContClick(a||window.event)};this.startColResizeA=this.startColResize;this.startColResize=function(a){return a.button==2||_isMacOS&&a.ctrlKey?this._doHContClick(a):this.startColResizeA(a)};this._chm_ooc=this.obj.onclick;this._chm_hoc=this.hdr.onclick;this.hdr.onclick=function(a){if(a&&(a.button==
2||_isMacOS&&a.ctrlKey))return!1;c._showHContext(!1);return c._chm_hoc.apply(this,arguments)};this.obj.onclick=function(){c._showHContext(!1);return c._chm_ooc.apply(this,arguments)}});dhtmlxEvent(document.body,"click",function(){c._hContext&&c._showHContext(!1)});this.hdr.rows.length&&this.callEvent("onInit",[]);this.enableHeaderMenu=function(){}};
dhtmlXGridObject.prototype._doHContClick=function(a){function c(a){if(a.pageX||a.pageY)return{x:a.pageX,y:a.pageY};var b=_isIE&&document.compatMode!="BackCompat"?document.documentElement:document.body;return{x:a.clientX+b.scrollLeft-b.clientLeft,y:a.clientY+b.scrollTop-b.clientTop}}this._createHContext();var b=c(a);this._showHContext(!0,b.x,b.y);a[_isIE?"srcElement":"target"].oncontextmenu=function(a){(a||event).cancelBubble=!0;return!1};a.cancelBubble=!0;a.preventDefault&&a.preventDefault();return!1};
dhtmlXGridObject.prototype._createHContext=function(){if(this._hContext)return this._hContext;var a=document.createElement("DIV");a.oncontextmenu=function(a){(a||event).cancelBubble=!0;return!1};a.onclick=function(a){return(a||event).cancelBubble=!0};a.className="dhx_header_cmenu";a.style.width=a.style.height="5px";a.style.display="none";var c=[],b=0;if(this._fake)b=this._fake._cCount;for(var d=b;b<this.hdr.rows[1].cells.length;b++){var e=this.hdr.rows[1].cells[b];if(!this._hm_config||this._hm_config[b]&&
this._hm_config[b]!="false"){var h=e.firstChild&&e.firstChild.tagName=="DIV"?e.firstChild.innerHTML:e.innerHTML,h=h.replace(/<[^>]*>/gi,"");c.push("<div class='dhx_header_cmenu_item'><input type='checkbox' column='"+d+"' len='"+(e.colSpan||1)+"' checked='true' />"+h+"</div>")}d+=e.colSpan||1}a.innerHTML=c.join("");for(var g=this,f=function(){var a=this.getAttribute("column");if(!this.checked&&!g._checkLast(a))return this.checked=!0;if(g._realfake)g=g._fake;for(var b=0;b<this.getAttribute("len");b++)g.setColumnHidden(a*
1+b*1,!this.checked);this.checked&&g.getColWidth(a)==0&&g.adjustColumnSize(a)},b=0;b<a.childNodes.length;b++)a.childNodes[b].firstChild.onclick=f;document.body.insertBefore(a,document.body.firstChild);this._hContext=a;a.style.position="absolute";a.style.zIndex=999;a.style.width="auto";a.style.height="auto";a.style.display="block"};dhtmlXGridObject.prototype._checkLast=function(a){for(var c=0;c<this._cCount;c++)if((!this._hrrar||!this._hrrar[c])&&c!=a)return!0;return!1};
dhtmlXGridObject.prototype._updateHContext=function(){for(var a=0;a<this._hContext.childNodes.length;a++){var c=this._hContext.childNodes[a].firstChild,b=c.getAttribute("column");if(this.isColumnHidden(b)||this.getColWidth(b)==0)c.checked=!1}};
dhtmlXGridObject.prototype._showHContext=function(a,c,b){if(a&&this.enableColumnMove)this._hContext.parentNode.removeChild(this._hContext),this._hContext=null;this._createHContext();this._hContext.style.display=a?"block":"none";if(a)this._updateHContext(!0),this._hContext.style.left=c+"px",this._hContext.style.top=b+"px"};
function eXcell_math(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.edit=function(){this.grid.editor=new eXcell_ed(this.cell);this.grid.editor.fix_self=!0;this.grid.editor.getValue=this.cell.original?function(){return this.cell.original}:this.getValue;this.grid.editor.setValue=this.setValue;this.grid.editor.edit()};this.isDisabled=function(){return!this.grid._mathEdit};this.setValue=function(a){a=this.grid._compileSCL(a,this.cell,this.fix_self);this.grid._strangeParams[this.cell._cellIndex]?
this.grid.cells5(this.cell,this.grid._strangeParams[this.cell._cellIndex]).setValue(a):(this.setCValue(a),this.cell._clearCell=!1)};this.getValue=function(){return this.grid._strangeParams[this.cell._cellIndex]?this.grid.cells5(this.cell,this.grid._strangeParams[this.cell._cellIndex]).getValue():this.cell.innerHTML}}eXcell_math.prototype=new eXcell;dhtmlXGridObject.prototype._init_point_bm=dhtmlXGridObject.prototype._init_point;
dhtmlXGridObject.prototype._init_point=function(){this._mat_links={};this._aggregators=[];this.attachEvent("onClearAll",function(){this._mat_links={};this._aggregators=[]});this.attachEvent("onCellChanged",function(a,c){if(this._mat_links[a]){var b=this._mat_links[a][c];if(b)for(var d=0;d<b.length;d++)this.cells5(b[d]).setValue(this._calcSCL(b[d]))}if(!this._parsing&&this._aggregators[c]){var e=this._h2.get[a].parent.id;if(e!=0){var h=this.cells(e,c);h.setValue(this._calcSCL(h.cell))}}});this.attachEvent("onAfterRowDeleted",
function(a,c){if(c!=0&&!this._parsing&&this._aggregators.length)for(var b=0;b<this._aggregators.length;b++)if(this._aggregators[b]){var d=this.cells(c,b);d.setValue(this._calcSCL(d.cell))}return!0});this.attachEvent("onXLE",function(){for(var a=0;a<this._aggregators.length;a++)this._aggregators[a]&&this._h2.forEachChild(0,function(c){if(c.childs.length!=0){var b=this.cells(c.id,a);b.setValue(this._calcSCL(b.cell))}},this)});(this._init_point=this._init_point_bm)&&this._init_point()};
dhtmlXGridObject.prototype.enableMathSerialization=function(a){this._mathSerialization=convertStringToBoolean(a)};dhtmlXGridObject.prototype.setMathRound=function(a){this._roundDl=a;this._roundD=Math.pow(10,a)};dhtmlXGridObject.prototype.enableMathEditing=function(a){this._mathEdit=convertStringToBoolean(a)};
dhtmlXGridObject.prototype._calcSCL=function(a){if(!a._code)return this.cells5(a).getValue();try{dhtmlx.agrid=this;var c=eval(a._code)}catch(b){return"#SCL"}if(this._roundD){var d=Math.abs(c)<1?"0":"";c<0&&(d="-"+d);c=Math.round(Math.abs(c)*this._roundD).toString();if(c==0)return 0;if(this._roundDl>0){var e=c.length-this._roundDl;e<0&&(c=("000000000"+c).substring(9+e),e=0);return d+c.substring(0,e)+"."+c.substring(e,c.length)}}return c};
dhtmlXGridObject.prototype._countTotal=function(a,c){for(var b=0,d=this._h2.get[a],e=0;e<d.childs.length;e++){if(!d.childs[e].buff)break;if(d.childs[e].buff._parser){this._h2.forEachChild(a,function(a){a.childs.length==0&&(b+=parseInt(this._get_cell_value(a.buff,c),10))},this);break}b+=parseInt(this._get_cell_value(d.childs[e].buff,c),10)}return b};
dhtmlXGridObject.prototype._compileSCL=function(a,c,b){if(a===null||a===window.undefined)return a;a=a.toString();if(a.indexOf("=")!=0){this._reLink([],c);if(b)c._code=c.original=null;return a}c.original=a;var d=null,a=a.replace("=","");if(a.indexOf("sum")!=-1){a=a.replace("sum","(dhtmlx.agrid._countTotal('"+c.parentNode.idd+"',"+c._cellIndex+"))");if(!this._aggregators)this._aggregators=[];this._aggregators[c._cellIndex]="sum";c._code=a;return this._parsing?"":this._calcSCL(c)}if(a.indexOf("[[")!=
-1){var e=/(\[\[([^\,]*)\,([^\]]*)]\])/g;dhtmlx.agrid=this;d=d||[];a=a.replace(e,function(a,b,e,h){if(e=="-")e=c.parentNode.idd;e.indexOf("#")==0&&(e=dhtmlx.agrid.getRowId(e.replace("#","")));d[d.length]=[e,h];return'(parseInt(dhtmlx.agrid.cells("'+e+'",'+h+").getValue(),10))"})}if(a.indexOf(":")!=-1){e=/:(\w+)/g;dhtmlx.agrid=this;var h=c.parentNode.idd,d=d||[],a=a.replace(e,function(a,b){d[d.length]=[h,dhtmlx.agrid.getColIndexById(b)];return'(parseInt(dhtmlx.agrid.cells("'+h+'",dhtmlx.agrid.getColIndexById("'+
b+'")).getValue(),10))'})}else e=/c([0-9]+)/g,dhtmlx.agrid=this,h=c.parentNode.idd,d=d||[],a=a.replace(e,function(a,b){d[d.length]=[h,b];return'(parseInt(dhtmlx.agrid.cells("'+h+'",'+b+").getValue(),10))"});this._reLink(d,c);c._code=a;return this._calcSCL(c)};dhtmlXGridObject.prototype._reLink=function(a,c){if(a.length)for(var b=0;b<a.length;b++){this._mat_links[a[b][0]]||(this._mat_links[a[b][0]]={});var d=this._mat_links[a[b][0]];d[a[b][1]]||(d[a[b][1]]=[]);d[a[b][1]].push(c)}};
_isKHTML&&function(){var a=String.prototype.replace;String.prototype.replace=function(c,b){if(typeof b!="function")return a.apply(this,arguments);var d=""+this,e=b;if(!(c instanceof RegExp)){var h=d.indexOf(c);return h==-1?d:a.apply(d,[c,e(c,h,d)])}for(var g=c,f=[],i=g.lastIndex,j;(j=g.exec(d))!=null;){var h=j.index,k=j.concat(h,d);f.push(d.slice(i,h),e.apply(null,k).toString());if(g.global)i=g.lastIndex;else{i+=RegExp.lastMatch.length;break}}f.push(d.slice(i));return f.join("")}}();
dhtmlXGridObject.prototype.loadCSVFile=function(a,c){this.load(a,c,"csv")};dhtmlXGridObject.prototype.enableCSVAutoID=function(a){this._csvAID=convertStringToBoolean(a)};dhtmlXGridObject.prototype.enableCSVHeader=function(a){this._csvHdr=convertStringToBoolean(a)};dhtmlXGridObject.prototype.setCSVDelimiter=function(a){this.csv.cell=a};dhtmlXGridObject.prototype._csvAID=!0;dhtmlXGridObject.prototype.loadCSVString=function(a){this.parse(a,"csv")};
dhtmlXGridObject.prototype.serializeToCSV=function(a){this.editStop();this._agetm=this._mathSerialization?"getMathValue":this._strictText||a?"getTitle":"getValue";var c=[];if(this._csvHdr)for(var b=1;b<this.hdr.rows.length;b++){for(var d=[],e=0;e<this._cCount;e++)(!this._srClmn||this._srClmn[e])&&d.push(this.getColumnLabel(e,b-1));c.push(this.csvParser.str(d,this.csv.cell,this.csv.row))}for(var e=0,h=this.rowsBuffer.length;e<h;e++){var g=this._serializeRowToCVS(null,e);g!=""&&c.push(g)}return this.csvParser.block(c,
this.csv.row)};
dhtmlXGridObject.prototype._serializeRowToCVS=function(a,c,b,d){var e=[];a||(a=this.render_row(c),this._fake&&!this._fake.rowsAr[a.idd]&&this._fake.render_row(c));if(!this._csvAID)e[e.length]=a.idd;for(var b=b||0,d=d||this._cCount,h=!1,g=b;a.childNodes[b]._cellIndex>g&&b;)b--;for(var f=b;g<d;f++){if(!a.childNodes[f])break;var i=a.childNodes[f]._cellIndex;if(!this._srClmn||this._srClmn[i]){for(var j=a.childNodes[f],k=this.cells(a.idd,i);g!=i;)if(g++,e.push(""),g>=d)break;if(g>=d)break;g++;zxVal=k.cell?
k[this._agetm]():"";this._chAttr&&k.wasChanged()&&(h=!0);e[e.length]=zxVal===null?"":zxVal;if(this._ecspn&&j.colSpan&&j.colSpan>1)for(var j=j.colSpan-1,l=0;l<j;l++)e[e.length]="",g++}else g++}return this._onlChAttr&&!h?"":this.csvParser.str(e,this.csv.cell,this.csv.row)};dhtmlXGridObject.prototype.toClipBoard=function(a){window.clipboardData?window.clipboardData.setData("Text",a):(new Clipboard).copy(a)};
dhtmlXGridObject.prototype.fromClipBoard=function(){return window.clipboardData?window.clipboardData.getData("Text"):(new Clipboard).paste()};dhtmlXGridObject.prototype.cellToClipboard=function(a,c){if(!a||!c){if(!this.selectedRows[0])return;a=this.selectedRows[0].idd;c=this.cell._cellIndex}var b=this.cells(a,c);this.toClipBoard(((b.getLabel?b.getLabel():b.getValue())||"").toString())};
dhtmlXGridObject.prototype.updateCellFromClipboard=function(a,c){if(!a||!c){if(!this.selectedRows[0])return;a=this.selectedRows[0].idd;c=this.cell._cellIndex}var b=this.cells(a,c);b[b.setImage?"setLabel":"setValue"](this.fromClipBoard())};
dhtmlXGridObject.prototype.rowToClipboard=function(a){var c="";this._agetm=this._mathSerialization?"getMathValue":this._strictText?"getTitle":"getValue";if(a)c=this._serializeRowToCVS(this.getRowById(a));else for(var b=[],d=0;d<this.selectedRows.length;d++)b[b.length]=this._serializeRowToCVS(this.selectedRows[d]),c=this.csvParser.block(b,this.csv.row);this.toClipBoard(c)};
dhtmlXGridObject.prototype.updateRowFromClipboard=function(a){var c=this.fromClipBoard();if(c){var b=a?this.getRowById(a):this.selectedRows[0];if(b){var d=this.csvParser,c=d.unblock(c,this.csv.cell,this.csv.row)[0];this._csvAID||c.splice(0,1);for(var e=0;e<c.length;e++){var h=this.cells3(b,e);h[h.setImage?"setLabel":"setValue"](c[e])}}}};
dhtmlXGridObject.prototype.csvParser={block:function(a,c){return a.join(c)},unblock:function(a,c,b){for(var d=(a||"").split(b),e=0;e<d.length;e++)d[e]=(d[e]||"").split(c);var h=d.length-1;d[h].length==1&&d[h][0]==""&&d.splice(h,1);return d},str:function(a,c){return a.join(c)}};
dhtmlXGridObject.prototype.csvExtParser={_quote:RegExp('"',"g"),_quote_esc:RegExp('\\\\"',"g"),block:function(a,c){return a.join(c)},unblock:function(a,c,b){var d=[[]],e=0;if(!a)return d;for(var h=/^[ ]*"/,g=/"[ ]*$/,f=RegExp(".*"+b+".*$"),i=a.split(c),j=0;j<i.length;j++)if(i[j].match(h)){for(var k=i[j].replace(h,"");!i[j].match(g);)j++,k+=i[j];d[e].push(k.replace(g,"").replace(this._quote_esc,'"'))}else if(i[j].match(f)){var l=i[j].split(b,2);d[e].push(l[0]);e++;d[e]=[];i[j]=l[1];j--}else(i[j]||
j!=i.length-1)&&d[e].push(i[j]);return d},str:function(a,c){for(var b=0;b<a.length;b++)a[b]='"'+a[b].replace(this._quote,'\\"')+'"';return a.join(c)}};dhtmlXGridObject.prototype.addRowFromClipboard=function(){var a=this.fromClipBoard();if(a)for(var c=this.csvParser.unblock(a,this.csv.cell,this.csv.row),b=0;b<c.length;b++)c[b]&&(a=c[b],a.length&&(this._csvAID?this.addRow(this.getRowsNum()+2,a):(this.rowsAr[a[0]]&&(a[0]=this.uid()),this.addRow(a[0],a.slice(1)))))};
dhtmlXGridObject.prototype.gridToClipboard=function(){this.toClipBoard(this.serializeToCSV())};dhtmlXGridObject.prototype.gridFromClipboard=function(){var a=this.fromClipBoard();a&&this.loadCSVString(a)};
dhtmlXGridObject.prototype.getXLS=function(a){if(!this.xslform){this.xslform=document.createElement("FORM");this.xslform.action=(a||"")+"xls.php";this.xslform.method="post";this.xslform.target=_isIE?"_blank":"";document.body.appendChild(this.xslform);var c=document.createElement("INPUT");c.type="hidden";c.name="csv";this.xslform.appendChild(c);var b=document.createElement("INPUT");b.type="hidden";b.name="csv_header";this.xslform.appendChild(b)}var d=this.serializeToCSV();this.xslform.childNodes[0].value=
d;for(var e=[],h=this._cCount,g=0;g<h;g++)e.push(this.getHeaderCol(g));e=e.join(",");this.xslform.childNodes[1].value=e;this.xslform.submit()};
dhtmlXGridObject.prototype.printView=function(a,c){var b="<style>TD { font-family:Arial; text-align:center; padding-left:2px;padding-right:2px; } \n td.filter input, td.filter select { display:none; }\t\n  </style>",d=null;if(this._fake)for(var d=[].concat(this._hrrar),e=0;e<this._fake._cCount;e++)this._hrrar[e]=null;b+="<base  href='"+document.location.href+"'></base>";this.parentGrid||(b+=a||"");b+='<table width="100%" border="2px" cellpadding="0" cellspacing="0">';var h=Math.max(this.rowsBuffer.length,
this.rowsCol.length),g=this._cCount,f=this._printWidth();b+='<tr class="header_row_1">';for(e=0;e<g;e++)if(!this._hrrar||!this._hrrar[e]){for(var i=this.hdr.rows[1].cells[this.hdr.rows[1]._childIndexes?this.hdr.rows[1]._childIndexes[parseInt(e)]:e],j=i.colSpan||1,k=i.rowSpan||1,l=1;l<j;l++)f[e]+=f[l];b+='<td rowspan="'+k+'" width="'+f[e]+'%" style="background-color:lightgrey;" colspan="'+j+'">'+this.getHeaderCol(e)+"</td>";e+=j-1}b+="</tr>";for(e=2;e<this.hdr.rows.length;e++)if(_isIE){b+="<tr style='background-color:lightgrey' class='header_row_"+
e+"'>";for(var m=this.hdr.rows[e].childNodes,l=0;l<m.length;l++)if(!this._hrrar||!this._hrrar[m[l]._cellIndex])b+=m[l].outerHTML;b+="</tr>"}else b+="<tr class='header_row_"+e+"' style='background-color:lightgrey'>"+(this._fake?this._fake.hdr.rows[e].innerHTML:"")+this.hdr.rows[e].innerHTML+"</tr>";for(e=0;e<h;e++)if(b+="<tr>",this.rowsCol[e]&&this.rowsCol[e]._cntr)b+=this.rowsCol[e].innerHTML.replace(/<img[^>]*>/gi,"")+"</tr>";else if(!(this.rowsCol[e]&&this.rowsCol[e].style.display=="none")){var o;
if(this.rowsCol[e])o=this.rowsCol[e].idd;else if(this.rowsBuffer[e])o=this.rowsBuffer[e].idd;else continue;for(l=0;l<g;l++)if(!this._hrrar||!this._hrrar[l]){if(this.rowsAr[o]&&this.rowsAr[o].tagName=="TR")var n=this.cells(o,l),p=n._setState?"":n.getContent?n.getContent():n.getImage||n.combo?n.cell.innerHTML:n.getValue();else p=this._get_cell_value(this.rowsBuffer[e],l);var r=this.columnColor[l]?"background-color:"+this.columnColor[l]+";":"",t=this.cellAlign[l]?"text-align:"+this.cellAlign[l]+";":
"",s=n.getAttribute("colspan");b+='<td style="'+r+t+'" '+(s?'colSpan="'+s+'"':"")+">"+(p===""?"&nbsp;":p)+"</td>";s&&(l+=s-1)}b+="</tr>";if(this.rowsCol[e]&&this.rowsCol[e]._expanded){var u=this.cells4(this.rowsCol[e]._expanded.ctrl);b+=u.getSubGrid?'<tr><td colspan="'+g+'">'+u.getSubGrid().printView()+"</td></tr>":'<tr><td colspan="'+g+'">'+this.rowsCol[e]._expanded.innerHTML+"</td></tr>"}}if(this.ftr)for(e=1;e<this.ftr.childNodes[0].rows.length;e++)b+="<tr style='background-color:lightgrey'>"+(this._fake?
this._fake.ftr.childNodes[0].rows[e].innerHTML:"")+this.ftr.childNodes[0].rows[e].innerHTML+"</tr>";b+="</table>";if(this.parentGrid)return b;b+=c||"";var q=window.open("","_blank");q.document.write(b);q.document.write("<script>window.onerror=function(){return true;}<\/script>");q.document.close();if(this._fake)this._hrrar=d};
dhtmlXGridObject.prototype._printWidth=function(){for(var a=[],c=0,b=0;b<this._cCount;b++){var d=this.getColWidth(b);a.push(d);c+=d}for(var e=[],h=0,b=0;b<a.length;b++){var g=Math.floor(a[b]/c*100);h+=g;e.push(g)}e[e.length-1]+=100-h;return e};dhtmlXGridObject.prototype.loadObject=function(){};dhtmlXGridObject.prototype.loadJSONFile=function(){};dhtmlXGridObject.prototype.serializeToObject=function(){};dhtmlXGridObject.prototype.serializeToJSON=function(){};
if(!window.clipboardData)window.clipboardData={_make:function(){var a=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!a)return null;var c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c)return null;c.addDataFlavor("text/unicode");var b=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);this._p=[a,c,b];return!0},
setData:function(a,c){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(b){return dhtmlxError.throwError("Clipboard","Access to clipboard denied",[a,c]),""}if(!this._make())return!1;this._p[2].data=c;this._p[1].setTransferData("text/unicode",this._p[2],c.length*2);var d=Components.interfaces.nsIClipboard;this._p[0].setData(this._p[1],null,d.kGlobalClipboard)},getData:function(a){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(c){return dhtmlxError.throwError("Clipboard",
"Access to clipboard denied",[a]),""}if(!this._make())return!1;this._p[0].getData(this._p[1],this._p[0].kGlobalClipboard);var b={},d={};try{this._p[1].getTransferData("text/unicode",d,b)}catch(e){return""}d&&(d=d.value.QueryInterface(Components.interfaces.nsISupportsString));return d?d.data.substring(0,b.value/2):""}};
dhtmlXGridObject.prototype.setRowspan=function(a,c,b){var d=this[this._bfs_cells?"_bfs_cells":"cells"](a,c).cell,e=this.rowsAr[a];if(d.rowSpan&&d.rowSpan!=1)for(var h=e.nextSibling,g=1;g<d.rowSpan;g++){var f=h.childNodes[h._childIndexes[d._cellIndex+1]],i=document.createElement("TD");i.innerHTML="&nbsp;";i._cellIndex=d._cellIndex;i._clearCell=!0;f?f.parentNode.insertBefore(i,f):h.parentNode.appendChild(i);this._shiftIndexes(h,d._cellIndex,-1);h=h.nextSibling}d.rowSpan=b;for(var e=this._h2?this.rowsAr[this._h2.get[e.idd].parent.childs[this._h2.get[e.idd].index+
1].id]:e.nextSibling||this.rowsCol[this.rowsCol._dhx_find(e)+1],j=[],g=1;g<b;g++){var k=null,k=this._fake&&!this._realfake?this._bfs_cells3(e,c).cell:this.cells3(e,c).cell;this._shiftIndexes(e,d._cellIndex,1);k&&k.parentNode.removeChild(k);j.push(e);this._h2?(e=this._h2.get[e.idd].parent.childs[this._h2.get[e.idd].index+1])&&(e=this.rowsAr[e.id]):e=e.nextSibling||this.rowsCol[this.rowsCol._dhx_find(e)+1]}this.rowsAr[a]._rowSpan=this.rowsAr[a]._rowSpan||{};this.rowsAr[a]._rowSpan[c]=j;this._fake&&
!this._realfake&&c<this._fake._cCount&&this._fake.setRowspan(a,c,b)};dhtmlXGridObject.prototype._shiftIndexes=function(a,c,b){if(!a._childIndexes){a._childIndexes=[];for(var d=0;d<a.childNodes.length;d++)a._childIndexes[d]=d}for(d=0;d<a._childIndexes.length;d++)d>c&&(a._childIndexes[d]-=b)};
dhtmlXGridObject.prototype.enableRowspan=function(){this._erspan=!0;this.enableRowspan=function(){};this.attachEvent("onAfterSorting",function(){if(!this._dload){for(var a=1;a<this.obj.rows.length;a++)if(this.obj.rows[a]._rowSpan){var c=this.obj.rows[a],b;for(b in c._rowSpan)for(var d=c,e=d._rowSpan[b],h=0;h<e.length;h++){d.nextSibling?d.parentNode.insertBefore(e[h],d.nextSibling):d.parentNode.appendChild(e[h]);if(this._fake){var g=this._fake.rowsAr[d.idd],f=this._fake.rowsAr[e[h].idd];g.nextSibling?
g.parentNode.insertBefore(f,g.nextSibling):g.parentNode.appendChild(f);this._correctRowHeight(d.idd)}d=d.nextSibling}}var i=this.rowsCol.stablesort;this.rowsCol=new dhtmlxArray;this.rowsCol.stablesort=i;for(a=1;a<this.obj.rows.length;a++)this.rowsCol.push(this.obj.rows[a])}});this.attachEvent("onXLE",function(a,c,b,d){for(var e=this.xmlLoader.doXPath("//cell[@rowspan]",d),h=0;h<e.length;h++){for(var g=e[h].parentNode,f=g.getAttribute("id"),i=e[h].getAttribute("rowspan"),j=0,k=0;k<g.childNodes.length;k++)if(g.childNodes[k].tagName==
"cell")if(g.childNodes[k]==e[h])break;else j++;this.setRowspan(f,j,i)}})};dhtmlXGridObject.prototype._init_point_bspl=dhtmlXGridObject.prototype._init_point;dhtmlXGridObject.prototype._init_point=function(){this._split_later&&this.splitAt(this._split_later);(this._init_point=this._init_point_bspl)&&this._init_point()};
dhtmlXGridObject.prototype.splitAt=function(a){function c(a,b){b.style.whiteSpace="";var c=b.nextSibling,d=b.parentNode;a.parentNode.insertBefore(b,a);c?d.insertBefore(a,c):d.appendChild(a);var e=a.style.display;a.style.display=b.style.display;b.style.display=e}function b(b,d,e,f){var g=Array(a).join(this.delim),h=[];if(b==2)for(var k=0;k<a;k++){var i=d[b-1].cells[d[b-1]._childIndexes?d[b-1]._childIndexes[k]:k];if(i.rowSpan&&i.rowSpan>1)h[i._cellIndex]=i.rowSpan-1,f[b-1].cells[f[b-1]._childIndexes?
f[b-1]._childIndexes[k]:k].rowSpan=i.rowSpan,i.rowSpan=1}for(;b<d.length;b++){this._fake.attachHeader(g,null,e);for(var f=f||this._fake.ftr.childNodes[0].rows,l=a,j=0,m=0;m<l;m++)if(h[m]){h[m]-=1;if(_isIE||_isFF&&_FFrv>=1.9||_isOpera){var o=document.createElement("TD");if(_isFF)o.style.display="none";d[b].insertBefore(o,d[b].cells[0])}j++}else{var n=f[b].cells[m-j],y=d[b].cells[m-(_isIE?0:j)],z=y.rowSpan;c(n,y);if(z>1)h[m]=z-1,y.rowSpan=z;if(f[b].cells[m].colSpan>1){d[b].cells[m].colSpan=f[b].cells[m].colSpan;
l-=f[b].cells[m].colSpan-1;for(k=1;k<f[b].cells[m].colSpan;k++)f[b].removeChild(f[b].cells[m+1])}}}}if(!this.obj.rows[0])return this._split_later=a;var a=parseInt(a),d=document.createElement("DIV");this.entBox.appendChild(d);var e=document.createElement("DIV");this.entBox.appendChild(e);for(var h=this.entBox.childNodes.length-3;h>=0;h--)e.insertBefore(this.entBox.childNodes[h],e.firstChild);this.entBox.style.position="relative";this.globalBox=this.entBox;this.entBox=e;e.grid=this;d.style.cssText+=
"border:0px solid red !important;";e.style.cssText+="border:0px solid red !important;";e.style.top="0px";e.style.position="absolute";d.style.position="absolute";d.style.top="0px";d.style.left="0px";d.style.zIndex=11;e.style.height=d.style.height=this.globalBox.clientHeight;this._fake=new dhtmlXGridObject(d);this._fake.setSkin("not_existing_skin");this.globalBox=this._fake.globalBox=this.globalBox;this._fake._fake=this;this._fake._realfake=!0;this._treeC=this.cellType._dhx_find("tree");this._fake.delim=
this.delim;this._fake.customGroupFormat=this.customGroupFormat;this._fake.imgURL=this.imgURL;this._fake._customSorts=this._customSorts;this._fake.noHeader=this.noHeader;this._fake._enbTts=this._enbTts;this._fake.clists=this.clists;this._fake.fldSort=[];this._fake.selMultiRows=this.selMultiRows;if((this._fake.multiLine=this.multiLine)||this._erspan){this.attachEvent("onCellChanged",this._correctRowHeight);var g=function(){this.forEachRow(function(a){this._correctRowHeight(a)})};this.attachEvent("onPageChanged",
g);this.attachEvent("onXLE",g);this.attachEvent("onResizeEnd",g);this._ads_count||this.attachEvent("onAfterSorting",g);this.attachEvent("onDistributedEnd",g)}this.attachEvent("onGridReconstructed",function(){this._fake.objBox.scrollTop=this.objBox.scrollTop});this._fake.loadedKidsHash=this.loadedKidsHash;if(this._h2)this._fake._h2=this._h2;this._fake._dInc=this._dInc;var f=[[],[],[],[],[],[],[]],i="hdrLabels,initCellWidth,cellType,cellAlign,cellVAlign,fldSort,columnColor".split(","),j="setHeader,setInitWidths,setColTypes,setColAlign,setColVAlign,setColSorting,setColumnColor".split(",");
this._fake.callEvent=function(){this._fake._split_event=!0;arguments[0]=="onGridReconstructed"&&this._fake.callEvent.apply(this,arguments);return this._fake.callEvent.apply(this._fake,arguments)};this._elmn&&this._fake.enableLightMouseNavigation(!0);(this.__cssEven||this._cssUnEven)&&this._fake.attachEvent("onGridReconstructed",function(){this._fixAlterCss()});this._fake._cssEven=this._cssEven;this._fake._cssUnEven=this._cssUnEven;this._fake._cssSP=this._cssSP;this._fake.isEditable=this.isEditable;
this._fake._edtc=this._edtc;this._sst&&this._fake.enableStableSorting(!0);this._fake._sclE=this._sclE;this._fake._dclE=this._dclE;this._fake._f2kE=this._f2kE;this._fake._maskArr=this._maskArr;this._fake._dtmask=this._dtmask;this._fake.combos=this.combos;for(var k=0,l=this.globalBox.offsetWidth,h=0;h<a;h++){for(var m=0;m<i.length;m++)this[i[m]]&&(f[m][h]=this[i[m]][h]),typeof f[m][h]=="string"&&(f[m][h]=f[m][h].replace(RegExp("\\"+this.delim,"g"),"\\"+this.delim));_isFF&&(f[1][h]*=1);this.cellWidthType==
"%"?(f[1][h]=Math.round(parseInt(this[i[1]][h])*l/100),k+=f[1][h]):k+=parseInt(this[i[1]][h]);this.setColumnHidden(h,!0)}for(m=0;m<i.length;m++){var o=f[m].join(this.delim);if(j[m]!="setHeader"){if(o!="")this._fake[j[m]](o)}else this._fake[j[m]](o,null,this._hstyles)}this._fake._strangeParams=this._strangeParams;this._fake._drsclmn=this._drsclmn;k=Math.min(this.globalBox.offsetWidth,k);e.style.left=k+"px";d.style.width=k+"px";e.style.width=Math.max(this.globalBox.offsetWidth-k,0);if(this._ecspn)this._fake._ecspn=
!0;this._fake.init();this.dragAndDropOff&&this.dragger.addDragLanding(this._fake.entBox,this);this._fake.objBox.style.overflow="hidden";this._fake.objBox.style.overflowX="scroll";this._fake._srdh=this._srdh||20;this._fake._srnd=this._srnd;this.hdr.rows.length>2&&b.call(this,2,this.hdr.rows,"_aHead",this._fake.hdr.rows);if(this.ftr)b.call(this,1,this.ftr.childNodes[0].rows,"_aFoot"),this._fake.ftr.parentNode.style.bottom=(_isFF?2:1)+"px";if(this.saveSizeToCookie)this.saveSizeToCookie=function(b,c){if(this._realfake)return this._fake.saveSizeToCookie.apply(this._fake,
arguments);if(!b)b=this.entBox.id;for(var d=[],e="cellWidthPX",f=0;f<this[e].length;f++)d[f]=f<a?this._fake[e][f]:this[e][f];d=d.join(",");this.setCookie(b,c,0,d);d=(this.initCellWidth||[]).join(",");this.setCookie(b,c,1,d);return!0},this.loadSizeFromCookie=function(b){if(!b)b=this.entBox.id;var c=this._getCookie(b,1);if(c){this.initCellWidth=c.split(",");var c=this._getCookie(b,0),d="cellWidthPX";this.cellWidthType="px";var e=0;if(c&&c.length)for(var c=c.split(","),f=0;f<c.length;f++)f<a?(this._fake[d][f]=
c[f],e+=c[f]*1):this[d][f]=c[f];this._fake.entBox.style.width=e+"px";this._fake.objBox.style.width=e+"px";var g=this.globalBox.childNodes[1];g.style.left=e-(_isFF?0:0)+"px";if(this.ftr)this.ftr.style.left=e-(_isFF?0:0)+"px";g.style.width=this.globalBox.offsetWidth-e+"px";this.setSizes();return!0}},this._fake.onRSE=this.onRSE;this.setCellTextStyleA=this.setCellTextStyle;this.setCellTextStyle=function(b,c,d){c<a&&this._fake.setCellTextStyle(b,c,d);this.setCellTextStyleA(b,c,d)};this.setRowTextBoldA=
this.setRowTextBold;this.setRowTextBold=function(a){this.setRowTextBoldA(a);this._fake.setRowTextBold(a)};this.setRowColorA=this.setRowColor;this.setRowColor=function(a,b){this.setRowColorA(a,b);this._fake.setRowColor(a,b)};this.setRowHiddenA=this.setRowHidden;this.setRowHidden=function(a,b){this.setRowHiddenA(a,b);this._fake.setRowHidden(a,b)};this.setRowTextNormalA=this.setRowTextNormal;this.setRowTextNormal=function(a){this.setRowTextNormalA(a);this._fake.setRowTextNormal(a)};this.getChangedRows=
function(a){function b(a){for(var d=0;d<a.childNodes.length;d++)if(a.childNodes[d].wasChanged)return c[c.length]=a.idd}var c=[];this.forEachRow(function(d){var e=this.rowsAr[d],f=this._fake.rowsAr[d];if(!(e.tagName!="TR"||f.tagName!="TR"))a&&e._added?c[c.length]=e.idd:b(e)||b(f)});return c.join(this.delim)};this.setRowTextStyleA=this.setRowTextStyle;this.setRowTextStyle=function(a,b){this.setRowTextStyleA(a,b);this._fake.rowsAr[a]&&this._fake.setRowTextStyle(a,b)};this.lockRowA=this.lockRow;this.lockRow=
function(a,b){this.lockRowA(a,b);this._fake.lockRow(a,b)};this.getColWidth=function(b){return b<a?parseInt(this._fake.cellWidthPX[b]):parseInt(this.cellWidthPX[b])};this.getColumnLabel=function(b){return this._fake.getColumnLabel.apply(b<a?this._fake:this,arguments)};this.setColWidthA=this._fake.setColWidthA=this.setColWidth;this.setColWidth=function(b,c){b*=1;b<a?this._fake.setColWidthA(b,c):this.setColWidthA(b,c);b+1<=a&&this._fake._correctSplit(Math.min(this._fake.objBox.offsetWidth,this._fake.obj.offsetWidth))};
this.adjustColumnSizeA=this.adjustColumnSize;this.setColumnLabelA=this.setColumnLabel;this.setColumnLabel=function(b,c,d,e){var f=this;if(b<a)f=this._fake;return this.setColumnLabelA.apply(f,[b,c,d,e])};this.adjustColumnSize=function(b,c){if(b<a){if(_isIE)this._fake.obj.style.tableLayout="";this._fake.adjustColumnSize(b,c);if(_isIE)this._fake.obj.style.tableLayout="fixed";this._fake._correctSplit()}else return this.adjustColumnSizeA(b,c)};var n="cells";this._bfs_cells=this[n];this[n]=function(){return arguments[1]<
a?this._fake.cells.apply(this._fake,arguments):this._bfs_cells.apply(this,arguments)};this._bfs_isColumnHidden=this.isColumnHidden;this.isColumnHidden=function(){return parseInt(arguments[0])<a?this._fake.isColumnHidden.apply(this._fake,arguments):this._bfs_isColumnHidden.apply(this,arguments)};this._bfs_setColumnHidden=this.setColumnHidden;this.setColumnHidden=function(){return parseInt(arguments[0])<a?(this._fake.setColumnHidden.apply(this._fake,arguments),this._fake._correctSplit()):this._bfs_setColumnHidden.apply(this,
arguments)};n="cells2";this._bfs_cells2=this[n];this[n]=function(){return arguments[1]<a?this._fake.cells2.apply(this._fake,arguments):this._bfs_cells2.apply(this,arguments)};n="cells3";this._bfs_cells3=this[n];this[n]=function(b,c){if(arguments[1]<a&&this._fake.rowsAr[arguments[0].idd]){if(this._fake.rowsAr[b.idd]&&this._fake.rowsAr[b.idd].childNodes.length==0)return this._bfs_cells3.apply(this,arguments);arguments[0]=arguments[0].idd;return this._fake.cells.apply(this._fake,arguments)}else return this._bfs_cells3.apply(this,
arguments)};n="changeRowId";this._bfs_changeRowId=this[n];this[n]=function(){this._bfs_changeRowId.apply(this,arguments);this._fake.rowsAr[arguments[0]]&&this._fake.changeRowId.apply(this._fake,arguments)};this._fake.getRowById=function(a){var b=this.rowsAr[a];!b&&this._fake.rowsAr[a]&&(b=this._fake.getRowById(a));if(b){if(b.tagName!="TR"){for(var c=0;c<this.rowsBuffer.length;c++)if(this.rowsBuffer[c]&&this.rowsBuffer[c].idd==a)return this.render_row(c);if(this._h2)return this.render_row(null,b.idd)}return b}return null};
if(this.collapseKids)this._fake._bfs_collapseKids=this.collapseKids,this._fake.collapseKids=function(a){return this._fake.collapseKids.apply(this._fake,[this._fake.rowsAr[a.idd]])},this._bfs_collapseKids=this.collapseKids,this.collapseKids=function(){var a=this._bfs_collapseKids.apply(this,arguments);this._fake._h2syncModel();this._cssSP||this._fake._fixAlterCss()},this._fake._bfs_expandKids=this.expandKids,this._fake.expandKids=function(a){this._fake.expandKids.apply(this._fake,[this._fake.rowsAr[a.idd]]);
this._cssSP||this._fake._fixAlterCss()},this._bfs_expandAll=this.expandAll,this.expandAll=function(){this._bfs_expandAll();this._fake._h2syncModel();this._cssSP||this._fake._fixAlterCss()},this._bfs_collapseAll=this.collapseAll,this.collapseAll=function(){this._bfs_collapseAll();this._fake._h2syncModel();this._cssSP||this._fake._fixAlterCss()},this._bfs_expandKids=this.expandKids,this.expandKids=function(){var a=this._bfs_expandKids.apply(this,arguments);this._fake._h2syncModel();this._cssSP||this._fake._fixAlterCss()},
this._fake._h2syncModel=function(){this._fake.pagingOn?this._fake._renderSort():this._renderSort()},this._updateTGRState=function(a){return this._fake._updateTGRState(a)};if(this._elmnh)this._setRowHoverA=this._fake._setRowHoverA=this._setRowHover,this._unsetRowHoverA=this._fake._unsetRowHoverA=this._unsetRowHover,this._setRowHover=this._fake._setRowHover=function(){var a=this.grid;a._setRowHoverA.apply(this,arguments);var b=_isIE?event.srcElement:arguments[0].target;(b=a._fake.rowsAr[a.getFirstParentOfType(b,
"TD").parentNode.idd])&&a._fake._setRowHoverA.apply(a._fake.obj,[{target:b.childNodes[0]},arguments[1]])},this._unsetRowHover=this._fake._unsetRowHover=function(){var a=arguments[1]?this:this.grid;a._unsetRowHoverA.apply(this,arguments);a._fake._unsetRowHoverA.apply(a._fake.obj,arguments)},this._fake.enableRowsHover(!0,this._hvrCss),this.enableRowsHover(!1),this.enableRowsHover(!0,this._fake._hvrCss);this._updateTGRState=function(a){if(a.update&&a.id!=0){if(this.rowsAr[a.id].imgTag)this.rowsAr[a.id].imgTag.src=
this.imgURL+a.state+".gif";if(this._fake.rowsAr[a.id]&&this._fake.rowsAr[a.id].imgTag)this._fake.rowsAr[a.id].imgTag.src=this.imgURL+a.state+".gif";a.update=!1}};this.copy_row=function(b){var c=b.cloneNode(!0);c._skipInsert=b._skipInsert;var d=a;c._attrs={};c._css=b._css;if(this._ecspn)for(var e=d=0;d<c.childNodes.length&&e<a;e+=c.childNodes[d].colSpan||1)d++;for(;c.childNodes.length>d;)c.removeChild(c.childNodes[c.childNodes.length-1]);for(var f=d,e=0;e<f;e++)if(this.dragAndDropOff&&this.dragger.addDraggableItem(c.childNodes[e],
this),c.childNodes[e].style.display=this._fake._hrrar?this._fake._hrrar[e]?"none":"":"",c.childNodes[e]._cellIndex=e,c.childNodes[e].combo_value=b.childNodes[e].combo_value,c.childNodes[e]._clearCell=b.childNodes[e]._clearCell,c.childNodes[e]._cellType=b.childNodes[e]._cellType,c.childNodes[e]._brval=b.childNodes[e]._brval,c.childNodes[e]._attrs=b.childNodes[e]._attrs,c.childNodes[e].chstate=b.childNodes[e].chstate,b._attrs.style&&(c.childNodes[e].style.cssText+=";"+b._attrs.style),c.childNodes[e].colSpan>
1)this._childIndexes=this._fake._childIndexes;if(this._h2&&this._treeC<a){var g=this._h2.get[b.idd];c.imgTag=c.childNodes[this._treeC].childNodes[0].childNodes[g.level];c.valTag=c.childNodes[this._treeC].childNodes[0].childNodes[g.level+2]}c.idd=b.idd;c.grid=this._fake;return c};n="_insertRowAt";this._bfs_insertRowAt=this[n];this[n]=function(){var a=this._bfs_insertRowAt.apply(this,arguments);arguments[0]=this.copy_row(arguments[0]);var b=this._fake._insertRowAt.apply(this._fake,arguments);if(a._fhd)b.parentNode.removeChild(b),
this._fake.rowsCol._dhx_removeAt(this._fake.rowsCol._dhx_find(b)),a._fhd=!1;return a};this._bfs_setSizes=this.setSizes;this.setSizes=function(){if(!this._notresize)this._bfs_setSizes(this,arguments),this.sync_headers(),this.sync_scroll()&&this._ahgr&&this.setSizes(),this._fake.entBox.style.height=this.entBox.style.height,this._fake.objBox.style.height=this.objBox.style.height,this._fake.hdrBox.style.height=this.hdrBox.style.height,this._fake.objBox.scrollTop=this.objBox.scrollTop,this._fake.setColumnSizes(this._fake.entBox.clientWidth),
this.globalBox.style.width=parseInt(this.entBox.style.width)+parseInt(this._fake.entBox.style.width),this.globalBox.style.height=this.entBox.style.height};this.sync_scroll=this._fake.sync_scroll=function(a){var b=this.objBox.style.overflowX;if(this.obj.offsetWidth<=this.objBox.offsetWidth){if(!a)return this._fake.sync_scroll(!0);this.objBox.style.overflowX="hidden";this._fake.objBox.style.overflowX="hidden"}else this.objBox.style.overflowX="scroll",this._fake.objBox.style.overflowX="scroll";return b!=
this.objBox.style.overflowX};this.sync_headers=this._fake.sync_headers=function(){if(!(this.noHeader||this._fake.hdr.scrollHeight==this.hdr.offsetHeight))for(var b=1;b<this.hdr.rows.length;b++){var c=this.hdr.rows[b].scrollHeight,d=this._fake.hdr.rows[b].scrollHeight;if(c!=d)this._fake.hdr.rows[b].style.height=this.hdr.rows[b].style.height=Math.max(c,d)+"px";if(window._KHTMLrv)this._fake.hdr.rows[b].childNodes[0].style.height=this.hdr.rows[b].childNodes[a].style.height=Math.max(c,d)+"px"}};this._fake._bfs_setSizes=
this._fake.setSizes;this._fake.setSizes=function(){this._fake._notresize||this._fake.setSizes()};n="_doOnScroll";this._bfs__doOnScroll=this[n];this[n]=function(){this._bfs__doOnScroll.apply(this,arguments);this._fake.objBox.scrollTop=this.objBox.scrollTop;this._fake._doOnScroll.apply(this._fake,arguments)};n="selectAll";this._bfs__selectAll=this[n];this[n]=function(){this._bfs__selectAll.apply(this,arguments);this._bfs__selectAll.apply(this._fake,arguments)};n="doClick";this._bfs_doClick=this[n];
this[n]=function(){this._bfs_doClick.apply(this,arguments);if(arguments[0].tagName=="TD"){var b=arguments[0]._cellIndex>=a;if(arguments[0].parentNode.idd){if(!b)arguments[0].className=arguments[0].className.replace(/cellselected/g,"");this._fake.rowsAr[arguments[0].parentNode.idd]||this._fake.render_row(this.getRowIndex(arguments[0].parentNode.idd));arguments[0]=this._fake.cells(arguments[0].parentNode.idd,b?0:arguments[0]._cellIndex).cell;if(b)this._fake.cell=null;this._fake._bfs_doClick.apply(this._fake,
arguments);b?this._fake.cell=this.cell:this.cell=this._fake.cell;this._fake.onRowSelectTime&&clearTimeout(this._fake.onRowSelectTime);b?(arguments[0].className=arguments[0].className.replace(/cellselected/g,""),globalActiveDHTMLGridObject=this,this._fake.cell=this.cell):this.objBox.scrollTop=this._fake.objBox.scrollTop}}};this._fake._bfs_doClick=this._fake[n];this._fake[n]=function(){this._bfs_doClick.apply(this,arguments);if(arguments[0].tagName=="TD"){var b=arguments[0]._cellIndex<a;if(arguments[0].parentNode.idd&&
(arguments[0]=this._fake._bfs_cells(arguments[0].parentNode.idd,b?a:arguments[0]._cellIndex).cell,this._fake.cell=null,this._fake._bfs_doClick.apply(this._fake,arguments),this._fake.cell=this.cell,this._fake.onRowSelectTime&&clearTimeout(this._fake.onRowSelectTime),b))arguments[0].className=arguments[0].className.replace(/cellselected/g,""),globalActiveDHTMLGridObject=this,this._fake.cell=this.cell,this._fake.objBox.scrollTop=this.objBox.scrollTop}};this.clearSelectionA=this.clearSelection;this.clearSelection=
function(a){a&&this._fake.clearSelection();this.clearSelectionA()};this.moveRowUpA=this.moveRowUp;this.moveRowUp=function(a){this._h2||this._fake.moveRowUp(a);this.moveRowUpA(a);this._h2&&this._fake._h2syncModel()};this.moveRowDownA=this.moveRowDown;this.moveRowDown=function(a){this._h2||this._fake.moveRowDown(a);this.moveRowDownA(a);this._h2&&this._fake._h2syncModel()};this._fake.getUserData=function(){return this._fake.getUserData.apply(this._fake,arguments)};this._fake.setUserData=function(){return this._fake.setUserData.apply(this._fake,
arguments)};this.getSortingStateA=this.getSortingState;this.getSortingState=function(){var a=this.getSortingStateA();return a.length!=0?a:this._fake.getSortingState()};this.setSortImgStateA=this._fake.setSortImgStateA=this.setSortImgState;this.setSortImgState=function(b,c,d,e){this.setSortImgStateA(b,c,d,e);c*1<a?(this._fake.setSortImgStateA(b,c,d,e),this.setSortImgStateA(!1)):this._fake.setSortImgStateA(!1)};this._fake.doColResizeA=this._fake.doColResize;this._fake.doColResize=function(b,c,d,e,f){var g=
-1,h=0;if(arguments[1]._cellIndex==a-1){g=this._initalSplR+(b.clientX-e);if(!this._initalSplF)this._initalSplF=arguments[3]+this.objBox.scrollWidth-this.objBox.offsetWidth;if(this.objBox.scrollWidth==this.objBox.offsetWidth&&(this._fake.alter_split_resize||b.clientX-e>0))arguments[3]=this._initalSplF||arguments[3]}else if(this.obj.offsetWidth<this.entBox.offsetWidth)g=this.obj.offsetWidth;h=this.doColResizeA.apply(this,arguments);this._correctSplit(g);this.resized=this._fake.resized=1;return h};this._fake.changeCursorState=
function(a){var b=a.target||a.srcElement;b.tagName!="TD"&&(b=this.getFirstParentOfType(b,"TD"));if(!(b.tagName=="TD"&&this._drsclmn&&!this._drsclmn[b._cellIndex])){var c=(a.layerX||0)+(!_isIE&&a.target.tagName=="DIV"?b.offsetLeft:0),d=parseInt(this.getPosition(b,this.hdrBox));b.style.cursor=b.offsetWidth-(a.offsetX||(d-c)*-1)<(_isOpera?20:10)||this.entBox.offsetWidth-(a.offsetX?a.offsetX+b.offsetLeft:c)+this.objBox.scrollLeft-0<(_isOpera?20:10)?"E-resize":"default";if(_isOpera)this.hdrBox.scrollLeft=
this.objBox.scrollLeft}};this._fake.startColResizeA=this._fake.startColResize;this._fake.startColResize=function(a){var b=this.startColResizeA(a);this._initalSplR=this.entBox.offsetWidth;this._initalSplF=null;if(this.entBox.onmousemove){var c=this.entBox.parentNode;if(c._aggrid)return b;c._aggrid=c.grid;c.grid=this;this.entBox.parentNode.onmousemove=this.entBox.onmousemove;this.entBox.onmousemove=null}return b};this._fake.stopColResizeA=this._fake.stopColResize;this._fake.stopColResize=function(a){if(this.entBox.parentNode.onmousemove){var b=
this.entBox.parentNode;b.grid=b._aggrid;b._aggrid=null;this.entBox.onmousemove=this.entBox.parentNode.onmousemove;this.entBox.parentNode.onmousemove=null;this.obj.offsetWidth<this.entBox.offsetWidth&&this._correctSplit(this.obj.offsetWidth)}return this.stopColResizeA(a)};this.doKeyA=this.doKey;this._fake.doKeyA=this._fake.doKey;this._fake.doKey=this.doKey=function(b){if(!b)return!0;if(this._htkebl)return!0;if((b.target||b.srcElement).value!==window.undefined){var c=b.target||b.srcElement;if(!c.parentNode||
c.parentNode.className.indexOf("editable")==-1)return!0}switch(b.keyCode){case 9:if(b.shiftKey)if(this._realfake){if(this.cell&&this.cell._cellIndex==0){b.preventDefault&&b.preventDefault();if(e=this._fake.rowsBuffer[this._fake.getRowIndex(this.cell.parentNode.idd)-1]){this._fake.showRow(e.idd);for(d=this._fake._cCount-1;e.childNodes[d].style.display=="none";)d--;this._fake.selectCell(this._fake.getRowIndex(e.idd),d,!1,!1,!0)}return!1}}else{if(this.cell&&this.cell._cellIndex==a)return b.preventDefault&&
b.preventDefault(),this._fake.selectCell(this.getRowIndex(this.cell.parentNode.idd),a-1,!1,!1,!0),!1}else if(this._realfake){if(this.cell&&this.cell._cellIndex==a-1){b.preventDefault&&b.preventDefault();for(var d=a;this._fake._hrrar&&this._fake._hrrar[d];)d++;this._fake.selectCell(this._fake.getRowIndex(this.cell.parentNode.idd),d,!1,!1,!0);return!1}else var e=this.doKeyA(b);globalActiveDHTMLGridObject=this;return e}else if(this.cell){for(d=this.cell._cellIndex+1;this.rowsCol[0].childNodes[d]&&this.rowsCol[0].childNodes[d].style.display==
"none";)d++;if(d==this.rowsCol[0].childNodes.length&&(b.preventDefault&&b.preventDefault(),e=this.rowsBuffer[this.getRowIndex(this.cell.parentNode.idd)+1]))return this.showRow(e.idd),this._fake.selectCell(this._fake.getRowIndex(e.idd),0,!1,!1,!0),!1}}return this.doKeyA(b)};this.editCellA=this.editCell;this.editCell=function(){return this.cell&&this.cell.parentNode.grid!=this?this._fake.editCell():this.editCellA()};this.deleteRowA=this.deleteRow;this.deleteRow=function(a,b){if(this.deleteRowA(a,b)===
!1)return!1;this._fake.rowsAr[a]&&this._fake.deleteRow(a)};this.clearAllA=this.clearAll;this.clearAll=function(){this.clearAllA();this._fake.clearAll()};this.editStopA=this.editStop;this.editStop=function(){this._fake.editor?this._fake.editStop():this.editStopA()};this.attachEvent("onAfterSorting",function(b){b>=a&&this._fake.setSortImgState(!1)});this._fake.sortField=function(a,b){this._fake.sortField.call(this._fake,a,b,this._fake.hdr.rows[0].cells[a]);if(this.fldSort[a]!="na"&&this._fake.fldSorted){var c=
this._fake.getSortingState()[1];this._fake.setSortImgState(!1);this.setSortImgState(!0,a,c)}};this.sortTreeRowsA=this.sortTreeRows;this._fake.sortTreeRowsA=this._fake.sortTreeRows;this.sortTreeRows=this._fake.sortTreeRows=function(a,b,c,d){if(this._realfake)return this._fake.sortTreeRows(a,b,c,d);this.sortTreeRowsA(a,b,c,d);this._fake._h2syncModel();this._fake.setSortImgStateA(!1);this._fake.fldSorted=null};this._fake._fillers=[];this._fake.rowsBuffer=this.rowsBuffer;this.attachEvent("onClearAll",
function(){this._fake.rowsBuffer=this.rowsBuffer});this._add_filler_s=this._add_filler;this._add_filler=function(a,b,c,d){if(!d){if(!this._fake._fillers)this._fake._fillers=[];var e;if(c)if(c.idd)e=this._fake.rowsAr[c.idd];else if(c.nextSibling)e={},e.nextSibling=this._fake.rowsAr[c.nextSibling.idd],e.parentNode=e.nextSibling.parentNode;this._fake._fillers.push(this._fake._add_filler(a,b,e))}return this._add_filler_s.apply(this,arguments)};this._add_from_buffer_s=this._add_from_buffer;this._add_from_buffer=
function(){var a=this._add_from_buffer_s.apply(this,arguments);a!=-1&&(this._fake._add_from_buffer.apply(this._fake,arguments),this.multiLine&&this._correctRowHeight(this.rowsBuffer[arguments[0]].idd));return a};this._fake.render_row=function(a){var b=this._fake.render_row(a);return b==-1?-1:b?this.rowsAr[b.idd]=this.rowsAr[b.idd]||this._fake.copy_row(b):null};this._reset_view_s=this._reset_view;this._reset_view=function(){this._fake._reset_view(!0);this._fake._fillers=[];this._reset_view_s()};this.moveColumn_s=
this.moveColumn;this.moveColumn=function(b,c){if(c>=a)return this.moveColumn_s(b,c)};this.attachEvent("onCellChanged",function(b,c,d){if(this._split_event&&c<a&&this.rowsAr[b]){var e=this._fake.rowsAr[b];if(e){var e=e._childIndexes?e.childNodes[e._childIndexes[c]]:e.childNodes[c],f=this.rowsAr[b].childNodes[c];f._treeCell&&f.firstChild.lastChild?f.firstChild.lastChild.innerHTML=d:f.innerHTML=e.innerHTML;f._clearCell=!1;f.chstate=e.chstate}}});this._fake.combos=this.combos;this.setSizes();this.rowsBuffer[0]&&
this._reset_view();this.attachEvent("onXLE",function(){this._fake._correctSplit()});this._fake._correctSplit()};
dhtmlXGridObject.prototype._correctSplit=function(a){a=a||this.obj.scrollWidth-this.objBox.scrollLeft;a=Math.min(this.globalBox.offsetWidth,a);if(a>-1){this.entBox.style.width=a+"px";this.objBox.style.width=a+"px";var c=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/2;this._fake.entBox.style.left=a+"px";this._fake.entBox.style.width=Math.max(0,this.globalBox.offsetWidth-a-(this.quirks?0:2)*c)+"px";if(this._fake.ftr)this._fake.ftr.parentNode.style.width=this._fake.entBox.style.width;if(_isIE){var b=
_isIE&&!window.xmlHttpRequest,c=this.globalBox.offsetWidth-this.globalBox.clientWidth;this._fake.hdrBox.style.width=this._fake.objBox.style.width=Math.max(0,this.globalBox.offsetWidth-(b?c:0)-a)+"px"}}};
dhtmlXGridObject.prototype._correctRowHeight=function(a){if(this.rowsAr[a]&&this._fake.rowsAr[a]){var c=this.rowsAr[a].offsetHeight,b=this._fake.rowsAr[a].offsetHeight,d=Math.max(c,b);if(d&&(this.rowsAr[a].style.height=this._fake.rowsAr[a].style.height=d+"px",window._KHTMLrv))this.rowsAr[a].childNodes[this._fake._cCount].style.height=this._fake.rowsAr[a].firstChild.style.height=d+"px"}};
function eXcell_dhxCalendar(a){if(a&&(this.cell=a,this.grid=this.cell.parentNode.grid,!this.grid._grid_calendarA)){var c=this.grid._grid_calendarA=new dhtmlxCalendarObject;this.grid.callEvent("onDhxCalendarCreated",[c]);var b=this.grid;c.attachEvent("onClick",function(){this._last_operation_calendar=!0;window.setTimeout(function(){b.editStop()},1);return!0});var d=function(a){(a||event).cancelBubble=!0};dhtmlxEvent(c.base,"click",d);c=null}}eXcell_dhxCalendar.prototype=new eXcell;
eXcell_dhxCalendar.prototype.edit=function(){var a=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(!1,!1);this.grid._grid_calendarA.setPosition(a[0],a[1]+this.cell.offsetHeight);this.grid._grid_calendarA._last_operation_calendar=!1;this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]);this.cell._cediton=!0;this.val=this.cell.val;this._val=this.cell.innerHTML;var c=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=
function(){};this.grid._grid_calendarA.setDateFormat(this.grid._dtmask||"%d/%m/%Y");this.grid._grid_calendarA.setDate(this.val||new Date);this.grid._grid_calendarA.draw=c};eXcell_dhxCalendar.prototype.getDate=function(){return this.cell.val?this.cell.val:null};eXcell_dhxCalendar.prototype.getValue=function(){return this.cell._clearCell?"":this.grid._dtmask_inc&&this.cell.val?this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString():this.cell.innerHTML.toString()._dhx_trim()};
eXcell_dhxCalendar.prototype.detach=function(){if(this.grid._grid_calendarA&&(this.grid._grid_calendarA.hide(),this.cell._cediton)){this.cell._cediton=!1;if(this.grid._grid_calendarA._last_operation_calendar){var a=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y"),c=this.grid._grid_calendarA.getDate();this.cell.val=new Date(c);this.setCValue(a,c);this.cell._clearCell=!a;var b=this.val;this.val=this._val;return this.cell.val.valueOf()!=b}return!1}};
eXcell_dhxCalendar.prototype.setValue=function(a){typeof a=="object"?(this.cell.val=a,this.cell._clearCell=!1,this.setCValue(this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",a).toString(),this.cell.val)):(!a||a.toString()._dhx_trim()==""?(a="&nbsp",this.cell._clearCell=!0,this.cell.val=""):(this.cell._clearCell=!1,this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate(this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y",a.toString(),null,!0)),this.grid._dtmask_inc&&
(a=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",this.cell.val))),this.cell.val=="NaN"||this.cell.val=="Invalid Date"?(this.cell._clearCell=!0,this.cell.val=new Date,this.setCValue("&nbsp;",0)):this.setCValue((a||"").toString(),this.cell.val))};
function eXcell_dhxCalendarA(a){if(a&&(this.cell=a,this.grid=this.cell.parentNode.grid,!this.grid._grid_calendarA)){var c=this.grid._grid_calendarA=new dhtmlxCalendarObject(!1,!1,{isYearEditable:!0});this.grid.callEvent("onDhxCalendarCreated",[c]);var b=this.grid;c.attachEvent("onClick",function(){this._last_operation_calendar=!0;window.setTimeout(function(){b.editStop()},1);return!0});var d=function(a){(a||event).cancelBubble=!0};dhtmlxEvent(c.base,"click",d)}}eXcell_dhxCalendarA.prototype=new eXcell;
eXcell_dhxCalendarA.prototype.edit=function(){var a=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(!1,!1);this.grid._grid_calendarA.setPosition(a[0]*1+this.cell.offsetWidth,a[1]*1);this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid._grid_calendarA._last_operation_calendar=!1;this.cell._cediton=!0;this.val=this.cell.val;this._val=this.cell.innerHTML;var c=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=
function(){};this.grid._grid_calendarA.setDateFormat(this.grid._dtmask||"%d/%m/%Y");this.grid._grid_calendarA.setDate(this.val);this.grid._grid_calendarA.draw=c;this.grid._grid_calendarA.draw();this.cell.atag=!this.grid.multiLine&&(_isKHTML||_isMacOS||_isFF)?"INPUT":"TEXTAREA";this.obj=document.createElement(this.cell.atag);this.obj.style.height=this.cell.offsetHeight-(_isIE?4:2)+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.align;this.obj.onclick=
function(a){(a||event).cancelBubble=!0};this.obj.onmousedown=function(a){(a||event).cancelBubble=!0};this.obj.value=this.getValue();this.cell.innerHTML="";this.cell.appendChild(this.obj);if(_isFF&&(this.obj.style.overflow="visible",this.grid.multiLine&&this.obj.offsetHeight>=18&&this.obj.offsetHeight<40))this.obj.style.height="36px",this.obj.style.overflow="scroll";this.obj.onselectstart=function(a){a||(a=event);return a.cancelBubble=!0};this.obj.focus();this.obj.focus()};
eXcell_dhxCalendarA.prototype.getDate=function(){return this.cell.val?this.cell.val:null};eXcell_dhxCalendarA.prototype.getValue=function(){return this.cell._clearCell?"":this.grid._dtmask_inc&&this.cell.val?this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString():this.cell.innerHTML.toString()._dhx_trim()};
eXcell_dhxCalendarA.prototype.detach=function(){if(this.grid._grid_calendarA&&(this.grid._grid_calendarA.hide(),this.cell._cediton)){this.cell._cediton=!1;if(this.grid._grid_calendarA._last_operation_calendar){this.grid._grid_calendarA._last_operation_calendar=!1;var a=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y"),c=this.grid._grid_calendarA.getDate();this.cell.val=new Date(c);this.setCValue(a,c);this.cell._clearCell=!a;var b=this.val;this.val=this._val;return this.cell.val.valueOf()!=
(b|0).valueOf()}this.setValue(this.obj.value);b=this.val;this.val=this._val;return this.cell.val.valueOf()!=(b||"").valueOf()}};
eXcell_dhxCalendarA.prototype.setValue=function(a){typeof a=="object"?(this.cell.val=a,this.cell._clearCell=!1,this.setCValue(this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",a).toString(),this.cell.val)):(!a||a.toString()._dhx_trim()==""?(a="&nbsp",this.cell._clearCell=!0,this.cell.val=""):(this.cell._clearCell=!1,this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate(this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y",a.toString(),null,!0)),this.grid._dtmask_inc&&
(a=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",this.cell.val))),this.cell.val=="NaN"||this.cell.val=="Invalid Date"?(this.cell.val=new Date,this.cell._clearCell=!0,this.setCValue("&nbsp;",0)):this.setCValue((a||"").toString(),this.cell.val))};
function eXcell_cntr(a){this.cell=a;this.grid=this.cell.parentNode.grid;if(!this.grid._ex_cntr_ready&&!this._realfake)this.grid._ex_cntr_ready=!0,this.grid._h2&&this.grid.attachEvent("onOpenEn",function(){this.resetCounter(a._cellIndex)}),this.grid.attachEvent("onBeforeSorting",function(){var c=this;window.setTimeout(function(){c.resetCounter&&(c._fake&&!c._realfake&&a._cellIndex<c._fake._cCount?c._fake.resetCounter(a._cellIndex):c.resetCounter(a._cellIndex))},1);return!0});this.edit=function(){};
this.getValue=function(){return this.cell.innerHTML};this.setValue=function(){this.cell.style.paddingRight="2px";var a=this.cell;window.setTimeout(function(){if(a.parentNode){var b=a.parentNode.rowIndex;if(a.parentNode.grid.currentPage||b<0||a.parentNode.grid._srnd)b=a.parentNode.grid.rowsBuffer._dhx_find(a.parentNode)+1;if(!(b<=0))a.innerHTML=b,a.parentNode.grid._fake&&a._cellIndex<a.parentNode.grid._fake._cCount&&a.parentNode.grid._fake.rowsAr[a.parentNode.idd]&&a.parentNode.grid._fake.cells(a.parentNode.idd,
a._cellIndex).setCValue(b),a=null}},100)}}dhtmlXGridObject.prototype.resetCounter=function(a){this._fake&&!this._realfake&&a<this._fake._cCount&&this._fake.resetCounter(a,this.currentPage);var c=a||0;this.currentPage&&(c=(this.currentPage-1)*this.rowsBufferOutSize);for(c=0;c<this.rowsBuffer.length;c++)if(this.rowsBuffer[c]&&this.rowsBuffer[c].tagName=="TR"&&this.rowsAr[this.rowsBuffer[c].idd])this.rowsAr[this.rowsBuffer[c].idd].childNodes[a].innerHTML=c+1};eXcell_cntr.prototype=new eXcell;
function eXcell_link(a){this.cell=a;this.grid=this.cell.parentNode.grid;this.isDisabled=function(){return!0};this.edit=function(){};this.getValue=function(){return this.cell.firstChild.getAttribute?this.cell.firstChild.innerHTML+"^"+this.cell.firstChild.getAttribute("href"):""};this.setValue=function(a){if(typeof a!="number"&&(!a||a.toString()._dhx_trim()==""))return this.setCValue("&nbsp;",b),this.cell._clearCell=!0;var b=a.split("^");b.length==1?b[1]="":b.length>1&&(b[1]="href='"+b[1]+"'",b[1]+=
b.length==3?" target='"+b[2]+"'":" target='_blank'");this.setCValue("<a "+b[1]+" onclick='(_isIE?event:arguments[0]).cancelBubble = true;'>"+b[0]+"</a>",b)}}eXcell_link.prototype=new eXcell;eXcell_link.prototype.getTitle=function(){var a=this.cell.firstChild;return a&&a.tagName?a.getAttribute("href"):""};eXcell_link.prototype.getContent=function(){var a=this.cell.firstChild;return a&&a.tagName?a.innerHTML:""};
function eXcell_clist(a){try{this.cell=a,this.grid=this.cell.parentNode.grid}catch(c){}this.edit=function(){this.val=this.getValue();var a=this.cell._combo||this.grid.clists[this.cell._cellIndex];if(a){this.obj=document.createElement("DIV");for(var c=this.val.split(","),e="",h=0;h<a.length;h++){for(var g=!1,f=0;f<c.length;f++)a[h]==c[f]&&(g=!0);e+=g?"<div><input type='checkbox' checked='true' /><label>"+a[h]+"</label></div>":"<div><input type='checkbox' id='ch_lst_"+h+"'/><label>"+a[h]+"</label></div>"}e+=
"<div><input type='button' value='Apply' style='width:100px; font-size:8pt;' onclick='this.parentNode.parentNode.editor.grid.editStop();'/></div>";this.obj.editor=this;this.obj.innerHTML=e;document.body.appendChild(this.obj);this.obj.style.position="absolute";this.obj.className="dhx_clist";this.obj.onclick=function(a){return(a||event).cancelBubble=!0};var i=this.grid.getPosition(this.cell);this.obj.style.left=i[0]+"px";this.obj.style.top=i[1]+this.cell.offsetHeight+"px";this.obj.getValue=function(){for(var a=
"",b=0;b<this.childNodes.length-1;b++)this.childNodes[b].childNodes[0].checked&&(a&&(a+=","),a+=this.childNodes[b].childNodes[1].innerHTML);return a}}};this.getValue=function(){return this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()};this.detach=function(){if(this.obj)this.setValue(this.obj.getValue()),this.obj.editor=null,this.obj.parentNode.removeChild(this.obj),this.obj=null;return this.val!=this.getValue()}}eXcell_clist.prototype=new eXcell;
eXcell_clist.prototype.setValue=function(a){if(typeof a=="object"){var c=this.grid.xmlLoader.doXPath("./option",a);if(c.length)this.cell._combo=[];for(var b=0;b<c.length;b++)this.cell._combo.push(c[b].firstChild?c[b].firstChild.data:"");a=a.firstChild.data}a===""||a===this.undefined?(this.setCTxtValue(" ",a),this.cell._clearCell=!0):(this.setCValue(a),this.cell._clearCell=!1)};
dhtmlXGridObject.prototype.registerCList=function(a,c){if(!this.clists)this.clists=[];typeof c!="object"&&(c=c.split(","));this.clists[a]=c};
function dhtmlXToolbarObject(a,c){var b=this;for(this.cont=typeof a!="object"?document.getElementById(a):a;this.cont.childNodes.length>0;)this.cont.removeChild(this.cont.childNodes[0]);this.cont.dir="ltr";this.cont.innerHTML+="<div class='dhxtoolbar_hdrline_ll'></div><div class='dhxtoolbar_hdrline_rr'></div><div class='dhxtoolbar_hdrline_l'></div><div class='dhxtoolbar_hdrline_r'></div>";this.base=document.createElement("DIV");this.base.className="float_left";this.cont.appendChild(this.base);this.align=
"left";this.setAlign=function(a){this.align=a=="right"?"right":"left";this.base.className=a=="right"?"float_right":"float_left";if(this._spacer)this._spacer.className="dhxtoolbar_spacer "+(a=="right"?" float_left":" float_right")};this._isIE6=!1;if(_isIE)this._isIE6=window.XMLHttpRequest==null?!0:!1;if(this._isIPad=navigator.userAgent.search(/iPad/gi)>=0)this.cont.ontouchstart=function(a){a=a||event;a.returnValue=!1;a.cancelBubble=!0;return!1};this.selectPolygonOffsetLeft=this.selectPolygonOffsetTop=
0;this.setSkin=function(a){this.skin=a;if(this.skin=="dhx_skyblue")this.selectPolygonOffsetTop=2;if(this.skin=="dhx_web")this.selectPolygonOffsetLeft=this.selectPolygonOffsetTop=1;this.cont.className="dhx_toolbar_base_"+this.skin+(this.rtl?" rtl":"");for(var b in this.objPull){var c=this.objPull[b];if(c.type=="slider")c.pen._detectLimits(),c.pen._definePos(),c.label.className="dhx_toolbar_slider_label_"+this.skin+(this.rtl?" rtl":"");if(c.type=="buttonSelect")c.polygon.className="dhx_toolbar_poly_"+
this.skin+(this.rtl?" rtl":"")}};this.setSkin(c==null?"dhx_skyblue":c);this.objPull={};this.anyUsed="none";this.imagePath="";this.setIconPath=this.setIconsPath=function(a){this.imagePath=a};this._doOnLoad=function(){};this.loadXML=function(a,b){if(b!=null)this._doOnLoad=function(){b()};this.callEvent("onXLS",[]);this._xmlLoader=new dtmlXMLLoaderObject(this._xmlParser,window);this._xmlLoader.loadXML(a)};this.loadXMLString=function(a,b){if(b!=null)this._doOnLoad=function(){b()};this._xmlLoader=new dtmlXMLLoaderObject(this._xmlParser,
window);this._xmlLoader.loadXMLString(a)};this._xmlParser=function(){for(var a=this.getXMLTopNode("toolbar"),c="id,type,hidden,title,text,enabled,img,imgdis,action,openAll,renderSelect,maxOpen,width,value,selected,length,textMin,textMax,toolTip,valueMin,valueMax,valueNow".split(","),h="id,type,enabled,disabled,action,selected,img,text".split(","),g=0;g<a.childNodes.length;g++)if(a.childNodes[g].tagName=="item"){for(var f={},i=0;i<c.length;i++)f[c[i]]=a.childNodes[g].getAttribute(c[i]);f.items=[];
f.userdata=[];for(var j=0;j<a.childNodes[g].childNodes.length;j++){if(a.childNodes[g].childNodes[j].tagName=="item"&&f.type=="buttonSelect"){for(var k={},i=0;i<h.length;i++)k[h[i]]=a.childNodes[g].childNodes[j].getAttribute(h[i]);try{k.itemText=a.childNodes[g].childNodes[j].getElementsByTagName("itemText")[0].firstChild.nodeValue}catch(l){}for(var m=a.childNodes[g].childNodes[j].getElementsByTagName("userdata"),i=0;i<m.length;i++){if(!k.userdata)k.userdata={};var o={};try{o.name=m[i].getAttribute("name")}catch(n){o.name=
""}try{o.value=m[i].firstChild.nodeValue}catch(p){o.value=""}if(o.name!="")k.userdata[o.name]=o.value}f.items[f.items.length]=k}if(a.childNodes[g].childNodes[j].tagName=="userdata"){k={};try{k.name=a.childNodes[g].childNodes[j].getAttribute("name")}catch(r){k.name=""}try{k.value=a.childNodes[g].childNodes[j].firstChild.nodeValue}catch(t){k.value=""}f.userdata[f.userdata.length]=k}}b._addItemToStorage(f)}b.callEvent("onXLE",[]);b._doOnLoad();this.destructor()};this._addItemToStorage=function(a,b){var c=
a.id||this._genStr(24),g=a.type||"";if(g!=""&&this["_"+g+"Object"]!=null)this.objPull[this.idPrefix+c]=new this["_"+g+"Object"](this,c,a),this.objPull[this.idPrefix+c].type=g,this.setPosition(c,b);if(a.userdata)for(var f=0;f<a.userdata.length;f++)this.setUserData(c,a.userdata[f].name,a.userdata[f].value)};this._genStr=function(a){for(var b="",c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",g=0;g<a;g++)b+=c.charAt(Math.round(Math.random()*(c.length-1)));return b};this.rootTypes=
"button,buttonSelect,buttonTwoState,separator,label,slider,text,buttonInput".split(",");this.idPrefix=this._genStr(12);dhtmlxEventable(this);this._getObj=function(a,b){for(var c=null,g=0;g<a.childNodes.length;g++)a.childNodes[g].tagName!=null&&String(a.childNodes[g].tagName).toLowerCase()==String(b).toLowerCase()&&(c=a.childNodes[g]);return c};this._addImgObj=function(a){var b=document.createElement("IMG");a.childNodes.length>0?a.insertBefore(b,a.childNodes[0]):a.appendChild(b);return b};this._setItemImage=
function(a,b,c){c==!0?a.imgEn=b:a.imgDis=b;if(!(!a.state&&c==!0||a.state&&c==!1)){var g=this._getObj(a.obj,"img");g==null&&(g=this._addImgObj(a.obj));g.src=this.imagePath+b}};this._clearItemImage=function(a,b){b==!0?a.imgEn="":a.imgDis="";if(!(!a.state&&b==!0||a.state&&b==!1)){var c=this._getObj(a.obj,"img");c!=null&&c.parentNode.removeChild(c)}};this._setItemText=function(a,b){var c=this._getObj(a.obj,"div");b==null||b.length==0?c!=null&&c.parentNode.removeChild(c):(c==null&&(c=document.createElement("DIV"),
a.obj.appendChild(c)),c.innerHTML=b)};this._getItemText=function(a){var b=this._getObj(a.obj,"div");return b!=null?b.innerHTML:""};this._enableItem=function(a){if(!a.state){a.state=!0;this.objPull[a.id].type=="buttonTwoState"&&this.objPull[a.id].obj.pressed==!0?(a.obj.className="dhx_toolbar_btn pres",a.obj.renderAs="dhx_toolbar_btn over"):(a.obj.className="dhx_toolbar_btn def",a.obj.renderAs=a.obj.className);if(a.arw)a.arw.className=String(a.obj.className).replace("btn","arw");var b=this._getObj(a.obj,
"img");a.imgEn!=""?(b==null&&(b=this._addImgObj(a.obj)),b.src=this.imagePath+a.imgEn):b!=null&&b.parentNode.removeChild(b)}};this._disableItem=function(a){if(a.state){a.state=!1;a.obj.className="dhx_toolbar_btn dis";a.obj.renderAs="dhx_toolbar_btn def";if(a.arw)a.arw.className=String(a.obj.className).replace("btn","arw");var b=this._getObj(a.obj,"img");a.imgDis!=""?(b==null&&(b=this._addImgObj(a.obj)),b.src=this.imagePath+a.imgDis):b!=null&&b.parentNode.removeChild(b);if(a.polygon!=null&&a.polygon.style.display!=
"none"&&(a.polygon.style.display="none",a.polygon._ie6cover))a.polygon._ie6cover.style.display="none";this.anyUsed="none"}};this.clearAll=function(){for(var a in this.objPull)this._removeItem(String(a).replace(this.idPrefix,""))};this._isWebToolbar=!0;this._doOnClick=function(){b.forEachItem(function(a){if(b.objPull[b.idPrefix+a].type=="buttonSelect"){var c=b.objPull[b.idPrefix+a];if(c.polygon.style.display!="none"&&(c.obj.renderAs="dhx_toolbar_btn def",c.obj.className=c.obj.renderAs,c.arw.className=
String(c.obj.renderAs).replace("btn","arw"),b.anyUsed="none",c.polygon.style.display="none",c.polygon._ie6cover))c.polygon._ie6cover.style.display="none"}})};this._isIPad?document.addEventListener("touchstart",this._doOnClick,!1):_isIE?document.body.attachEvent("onclick",this._doOnClick):window.addEventListener("click",this._doOnClick,!1);return this}
dhtmlXToolbarObject.prototype.addSpacer=function(a){var c=this.idPrefix+a;if(this._spacer!=null){if(this._spacer.idd!=a)if(this._spacer==this.objPull[c].obj.parentNode){for(var b=!0;b;){var d=this._spacer.childNodes[0].idd;this.base.appendChild(this._spacer.childNodes[0]);if(d==a||this._spacer.childNodes.length==0)this.objPull[c].arw!=null&&this.base.appendChild(this.objPull[c].arw),b=!1}this._spacer.idd=a}else if(this.base==this.objPull[c].obj.parentNode){for(var b=!0,e=this.objPull[c].arw!=null;b;){var h=
this.base.childNodes.length-1;e==!0&&this.base.childNodes[h]==this.objPull[c].arw&&(b=!1);this.base.childNodes[h].idd==a&&(b=!1);b&&(this._spacer.childNodes.length>0?this._spacer.insertBefore(this.base.childNodes[h],this._spacer.childNodes[0]):this._spacer.appendChild(this.base.childNodes[h]))}this._spacer.idd=a}}else{for(var g=null,h=0;h<this.base.childNodes.length;h++)this.base.childNodes[h]==this.objPull[this.idPrefix+a].obj&&(g=h,this.objPull[this.idPrefix+a].arw!=null&&(g=h+1));if(g!=null){this._spacer=
document.createElement("DIV");this._spacer.className="dhxtoolbar_spacer "+(this.align=="right"?" float_left":" float_right");this._spacer.dir="rtl";for(this._spacer.idd=a;this.base.childNodes.length>g+1;)this._spacer.appendChild(this.base.childNodes[g+1]);this.cont.appendChild(this._spacer)}}};
dhtmlXToolbarObject.prototype.removeSpacer=function(){if(this._spacer){for(;this._spacer.childNodes.length>0;)this.base.appendChild(this._spacer.childNodes[0]);this._spacer.parentNode.removeChild(this._spacer);this._spacer=null}};
dhtmlXToolbarObject.prototype.getType=function(a){var c=this.getParentId(a);if(c!=null){var b=null,d=this.objPull[this.idPrefix+c]._listOptions[a];d!=null&&(b=d.sep!=null?"buttonSelectSeparator":"buttonSelectButton");return b}else return this.objPull[this.idPrefix+a]==null?null:this.objPull[this.idPrefix+a].type};dhtmlXToolbarObject.prototype.getTypeExt=function(a){var c=this.getType(a);return c=="buttonSelectButton"||c=="buttonSelectSeparator"?c=c=="buttonSelectButton"?"button":"separator":null};
dhtmlXToolbarObject.prototype.inArray=function(a,c){for(var b=0;b<a.length;b++)if(a[b]==c)return!0;return!1};dhtmlXToolbarObject.prototype.getParentId=function(a){var c=null,b;for(b in this.objPull)if(this.objPull[b]._listOptions)for(var d in this.objPull[b]._listOptions)d==a&&(c=String(b).replace(this.idPrefix,""));return c};dhtmlXToolbarObject.prototype._addItem=function(a,c){this._addItemToStorage(a,c)};
dhtmlXToolbarObject.prototype.addButton=function(a,c,b,d,e){this._addItem({id:a,type:"button",text:b,img:d,imgdis:e},c)};dhtmlXToolbarObject.prototype.addText=function(a,c,b){this._addItem({id:a,type:"text",text:b},c)};
dhtmlXToolbarObject.prototype.addButtonSelect=function(a,c,b,d,e,h,g,f,i){for(var j=[],k=0;k<d.length;k++){var l={};d[k].id&&d[k].type?(l.id=d[k].id,l.type=d[k].type=="obj"?"button":"separator",l.text=d[k].text,l.img=d[k].img):(l.id=d[k][0],l.type=d[k][1]=="obj"?"button":"separator",l.text=d[k][2]||null,l.img=d[k][3]||null);j[j.length]=l}this._addItem({id:a,type:"buttonSelect",text:b,img:e,imgdis:h,renderSelect:g,openAll:f,items:j,maxOpen:i},c)};
dhtmlXToolbarObject.prototype.addSeparator=function(a,c){this._addItem({id:a,type:"separator"},c)};dhtmlXToolbarObject.prototype.addInput=function(a,c,b,d){this._addItem({id:a,type:"buttonInput",value:b,width:d},c)};dhtmlXToolbarObject.prototype.forEachItem=function(a){for(var c in this.objPull)this.inArray(this.rootTypes,this.objPull[c].type)&&a(this.objPull[c].id.replace(this.idPrefix,""))};
(function(){for(var a="showItem,hideItem,isVisible,enableItem,disableItem,isEnabled,setItemText,getItemText,setItemToolTip,getItemToolTip,setItemImage,setItemImageDis,clearItemImage,clearItemImageDis,setItemState,getItemState,setItemToolTipTemplate,getItemToolTipTemplate,setValue,getValue,setMinValue,getMinValue,setMaxValue,getMaxValue,setWidth,getWidth,setMaxOpen".split(","),c=["","",!1,"","",!1,"","","","","","","","","",!1,"","","",null,"",[null,null],"",[null,null],"",null],b=function(a,b){return function(c,
d,e){c=this.idPrefix+c;return this.objPull[c][a]!=null?this.objPull[c][a].call(this.objPull[c],d,e):b}},d=0;d<a.length;d++){var e=a[d],h=c[d];dhtmlXToolbarObject.prototype[e]=b(e,h)}})();dhtmlXToolbarObject.prototype.getPosition=function(a){return this._getPosition(a)};
dhtmlXToolbarObject.prototype._getPosition=function(a){if(this.objPull[this.idPrefix+a]==null)return null;for(var c=null,b=0,d=0;d<this.base.childNodes.length;d++)this.base.childNodes[d].idd!=null&&(this.base.childNodes[d].idd==a&&(c=b),b++);if(!c&&this._spacer!=null)for(d=0;d<this._spacer.childNodes.length;d++)this._spacer.childNodes[d].idd!=null&&(this._spacer.childNodes[d].idd==a&&(c=b),b++);return c};dhtmlXToolbarObject.prototype.setPosition=function(a,c){this._setPosition(a,c)};
dhtmlXToolbarObject.prototype._setPosition=function(a,c){if(this.objPull[this.idPrefix+a]!=null){if(isNaN(c))c=this.base.childNodes.length;c<0&&(c=0);var b=null;if(this._spacer)b=this._spacer.idd,this.removeSpacer();var d=this.objPull[this.idPrefix+a];this.base.removeChild(d.obj);d.arw&&this.base.removeChild(d.arw);var e=this._getIdByPosition(c,!0);e[0]==null?(this.base.appendChild(d.obj),d.arw&&this.base.appendChild(d.arw)):(this.base.insertBefore(d.obj,this.base.childNodes[e[1]]),d.arw&&this.base.insertBefore(d.arw,
this.base.childNodes[e[1]+1]));b!=null&&this.addSpacer(b)}};dhtmlXToolbarObject.prototype._getIdByPosition=function(a,c){for(var b=null,d=0,e=0,h=0;h<this.base.childNodes.length;h++)this.base.childNodes[h].idd!=null&&b==null&&d++==a&&(b=this.base.childNodes[h].idd),b==null&&e++;e=b==null?null:e;return c==!0?[b,e]:b};dhtmlXToolbarObject.prototype.removeItem=function(a){this._removeItem(a)};
dhtmlXToolbarObject.prototype._removeItem=function(a){var c=this.getType(a),a=this.idPrefix+a,b=this.objPull[a];if(c=="button")b.obj._doOnMouseOver=null,b.obj._doOnMouseOut=null,b.obj._doOnMouseUp=null,b.obj._doOnMouseUpOnceAnywhere=null,b.obj.onclick=null,b.obj.onmouseover=null,b.obj.onmouseout=null,b.obj.onmouseup=null,b.obj.onmousedown=null,b.obj.onselectstart=null,b.obj.renderAs=null,b.obj.idd=null,b.obj.parentNode.removeChild(b.obj),b.obj=null,b.id=null,b.state=null,b.img=null,b.imgEn=null,b.imgDis=
null,b.type=null,b.enableItem=null,b.disableItem=null,b.isEnabled=null,b.showItem=null,b.hideItem=null,b.isVisible=null,b.setItemText=null,b.getItemText=null,b.setItemImage=null,b.clearItemImage=null,b.setItemImageDis=null,b.clearItemImageDis=null,b.setItemToolTip=null,b.getItemToolTip=null;if(c=="buttonTwoState")b.obj._doOnMouseOver=null,b.obj._doOnMouseOut=null,b.obj.onmouseover=null,b.obj.onmouseout=null,b.obj.onmousedown=null,b.obj.onselectstart=null,b.obj.renderAs=null,b.obj.idd=null,b.obj.parentNode.removeChild(b.obj),
b.obj=null,b.id=null,b.state=null,b.img=null,b.imgEn=null,b.imgDis=null,b.type=null,b.enableItem=null,b.disableItem=null,b.isEnabled=null,b.showItem=null,b.hideItem=null,b.isVisible=null,b.setItemText=null,b.getItemText=null,b.setItemImage=null,b.clearItemImage=null,b.setItemImageDis=null,b.clearItemImageDis=null,b.setItemToolTip=null,b.getItemToolTip=null,b.setItemState=null,b.getItemState=null;if(c=="buttonSelect"){for(var d in b._listOptions)this.removeListOption(a,d);b._listOptions=null;if(b.polygon._ie6cover)document.body.removeChild(b.polygon._ie6cover),
b.polygon._ie6cover=null;b.p_tbl.removeChild(b.p_tbody);b.polygon.removeChild(b.p_tbl);b.polygon.onselectstart=null;document.body.removeChild(b.polygon);b.p_tbody=null;b.p_tbl=null;b.polygon=null;b.obj.onclick=null;b.obj.onmouseover=null;b.obj.onmouseout=null;b.obj.onmouseup=null;b.obj.onmousedown=null;b.obj.onselectstart=null;b.obj.idd=null;b.obj.iddPrefix=null;b.obj.parentNode.removeChild(b.obj);b.obj=null;b.arw.onclick=null;b.arw.onmouseover=null;b.arw.onmouseout=null;b.arw.onmouseup=null;b.arw.onmousedown=
null;b.arw.onselectstart=null;b.arw.parentNode.removeChild(b.arw);b.arw=null;b.renderSelect=null;b.state=null;b.type=null;b.id=null;b.img=null;b.imgEn=null;b.imgDis=null;b.openAll=null;b._isListButton=null;b._separatorButtonSelectObject=null;b._buttonButtonSelectObject=null;b.setWidth=null;b.enableItem=null;b.disableItem=null;b.isEnabled=null;b.showItem=null;b.hideItem=null;b.isVisible=null;b.setItemText=null;b.getItemText=null;b.setItemImage=null;b.clearItemImage=null;b.setItemImageDis=null;b.clearItemImageDis=
null;b.setItemToolTip=null;b.getItemToolTip=null;b.addListOption=null;b.removeListOption=null;b.showListOption=null;b.hideListOption=null;b.isListOptionVisible=null;b.enableListOption=null;b.disableListOption=null;b.isListOptionEnabled=null;b.setListOptionPosition=null;b.getListOptionPosition=null;b.setListOptionImage=null;b.getListOptionImage=null;b.clearListOptionImage=null;b.setListOptionText=null;b.getListOptionText=null;b.setListOptionToolTip=null;b.getListOptionToolTip=null;b.forEachListOption=
null;b.getAllListOptions=null;b.setListOptionSelected=null;b.getListOptionSelected=null}if(c=="buttonInput")b.obj.childNodes[0].onkeydown=null,b.obj.removeChild(b.obj.childNodes[0]),b.obj.w=null,b.obj.idd=null,b.obj.parentNode.removeChild(b.obj),b.obj=null,b.id=null,b.type=null,b.enableItem=null,b.disableItem=null,b.isEnabled=null,b.showItem=null,b.hideItem=null,b.isVisible=null,b.setItemToolTip=null,b.getItemToolTip=null,b.setWidth=null,b.getWidth=null,b.setValue=null,b.getValue=null,b.setItemText=
null,b.getItemText=null;if(c=="slider"){this._isIPad?(document.removeEventListener("touchmove",pen._doOnMouseMoveStart,!1),document.removeEventListener("touchend",pen._doOnMouseMoveEnd,!1)):_isIE?(document.body.detachEvent("onmousemove",b.pen._doOnMouseMoveStart),document.body.detachEvent("onmouseup",b.pen._doOnMouseMoveEnd)):(window.removeEventListener("mousemove",b.pen._doOnMouseMoveStart,!1),window.removeEventListener("mouseup",b.pen._doOnMouseMoveEnd,!1));b.pen.allowMove=null;b.pen.initXY=null;
b.pen.maxX=null;b.pen.minX=null;b.pen.nowX=null;b.pen.newNowX=null;b.pen.valueMax=null;b.pen.valueMin=null;b.pen.valueNow=null;b.pen._definePos=null;b.pen._detectLimits=null;b.pen._doOnMouseMoveStart=null;b.pen._doOnMouseMoveEnd=null;b.pen.onmousedown=null;b.obj.removeChild(b.pen);b.pen=null;b.label.tip=null;document.body.removeChild(b.label);b.label=null;b.obj.onselectstart=null;for(b.obj.idd=null;b.obj.childNodes.length>0;)b.obj.removeChild(b.obj.childNodes[0]);b.obj.parentNode.removeChild(b.obj);
b.obj=null;b.id=null;b.type=null;b.state=null;b.enableItem=null;b.disableItem=null;b.isEnabled=null;b.setItemToolTipTemplate=null;b.getItemToolTipTemplate=null;b.setMaxValue=null;b.setMinValue=null;b.getMaxValue=null;b.getMinValue=null;b.setValue=null;b.getValue=null;b.showItem=null;b.hideItem=null;b.isVisible=null}if(c=="separator")b.obj.onselectstart=null,b.obj.idd=null,b.obj.parentNode.removeChild(b.obj),b.obj=null,b.id=null,b.type=null,b.showItem=null,b.hideItem=null,b.isVisible=null;if(c=="text")b.obj.onselectstart=
null,b.obj.idd=null,b.obj.parentNode.removeChild(b.obj),b.obj=null,b.id=null,b.type=null,b.showItem=null,b.hideItem=null,b.isVisible=null,b.setWidth=null,b.setItemText=null,b.getItemText=null;b=c=null;this.objPull[this.idPrefix+a]=null;delete this.objPull[this.idPrefix+a]};
(function(){for(var a="addListOption,removeListOption,showListOption,hideListOption,isListOptionVisible,enableListOption,disableListOption,isListOptionEnabled,setListOptionPosition,getListOptionPosition,setListOptionText,getListOptionText,setListOptionToolTip,getListOptionToolTip,setListOptionImage,getListOptionImage,clearListOptionImage,forEachListOption,getAllListOptions,setListOptionSelected,getListOptionSelected".split(","),c=function(a){return function(b,c,d,i,j,k){b=this.idPrefix+b;if(this.objPull[b]!=
null)return this.objPull[b].type!="buttonSelect"?void 0:this.objPull[b][a].call(this.objPull[b],c,d,i,j,k)}},b=0;b<a.length;b++){var d=a[b];dhtmlXToolbarObject.prototype[d]=c(d)}})();dhtmlXToolbarObject.prototype._rtlParseBtn=function(a,c){return a+c};
dhtmlXToolbarObject.prototype._separatorObject=function(a,c,b){this.id=a.idPrefix+c;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_sep";this.obj.style.display=b.hidden!=null?"none":"";this.obj.idd=String(c);this.obj.title=b.title||"";this.obj.onselectstart=function(a){a=a||event;a.returnValue=!1};if(a._isIPad)this.obj.ontouchstart=function(a){a=a||event;a.returnValue=!1;a.cancelBubble=!0;return!1};a.base.appendChild(this.obj);this.showItem=function(){this.obj.style.display=
""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return this.obj.style.display==""};return this};
dhtmlXToolbarObject.prototype._textObject=function(a,c,b){this.id=a.idPrefix+c;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_text";this.obj.style.display=b.hidden!=null?"none":"";this.obj.idd=String(c);this.obj.title=b.title||"";this.obj.onselectstart=function(a){a=a||event;a.returnValue=!1};if(a._isIPad)this.obj.ontouchstart=function(a){a=a||event;a.returnValue=!1;a.cancelBubble=!0;return!1};this.obj.innerHTML=b.text||"";a.base.appendChild(this.obj);this.showItem=function(){this.obj.style.display=
""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return this.obj.style.display==""};this.setItemText=function(a){this.obj.innerHTML=a};this.getItemText=function(){return this.obj.innerHTML};this.setWidth=function(a){this.obj.style.width=a+"px"};this.setItemToolTip=function(a){this.obj.title=a};this.getItemToolTip=function(){return this.obj.title};return this};
dhtmlXToolbarObject.prototype._buttonObject=function(a,c,b){this.id=a.idPrefix+c;this.state=b.enabled!=null?!1:!0;this.imgEn=b.img||"";this.imgDis=b.imgdis||"";this.img=this.state?this.imgEn!=""?this.imgEn:"":this.imgDis!=""?this.imgDis:"";this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis");this.obj.style.display=b.hidden!=null?"none":"";this.obj.allowClick=!1;this.obj.extAction=b.action||null;this.obj.renderAs=this.obj.className;this.obj.idd=String(c);
this.obj.title=b.title||"";this.obj.pressed=!1;this.obj.innerHTML=a._rtlParseBtn(this.img!=""?"<img src='"+a.imagePath+this.img+"'>":"",b.text!=null?"<div>"+b.text+"</div>":"");var d=this;this.obj.onselectstart=function(a){a=a||event;a.returnValue=!1};this.obj.onmouseover=function(){this._doOnMouseOver()};this.obj.onmouseout=function(){this._doOnMouseOut()};this.obj._doOnMouseOver=function(){this.allowClick=!0;if(d.state!=!1&&a.anyUsed=="none")this.renderAs=this.className="dhx_toolbar_btn over"};
this.obj._doOnMouseOut=function(){this.allowClick=!1;if(d.state!=!1&&a.anyUsed=="none")this.className="dhx_toolbar_btn def",this.renderAs=this.renderAs};this.obj.onclick=function(b){if(d.state!=!1&&this.allowClick!=!1){var b=b||event,c=this.idd.replace(a.idPrefix,"");if(this.extAction)try{window[this.extAction](c)}catch(g){}a&&a.callEvent&&a.callEvent("onClick",[c])}};this.obj[a._isIPad?"ontouchstart":"onmousedown"]=function(b){if(d.state==!1)return b=b||event,b.returnValue=!1,b.cancelBubble=!0,!1;
if(a.anyUsed=="none")return a.anyUsed=this.idd,this.className="dhx_toolbar_btn pres",this.pressed=!0,this.onmouseover=function(){this._doOnMouseOver()},this.onmouseout=function(){a.anyUsed="none";this._doOnMouseOut()},!1};this.obj[a._isIPad?"ontouchend":"onmouseup"]=function(){if(d.state!=!1&&!(a.anyUsed!="none"&&a.anyUsed!=this.idd)){var b=a.anyUsed;this._doOnMouseUp();a._isIPad&&b!="none"&&a.callEvent("onClick",[this.idd.replace(a.idPrefix,"")])}};if(a._isIPad)this.obj.ontouchmove=function(){this._doOnMouseUp()};
this.obj._doOnMouseUp=function(){a.anyUsed="none";this.className=this.renderAs;this.pressed=!1};this.obj._doOnMouseUpOnceAnywhere=function(){this._doOnMouseUp();this.onmouseover=function(){this._doOnMouseOver()};this.onmouseout=function(){this._doOnMouseOut()}};a.base.appendChild(this.obj);this.enableItem=function(){a._enableItem(this)};this.disableItem=function(){a._disableItem(this)};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display=
"none"};this.isVisible=function(){return this.obj.style.display==""};this.setItemText=function(b){a._setItemText(this,b)};this.getItemText=function(){return a._getItemText(this)};this.setItemImage=function(b){a._setItemImage(this,b,!0)};this.clearItemImage=function(){a._clearItemImage(this,!0)};this.setItemImageDis=function(b){a._setItemImage(this,b,!1)};this.clearItemImageDis=function(){a._clearItemImage(this,!1)};this.setItemToolTip=function(a){this.obj.title=a};this.getItemToolTip=function(){return this.obj.title};
return this};
dhtmlXToolbarObject.prototype._buttonSelectObject=function(a,c,b){this.id=a.idPrefix+c;this.state=b.enabled!=null?b.enabled=="true"?!0:!1:!0;this.imgEn=b.img||"";this.imgDis=b.imgdis||"";this.img=this.state?this.imgEn!=""?this.imgEn:"":this.imgDis!=""?this.imgDis:"";this.openAll=b.openAll!=null;this.maxOpen=!isNaN(b.maxOpen?b.maxOpen:"")?b.maxOpen:null;this._maxOpenTest=function(){if(!isNaN(this.maxOpen)&&!a._sbw){var b=document.createElement("DIV");b.className="dhxtoolbar_maxopen_test";document.body.appendChild(b);
var c=document.createElement("DIV");c.className="dhxtoolbar_maxopen_test2";b.appendChild(c);a._sbw=b.offsetWidth-c.offsetWidth;b.removeChild(c);c=null;document.body.removeChild(b);b=null}};this._maxOpenTest();this.obj=document.createElement("DIV");this.obj.allowClick=!1;this.obj.extAction=b.action||null;this.obj.className="dhx_toolbar_btn def";this.obj.style.display=b.hidden!=null?"none":"";this.obj.renderAs=this.obj.className;this.obj.onselectstart=function(a){a=a||event;a.returnValue=!1};this.obj.idd=
String(c);this.obj.title=b.title||"";this.callEvent=this.obj.pressed=!1;this.renderSelect=b.renderSelect!=null?b.renderSelect=="false"||b.renderSelect=="disabled"?!1:!0:!0;this.obj.innerHTML=a._rtlParseBtn(this.img!=""?"<img src='"+a.imagePath+this.img+"'>":"",b.text!=null?"<div>"+b.text+"</div>":"");a.base.appendChild(this.obj);this.arw=document.createElement("DIV");this.arw.className="dhx_toolbar_arw def";this.arw.style.display=this.obj.style.display;this.arw.innerHTML="<div class='arwimg'>&nbsp;</div>";
this.arw.title=this.obj.title;this.arw.onselectstart=function(a){a=a||event;a.returnValue=!1};a.base.appendChild(this.arw);var d=this;this.obj.onmouseover=function(b){b=b||event;if(a.anyUsed=="none"&&d.state)d.obj.renderAs="dhx_toolbar_btn over",d.obj.className=d.obj.renderAs,d.arw.className=String(d.obj.renderAs).replace("btn","arw")};this.obj.onmouseout=function(){d.obj.allowClick=!1;if(a.anyUsed=="none"&&d.state)d.obj.renderAs="dhx_toolbar_btn def",d.obj.className=d.obj.renderAs,d.arw.className=
String(d.obj.renderAs).replace("btn","arw"),d.callEvent=!1};this.arw.onmouseover=this.obj.onmouseover;this.arw.onmouseout=this.obj.onmouseout;if(this.openAll!=!0)this.obj.onclick=function(b){b=b||event;if(d.obj.allowClick&&d.state&&a.anyUsed=="none"){var c=d.obj.idd.replace(a.idPrefix,"");if(d.obj.extAction)try{window[d.obj.extAction](c)}catch(e){}a.callEvent("onClick",[c])}},this.obj[a._isIPad?"ontouchstart":"onmousedown"]=function(b){b=b||event;if(a.anyUsed=="none"&&d.state)d.obj.allowClick=!0,
d.obj.className="dhx_toolbar_btn pres",d.arw.className="dhx_toolbar_arw pres",d.callEvent=!0},this.obj[a._isIPad?"ontouchend":"onmouseup"]=function(b){b=b||event;b.cancelBubble=!0;if(a.anyUsed=="none"&&d.state&&(d.obj.className=d.obj.renderAs,d.arw.className=String(d.obj.renderAs).replace("btn","arw"),a._isIPad&&d.callEvent)){var c=d.obj.idd.replace(a.idPrefix,"");a.callEvent("onClick",[c])}};if(a._isIPad)this.obj.ontouchmove=this.obj.onmouseout;this.arw[a._isIPad?"ontouchstart":"onmousedown"]=function(b){b=
b||event;if(d.state){if(a.anyUsed==d.obj.idd){if(d.obj.className=d.obj.renderAs,d.arw.className=String(d.obj.renderAs).replace("btn","arw"),a.anyUsed="none",d.polygon.style.display="none",d.polygon._ie6cover)d.polygon._ie6cover.style.display="none"}else{if(a.anyUsed!="none"&&a.objPull[a.idPrefix+a.anyUsed].type=="buttonSelect"){var c=a.objPull[a.idPrefix+a.anyUsed];if(c.polygon.style.display!="none"&&(c.obj.renderAs="dhx_toolbar_btn def",c.obj.className=c.obj.renderAs,c.arw.className=String(d.obj.renderAs).replace("btn",
"arw"),c.polygon.style.display="none",c.polygon._ie6cover))c.polygon._ie6cover.style.display="none"}d.obj.className="dhx_toolbar_btn over";d.arw.className="dhx_toolbar_arw pres";a.anyUsed=d.obj.idd;d.polygon.style.top="0px";d.polygon.style.visibility="hidden";d.polygon.style.display="";d._fixMaxOpenHeight(d.maxOpen||null);a._autoDetectVisibleArea();var e=getAbsoluteTop(d.obj)+d.obj.offsetHeight+a.selectPolygonOffsetTop,h=d.polygon.offsetHeight;if(e+h>a.tY2){var k=d.maxOpen!=null?Math.floor((a.tY2-
e)/22):0;k>=1?d._fixMaxOpenHeight(k):(e=getAbsoluteTop(d.obj)-h-a.selectPolygonOffsetTop,e<0&&(e=0))}d.polygon.style.top=e+"px";d.polygon.style.left=a.rtl?getAbsoluteLeft(d.obj)+d.obj.offsetWidth-d.polygon.offsetWidth+a.selectPolygonOffsetLeft+"px":getAbsoluteLeft(d.obj)+a.selectPolygonOffsetLeft+"px";d.polygon.style.visibility="visible";if(d.polygon._ie6cover)d.polygon._ie6cover.style.left=d.polygon.style.left,d.polygon._ie6cover.style.top=d.polygon.style.top,d.polygon._ie6cover.style.width=d.polygon.offsetWidth+
"px",d.polygon._ie6cover.style.height=d.polygon.offsetHeight+"px",d.polygon._ie6cover.style.display=""}return!1}};this.arw.onclick=function(a){a=a||event;a.cancelBubble=!0};this.arw[a._isIPad?"ontouchend":"onmouseup"]=function(a){a=a||event;a.cancelBubble=!0};if(this.openAll===!0&&(this.obj.onclick=this.arw.onclick,this.obj.onmousedown=this.arw.onmousedown,this.obj.onmouseup=this.arw.onmouseup,a._isIPad))this.obj.ontouchstart=this.arw.ontouchstart,this.obj.ontouchend=this.arw.ontouchend;this.obj.iddPrefix=
a.idPrefix;this._listOptions={};this._fixMaxOpenHeight=function(b){var c="auto",e=!1;if(b!==null){var h=0,k;for(k in this._listOptions)h++;h>b?(this._ph=22*b,c=this._ph+"px"):e=!0}this.polygon.style.width="auto";this.polygon.style.height="auto";if(!e&&d.maxOpen!=null)this.polygon.style.width=this.p_tbl.offsetWidth+a._sbw+"px",this.polygon.style.height=c};this._separatorButtonSelectObject=function(a,b,c){this.obj={};this.obj.tr=document.createElement("TR");this.obj.tr.className="tr_sep";this.obj.tr.onselectstart=
function(a){a=a||event;return a.returnValue=!1};this.obj.td=document.createElement("TD");this.obj.td.colSpan="2";this.obj.td.className="td_btn_sep";this.obj.td.onselectstart=function(a){a=a||event;return a.returnValue=!1};isNaN(c)?c=d.p_tbody.childNodes.length+1:c<1&&(c=1);c>d.p_tbody.childNodes.length?d.p_tbody.appendChild(this.obj.tr):d.p_tbody.insertBefore(this.obj.tr,d.p_tbody.childNodes[c-1]);this.obj.tr.appendChild(this.obj.td);this.obj.sep=document.createElement("DIV");this.obj.sep.className=
"btn_sep";this.obj.sep.onselectstart=function(a){a=a||event;return a.returnValue=!1};this.obj.td.appendChild(this.obj.sep);d._listOptions[a]=this.obj;return this};this._buttonButtonSelectObject=function(b,c,e){this.obj={};this.obj.tr=document.createElement("TR");this.obj.tr.en=c.enabled=="false"?!1:c.disabled=="true"?!1:!0;this.obj.tr.extAction=c.action||null;this.obj.tr._selected=c.selected!=null;this.obj.tr.className="tr_btn"+(this.obj.tr.en?this.obj.tr._selected&&d.renderSelect?" tr_btn_selected":
"":" tr_btn_disabled");this.obj.tr.onselectstart=function(a){a=a||event;return a.returnValue=!1};this.obj.tr.idd=String(b);if(c.userdata)this.obj.userData=c.userdata;isNaN(e)?e=d.p_tbody.childNodes.length+1:e<1&&(e=1);e>d.p_tbody.childNodes.length?d.p_tbody.appendChild(this.obj.tr):d.p_tbody.insertBefore(this.obj.tr,d.p_tbody.childNodes[e-1]);this.obj.td_a=document.createElement("TD");this.obj.td_a.className="td_btn_img";this.obj.td_a.onselectstart=function(a){a=a||event;return a.returnValue=!1};
this.obj.td_b=document.createElement("TD");this.obj.td_b.className="td_btn_txt";this.obj.td_b.onselectstart=function(a){a=a||event;return a.returnValue=!1};a.rtl?(this.obj.tr.appendChild(this.obj.td_b),this.obj.tr.appendChild(this.obj.td_a)):(this.obj.tr.appendChild(this.obj.td_a),this.obj.tr.appendChild(this.obj.td_b));if(c.img!=null)this.obj.td_a.innerHTML="<img class='btn_sel_img' src='"+a.imagePath+c.img+"' border='0'>";var h=c.text!=null?c.text:c.itemText||"";this.obj.td_b.innerHTML="<div class='btn_sel_text'>"+
h+"</div>";this.obj.tr[a._isIPad?"ontouchstart":"onmouseover"]=function(){if(this.en&&(!this._selected||!d.renderSelect))this.className="tr_btn tr_btn_over"};this.obj.tr.onmouseout=function(){if(this.en)if(this._selected&&d.renderSelect){if(String(this.className).search("tr_btn_selected")==-1)this.className="tr_btn tr_btn_selected"}else this.className="tr_btn"};this.obj.tr[a._isIPad?"ontouchend":"onclick"]=function(b){b=b||event;b.cancelBubble=!0;if(this.en){d.setListOptionSelected(this.idd.replace(a.idPrefix,
""));d.obj.renderAs="dhx_toolbar_btn def";d.obj.className=d.obj.renderAs;d.arw.className=String(d.obj.renderAs).replace("btn","arw");d.polygon.style.display="none";if(d.polygon._ie6cover)d.polygon._ie6cover.style.display="none";a.anyUsed="none";var c=this.idd.replace(a.idPrefix,"");if(this.extAction)try{window[this.extAction](c)}catch(e){}a.callEvent("onClick",[c])}};d._listOptions[b]=this.obj;return this};this.polygon=document.createElement("DIV");this.polygon.dir="ltr";this.polygon.style.display=
"none";this.polygon.style.zIndex=101;this.polygon.className="dhx_toolbar_poly_"+a.skin+(a.rtl?" rtl":"");this.polygon.onselectstart=function(a){a=a||event;a.returnValue=!1};this.polygon.style.overflowY="auto";if(a._isIPad)this.polygon.ontouchstart=function(a){a=a||event;a.returnValue=!1;a.cancelBubble=!0;return!1};this.p_tbl=document.createElement("TABLE");this.p_tbl.className="buttons_cont";this.p_tbl.cellSpacing="0";this.p_tbl.cellPadding="0";this.p_tbl.border="0";this.polygon.appendChild(this.p_tbl);
this.p_tbody=document.createElement("TBODY");this.p_tbl.appendChild(this.p_tbody);if(b.items)for(var e=0;e<b.items.length;e++){var h="_"+(b.items[e].type||"")+"ButtonSelectObject";typeof this[h]=="function"&&new this[h](b.items[e].id||a._genStr(24),b.items[e])}document.body.appendChild(this.polygon);if(a._isIE6)this.polygon._ie6cover=document.createElement("IFRAME"),this.polygon._ie6cover.frameBorder=0,this.polygon._ie6cover.style.position="absolute",this.polygon._ie6cover.style.border="none",this.polygon._ie6cover.style.backgroundColor=
"#000000",this.polygon._ie6cover.style.filter="alpha(opacity=100)",this.polygon._ie6cover.style.display="none",this.polygon._ie6cover.setAttribute("src","javascript:false;"),document.body.appendChild(this.polygon._ie6cover);this.setWidth=function(a){this.obj.style.width=a-this.arw.offsetWidth+"px";this.polygon.style.width=this.obj.offsetWidth+this.arw.offsetWidth-2+"px";this.p_tbl.style.width=this.polygon.style.width};this.enableItem=function(){a._enableItem(this)};this.disableItem=function(){a._disableItem(this)};
this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display="";this.arw.style.display=""};this.hideItem=function(){this.obj.style.display="none";this.arw.style.display="none"};this.isVisible=function(){return this.obj.style.display==""};this.setItemText=function(b){a._setItemText(this,b)};this.getItemText=function(){return a._getItemText(this)};this.setItemImage=function(b){a._setItemImage(this,b,!0)};this.clearItemImage=function(){a._clearItemImage(this,!0)};this.setItemImageDis=
function(b){a._setItemImage(this,b,!1)};this.clearItemImageDis=function(){a._clearItemImage(this,!1)};this.setItemToolTip=function(a){this.obj.title=a;this.arw.title=a};this.getItemToolTip=function(){return this.obj.title};this.addListOption=function(a,b,c,d,e){if(c=="button"||c=="separator"){var h={id:a,type:c,text:d,img:e};new this["_"+c+"ButtonSelectObject"](a,h,b)}};this.removeListOption=function(a){if(this._isListButton(a,!0)){var b=this._listOptions[a];if(b.td_a!=null&&b.td_b!=null){b.td_a.onselectstart=
null;for(b.td_b.onselectstart=null;b.td_a.childNodes.length>0;)b.td_a.removeChild(b.td_a.childNodes[0]);for(;b.td_b.childNodes.length>0;)b.td_b.removeChild(b.td_b.childNodes[0]);b.tr.onselectstart=null;b.tr.onmouseover=null;b.tr.onmouseout=null;for(b.tr.onclick=null;b.tr.childNodes.length>0;)b.tr.removeChild(b.tr.childNodes[0]);b.tr.parentNode.removeChild(b.tr);b.td_a=null;b.td_b=null}else{b.sep.onselectstart=null;b.td.onselectstart=null;for(b.tr.onselectstart=null;b.td.childNodes.length>0;)b.td.removeChild(b.td.childNodes[0]);
for(;b.tr.childNodes.length>0;)b.tr.removeChild(b.tr.childNodes[0]);b.tr.parentNode.removeChild(b.tr);b.sep=null;b.td=null}b=b.tr=null;this._listOptions[a]=null;try{delete this._listOptions[a]}catch(c){}}};this.showListOption=function(a){if(this._isListButton(a,!0))this._listOptions[a].tr.style.display=""};this.hideListOption=function(a){if(this._isListButton(a,!0))this._listOptions[a].tr.style.display="none"};this.isListOptionVisible=function(a){return!this._isListButton(a,!0)?void 0:this._listOptions[a].tr.style.display!=
"none"};this.enableListOption=function(b){if(this._isListButton(b))this._listOptions[b].tr.en=!0,this._listOptions[b].tr.className="tr_btn"+(this._listOptions[b].tr._selected&&a.renderSelect?" tr_btn_selected":"")};this.disableListOption=function(a){if(this._isListButton(a))this._listOptions[a].tr.en=!1,this._listOptions[a].tr.className="tr_btn tr_btn_disabled"};this.isListOptionEnabled=function(a){return!this._isListButton(a)?void 0:this._listOptions[a].tr.en};this.setListOptionPosition=function(a,
b){if(this._listOptions[a]&&!(this.getListOptionPosition(a)==b||isNaN(b))){b<1&&(b=1);var c=this._listOptions[a].tr;this.p_tbody.removeChild(c);b>this.p_tbody.childNodes.length?this.p_tbody.appendChild(c):this.p_tbody.insertBefore(c,this.p_tbody.childNodes[b-1]);c=null}};this.getListOptionPosition=function(a){var b=-1;if(!this._listOptions[a])return b;for(var c=0;c<this.p_tbody.childNodes.length;c++)this.p_tbody.childNodes[c]==this._listOptions[a].tr&&(b=c+1);return b};this.setListOptionImage=function(b,
c){if(this._isListButton(b)){var d=this._listOptions[b].tr.childNodes[a.rtl?1:0];if(d.childNodes.length>0)d.childNodes[0].src=a.imagePath+c;else{var e=document.createElement("IMG");e.className="btn_sel_img";e.src=a.imagePath+c;d.appendChild(e)}d=null}};this.getListOptionImage=function(b){if(this._isListButton(b)){var c=this._listOptions[b].tr.childNodes[a.rtl?1:0],d=null;if(c.childNodes.length>0)d=c.childNodes[0].src;c=null;return d}};this.clearListOptionImage=function(b){if(this._isListButton(b)){for(var c=
this._listOptions[b].tr.childNodes[a.rtl?1:0];c.childNodes.length>0;)c.removeChild(c.childNodes[0]);c=null}};this.setListOptionText=function(b,c){if(this._isListButton(b))this._listOptions[b].tr.childNodes[a.rtl?0:1].childNodes[0].innerHTML=c};this.getListOptionText=function(b){return!this._isListButton(b)?void 0:this._listOptions[b].tr.childNodes[a.rtl?0:1].childNodes[0].innerHTML};this.setListOptionToolTip=function(a,b){if(this._isListButton(a))this._listOptions[a].tr.title=b};this.getListOptionToolTip=
function(a){return!this._isListButton(a)?void 0:this._listOptions[a].tr.title};this.forEachListOption=function(a){for(var b in this._listOptions)a(b)};this.getAllListOptions=function(){var a=[],b;for(b in this._listOptions)a[a.length]=b;return a};this.setListOptionSelected=function(a){for(var b in this._listOptions){var c=this._listOptions[b];if(c.td_a!=null&&c.td_b!=null&&c.tr.en)b==a?(c.tr._selected=!0,c.tr.className="tr_btn"+(this.renderSelect?" tr_btn_selected":"")):(c.tr._selected=!1,c.tr.className=
"tr_btn");c=null}};this.getListOptionSelected=function(){var a=null,b;for(b in this._listOptions)this._listOptions[b].tr._selected==!0&&(a=b);return a};this._isListButton=function(a,b){return this._listOptions[a]==null?!1:!b&&this._listOptions[a].tr.className=="tr_sep"?!1:!0};this.setMaxOpen=function(a){this._ph=null;typeof a=="number"?(this.maxOpen=a,this._maxOpenTest()):this.maxOpen=null};return this};
dhtmlXToolbarObject.prototype._buttonInputObject=function(a,c,b){this.id=a.idPrefix+c;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn def";this.obj.style.display=b.hidden!=null?"none":"";this.obj.idd=String(c);this.obj.w=b.width!=null?b.width:100;this.obj.title=b.title!=null?b.title:"";this.obj.innerHTML="<input class='inp' type='text' style='-moz-user-select:text;width:"+this.obj.w+"px;'"+(b.value!=null?"' value='"+b.value+"'":"")+">";var d=a,e=this;this.obj.childNodes[0].onkeydown=
function(a){a=a||event;a.keyCode==13&&d.callEvent("onEnter",[e.obj.idd,this.value])};a.base.appendChild(this.obj);this.enableItem=function(){this.obj.childNodes[0].disabled=!1};this.disableItem=function(){this.obj.childNodes[0].disabled=!0};this.isEnabled=function(){return!this.obj.childNodes[0].disabled};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return this.obj.style.display!="none"};this.setValue=function(a){this.obj.childNodes[0].value=
a};this.getValue=function(){return this.obj.childNodes[0].value};this.setWidth=function(a){this.obj.w=a;this.obj.childNodes[0].style.width=this.obj.w+"px"};this.getWidth=function(){return this.obj.w};this.setItemToolTip=function(a){this.obj.title=a};this.getItemToolTip=function(){return this.obj.title};return this};
dhtmlXToolbarObject.prototype.unload=function(){this._isIPad?document.removeEventListener("touchstart",this._doOnClick,!1):_isIE?document.body.detachEvent("onclick",this._doOnClick):window.removeEventListener("click",this._doOnClick,!1);this._doOnClick=null;this.clearAll();this.objPull=null;if(this._xmlLoader)this._xmlLoader.destructor(),this._xmlLoader=null;for(;this.base.childNodes.length>0;)this.base.removeChild(this.base.childNodes[0]);this.cont.removeChild(this.base);for(this.base=null;this.cont.childNodes.length>
0;)this.cont.removeChild(this.cont.childNodes[0]);this.cont.className="";this.cont=null;this.detachAllEvents();this.items=this.setMaxOpen=this.getUserData=this.setUserData=this.unload=this.getListOptionSelected=this.setListOptionSelected=this.getAllListOptions=this.forEachListOption=this.clearListOptionImage=this.getListOptionImage=this.setListOptionImage=this.getListOptionToolTip=this.setListOptionToolTip=this.getListOptionText=this.setListOptionText=this.getListOptionPosition=this.setListOptionPosition=
this.isListOptionEnabled=this.disableListOption=this.enableListOption=this.isListOptionVisible=this.hideListOption=this.showListOption=this.removeListOption=this.addListOption=this.removeItem=this.setPosition=this.getPosition=this.getWidth=this.setWidth=this.getMaxValue=this.setMaxValue=this.getMinValue=this.setMinValue=this.getValue=this.setValue=this.getItemToolTipTemplate=this.setItemToolTipTemplate=this.getItemState=this.setItemState=this.clearItemImageDis=this.clearItemImage=this.setItemImageDis=
this.setItemImage=this.getItemToolTip=this.setItemToolTip=this.getItemText=this.setItemText=this.isEnabled=this.disableItem=this.enableItem=this.isVisible=this.hideItem=this.showItem=this.forEachItem=this.addInput=this.addSlider=this.addSeparator=this.addButtonTwoState=this.addButtonSelect=this.addText=this.addButton=this.getParentId=this.inArray=this.getTypeExt=this.getType=this.removeSpacer=this.addSpacer=this.clearAll=this.detachAllEvents=this.detachEvent=this.eventCatcher=this.checkEvent=this.callEvent=
this.attachEvent=this.loadXMLString=this.loadXML=this.setIconPath=this.setIconsPath=this.setSkin=this.setAlign=this._removeItem=this._autoDetectVisibleArea=this._sliderObject=this._buttonTwoStateObject=this._buttonInputObject=this._buttonSelectObject=this._buttonObject=this._textObject=this._separatorObject=this._getIdByPosition=this._setPosition=this._getPosition=this._addItem=this._genStr=this._addItemToStorage=this._doOnLoad=this._xmlParser=this._disableItem=this._enableItem=this._getItemText=
this._setItemText=this._clearItemImage=this._setItemImage=this._addImgObj=this._getObj=this._sbw=this.setRTL=this._rtlParseBtn=this._rtl=this.skin=this.selectPolygonOffsetTop=this.selectPolygonOffsetLeft=this.rootTypes=this.imagePath=this.idPrefix=this.anyUsed=this.align=this._isWebToolbar=this._isIE6=this.tY2=this.tY1=this.tX2=this.tX1=null};
dhtmlXToolbarObject.prototype._autoDetectVisibleArea=function(){this.tX1=document.body.scrollLeft;this.tX2=this.tX1+(window.innerWidth||document.body.clientWidth);this.tY1=Math.max((_isIE?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop);this.tY2=this.tY1+(_isIE?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0):window.innerHeight)};
dhtmlXToolbarObject.prototype.setUserData=function(a,c,b){if(this.objPull[this.idPrefix+a]!=null){var d=this.objPull[this.idPrefix+a];if(d.userData==null)d.userData={};d.userData[c]=b}};dhtmlXToolbarObject.prototype.getUserData=function(a,c){return this.objPull[this.idPrefix+a]==null?null:this.objPull[this.idPrefix+a].userData==null?null:this.objPull[this.idPrefix+a].userData[c]==null?null:this.objPull[this.idPrefix+a].userData[c]};
dhtmlXToolbarObject.prototype._isListOptionExists=function(a,c){if(this.objPull[this.idPrefix+a]==null)return!1;var b=this.objPull[this.idPrefix+a];return b.type!="buttonSelect"?!1:b._listOptions[c]==null?!1:!0};dhtmlXToolbarObject.prototype.setListOptionUserData=function(a,c,b,d){if(this._isListOptionExists(a,c)){var e=this.objPull[this.idPrefix+a]._listOptions[c];if(e.userData==null)e.userData={};e.userData[b]=d}};
dhtmlXToolbarObject.prototype.getListOptionUserData=function(a,c,b){if(!this._isListOptionExists(a,c))return null;var d=this.objPull[this.idPrefix+a]._listOptions[c];return!d.userData?null:d.userData[b]?d.userData[b]:null};
(function(){dhtmlx.extend_api("dhtmlXToolbarObject",{_init:function(a){return[a.parent,a.skin]},icon_path:"setIconsPath",xml:"loadXML",items:"items",align:"setAlign",rtl:"setRTL",skin:"setSkin"},{items:function(a){for(var c=0;c<a.length;c++){var b=a[c];b.type=="button"&&this.addButton(b.id,null,b.text,b.img,b.img_disabled);b.type=="separator"&&this.addSeparator(b.id,null);b.type=="text"&&this.addText(b.id,null,b.text);b.type=="buttonSelect"&&this.addButtonSelect(b.id,null,b.text,b.options,b.img,b.img_disabled);
b.type=="buttonTwoState"&&this.addButtonTwoState(b.id,null,b.text,b.img,b.img_disabled);b.type=="buttonInput"&&this.addInput(b.id,null,b.text);b.type=="slider"&&this.addSlider(b.id,null,b.length,b.value_min,b.value_max,b.value_now,b.text_min,b.text_max,b.tip_template);b.width&&this.setWidth(b.id,b.width);b.disabled&&this.disableItem(b.id);b.tooltip&&this.setItemToolTip(b.id,b.tooltip);b.pressed===!0&&this.setItemState(b.id,!0)}}})})();
function dhtmlXContainer(a){var c=this;this.obj=a;this.dhxcont=null;this.st=document.createElement("DIV");this.st.style.position="absolute";this.st.style.left="-200px";this.st.style.top="0px";this.st.style.width="100px";this.st.style.height="1px";this.st.style.visibility="hidden";this.st.style.overflow="hidden";document.body.insertBefore(this.st,document.body.childNodes[0]);this.obj._getSt=function(){return c.st};this.obj.dv="def";this.obj.av=this.obj.dv;this.obj.cv=this.obj.av;this.obj.vs={};this.obj.vs[this.obj.av]=
{};this.obj.view=function(a){if(!this.vs[a]){this.vs[a]={};this.vs[a].dhxcont=this.vs[this.dv].dhxcont;var b=document.createElement("DIV");b.style.position="relative";b.style.left="0px";b.style.width="200px";b.style.height="200px";b.style.overflow="hidden";b.style.visibility="";c.st.appendChild(b);this.vs[a].dhxcont.mainCont[a]=b}this.avt=this.av;this.av=a;return this};this.obj.setActive=function(){if(this.vs[this.av])this.cv=this.av,this.vs[this.avt].dhxcont==this.vs[this.avt].dhxcont.mainCont[this.avt].parentNode&&
(c.st.appendChild(this.vs[this.avt].dhxcont.mainCont[this.avt]),this.vs[this.avt].menu&&c.st.appendChild(document.getElementById(this.vs[this.avt].menuId)),this.vs[this.avt].toolbar&&c.st.appendChild(document.getElementById(this.vs[this.avt].toolbarId)),this.vs[this.avt].sb&&c.st.appendChild(document.getElementById(this.vs[this.avt].sbId))),this.vs[this.av].dhxcont!=this.vs[this.av].dhxcont.mainCont[this.av].parentNode&&(this.vs[this.av].dhxcont.insertBefore(this.vs[this.av].dhxcont.mainCont[this.av],
this.vs[this.av].dhxcont.childNodes[this.vs[this.av].dhxcont.childNodes.length-1]),this.vs[this.av].menu&&this.vs[this.av].dhxcont.insertBefore(document.getElementById(this.vs[this.av].menuId),this.vs[this.av].dhxcont.childNodes[0]),this.vs[this.av].toolbar&&this.vs[this.av].dhxcont.insertBefore(document.getElementById(this.vs[this.av].toolbarId),this.vs[this.av].dhxcont.childNodes[this.vs[this.av].menu?1:0]),this.vs[this.av].sb&&this.vs[this.av].dhxcont.insertBefore(document.getElementById(this.vs[this.av].sbId),
this.vs[this.av].dhxcont.childNodes[this.vs[this.av].dhxcont.childNodes.length-1])),this._doOnResize&&this._doOnResize(),this.avt=null};this.obj._viewRestore=function(){var a=this.av;if(this.avt)this.av=this.avt,this.avt=null;return a};this.setContent=function(a){this.obj.vs[this.obj.av].dhxcont=a;this.obj._init()};this.obj._init=function(){this.vs[this.av].dhxcont.innerHTML="<div ida='dhxMainCont' style='position: relative; left: 0px; top: 0px; overflow: hidden;'></div><div ida='dhxContBlocker' class='dhxcont_content_blocker' style='display: none;'></div>";
this.vs[this.av].dhxcont.mainCont={};this.vs[this.av].dhxcont.mainCont[this.av]=this.vs[this.av].dhxcont.childNodes[0]};this.obj._genStr=function(a){for(var b="",c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",g=0;g<a;g++)b+=c.charAt(Math.round(Math.random()*(c.length-1)));return b};this.obj.setMinContentSize=function(a,b){this.vs[this.av]._minDataSizeW=a;this.vs[this.av]._minDataSizeH=b};this.obj._setPadding=function(a,b){typeof a=="object"?(this._offsetTop=a[0],this._offsetLeft=
a[1],this._offsetWidth=a[2],this._offsetHeight=a[3]):(this._offsetLeft=this._offsetTop=a,this._offsetWidth=-a*2,this._offsetHeight=-a*2);this.vs[this.av].dhxcont.className="dhxcont_global_content_area "+(b||"")};this.obj.moveContentTo=function(a){for(var b in this.vs){a.view(b).setActive();var c=null;this.vs[b].grid&&(c="grid");this.vs[b].tree&&(c="tree");this.vs[b].tabbar&&(c="tabbar");this.vs[b].folders&&(c="folders");this.vs[b].layout&&(c="layout");c!=null&&(a.view(b).attachObject(this.vs[b][c+
"Id"]),a.vs[b][c]=this.vs[b][c],a.vs[b][c+"Id"]=this.vs[b][c+"Id"],a.vs[b][c+"Obj"]=this.vs[b][c+"Obj"],this.vs[b][c]=null,this.vs[b][c+"Id"]=null,this.vs[b][c+"Obj"]=null);if(this.vs[b]._frame)a.vs[b]._frame=this.vs[b]._frame,this.vs[b]._frame=null;if(this.vs[b].menu!=null)a.cv==a.av?a.vs[a.av].dhxcont.insertBefore(document.getElementById(this.vs[b].menuId),a.vs[a.av].dhxcont.childNodes[0]):a._getSt().appendChild(document.getElementById(this.vs[b].menuId)),a.vs[b].menu=this.vs[b].menu,a.vs[b].menuId=
this.vs[b].menuId,a.vs[b].menuHeight=this.vs[b].menuHeight,this.vs[b].menu=null,this.vs[b].menuId=null,this.vs[b].menuHeight=null,this.cv==this.av&&this._doOnAttachMenu&&this._doOnAttachMenu("unload"),a.cv==a.av&&a._doOnAttachMenu&&a._doOnAttachMenu("move");if(this.vs[b].toolbar!=null)a.cv==a.av?a.vs[a.av].dhxcont.insertBefore(document.getElementById(this.vs[b].toolbarId),a.vs[a.av].dhxcont.childNodes[a.vs[a.av].menu!=null?1:0]):a._getSt().appendChild(document.getElementById(this.vs[b].toolbarId)),
a.vs[b].toolbar=this.vs[b].toolbar,a.vs[b].toolbarId=this.vs[b].toolbarId,a.vs[b].toolbarHeight=this.vs[b].toolbarHeight,this.vs[b].toolbar=null,this.vs[b].toolbarId=null,this.vs[b].toolbarHeight=null,this.cv==this.av&&this._doOnAttachToolbar&&this._doOnAttachToolbar("unload"),a.cv==a.av&&a._doOnAttachToolbar&&a._doOnAttachToolbar("move");if(this.vs[b].sb!=null)a.cv==a.av?a.vs[a.av].dhxcont.insertBefore(document.getElementById(this.vs[b].sbId),a.vs[a.av].dhxcont.childNodes[a.vs[a.av].dhxcont.childNodes.length-
1]):a._getSt().appendChild(document.getElementById(this.vs[b].sbId)),a.vs[b].sb=this.vs[b].sb,a.vs[b].sbId=this.vs[b].sbId,a.vs[b].sbHeight=this.vs[b].sbHeight,this.vs[b].sb=null,this.vs[b].sbId=null,this.vs[b].sbHeight=null,this.cv==this.av&&this._doOnAttachStatusBar&&this._doOnAttachStatusBar("unload"),a.cv==a.av&&a._doOnAttachStatusBar&&a._doOnAttachStatusBar("move");for(var g=this.vs[b].dhxcont.mainCont[b],f=a.vs[b].dhxcont.mainCont[b];g.childNodes.length>0;)f.appendChild(g.childNodes[0])}a.view(this.av).setActive()};
this.obj.adjustContent=function(a,b,c,g,f){this.vs[this.av].dhxcont.style.left=(this._offsetLeft||0)+"px";this.vs[this.av].dhxcont.style.top=(this._offsetTop||0)+b+"px";var i=a.clientWidth+(this._offsetWidth||0);if(g!==!0)this.vs[this.av].dhxcont.style.width=Math.max(0,i)+"px";if(g!==!0&&this.vs[this.av].dhxcont.offsetWidth>i)this.vs[this.av].dhxcont.style.width=Math.max(0,i*2-this.vs[this.av].dhxcont.offsetWidth)+"px";var j=a.clientHeight+(this._offsetHeight||0);this.vs[this.av].dhxcont.style.height=
Math.max(0,j-b)+(c!=null?c:0)+"px";if(this.vs[this.av].dhxcont.offsetHeight>j-b)this.vs[this.av].dhxcont.style.height=Math.max(0,(j-b)*2-this.vs[this.av].dhxcont.offsetHeight)+"px";if(f&&!isNaN(f))this.vs[this.av].dhxcont.style.height=Math.max(0,parseInt(this.vs[this.av].dhxcont.style.height)-f)+"px";if(this.vs[this.av]._minDataSizeH!=null&&parseInt(this.vs[this.av].dhxcont.style.height)<this.vs[this.av]._minDataSizeH)this.vs[this.av].dhxcont.style.height=this.vs[this.av]._minDataSizeH+"px";if(this.vs[this.av]._minDataSizeW!=
null&&parseInt(this.vs[this.av].dhxcont.style.width)<this.vs[this.av]._minDataSizeW)this.vs[this.av].dhxcont.style.width=this.vs[this.av]._minDataSizeW+"px";if(g!==!0&&(this.vs[this.av].dhxcont.mainCont[this.av].style.width=this.vs[this.av].dhxcont.clientWidth+"px",this.vs[this.av].dhxcont.mainCont[this.av].offsetWidth>this.vs[this.av].dhxcont.clientWidth))this.vs[this.av].dhxcont.mainCont[this.av].style.width=Math.max(0,this.vs[this.av].dhxcont.clientWidth*2-this.vs[this.av].dhxcont.mainCont[this.av].offsetWidth)+
"px";var k=this.vs[this.av].menu!=null?!this.vs[this.av].menuHidden?this.vs[this.av].menuHeight:0:0,l=this.vs[this.av].toolbar!=null?!this.vs[this.av].toolbarHidden?this.vs[this.av].toolbarHeight:0:0,m=this.vs[this.av].sb!=null?!this.vs[this.av].sbHidden?this.vs[this.av].sbHeight:0:0;this.vs[this.av].dhxcont.mainCont[this.av].style.height=this.vs[this.av].dhxcont.clientHeight+"px";if(this.vs[this.av].dhxcont.mainCont[this.av].offsetHeight>this.vs[this.av].dhxcont.clientHeight)this.vs[this.av].dhxcont.mainCont[this.av].style.height=
Math.max(0,this.vs[this.av].dhxcont.clientHeight*2-this.vs[this.av].dhxcont.mainCont[this.av].offsetHeight)+"px";this.vs[this.av].dhxcont.mainCont[this.av].style.height=Math.max(0,parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)-k-l-m)+"px"};this.obj.coverBlocker=function(){return this.vs[this.av].dhxcont.childNodes[this.vs[this.av].dhxcont.childNodes.length-1]};this.obj.showCoverBlocker=function(){this.coverBlocker().style.display=""};this.obj.hideCoverBlocker=function(){this.coverBlocker().style.display=
"none"};this.obj.updateNestedObjects=function(){this.vs[this.av].grid&&this.vs[this.av].grid.setSizes();this.vs[this.av].sched&&this.vs[this.av].sched.setSizes();this.vs[this.av].tabbar&&this.vs[this.av].tabbar.adjustOuterSize();this.vs[this.av].folders&&this.vs[this.av].folders.setSizes();this.vs[this.av].editor&&(_isIE||this.vs[this.av].editor._prepareContent(!0),this.vs[this.av].editor.setSizes());if(this.vs[this.av].layout)(this.vs[this.av].dhxcont._isAcc||this.vs[this.av].dhxcont._isTabbarCell)&&
this.vs[this.av].dhxcont.skin=="dhx_skyblue"?(this.vs[this.av].layoutObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+2+"px",this.vs[this.av].layoutObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+2+"px"):(this.vs[this.av].layoutObj.style.width=this.vs[this.av].dhxcont.mainCont[this.av].style.width,this.vs[this.av].layoutObj.style.height=this.vs[this.av].dhxcont.mainCont[this.av].style.height),this.vs[this.av].layout.setSizes();if(this.vs[this.av].accordion!=
null)this.skin=="dhx_web"?(this.vs[this.av].accordionObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+"px",this.vs[this.av].accordionObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+"px"):(this.vs[this.av].accordionObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+2+"px",this.vs[this.av].accordionObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+2+"px"),this.vs[this.av].accordion.setSizes();
this.vs[this.av].dockedCell&&this.vs[this.av].dockedCell.updateNestedObjects();this.vs[this.av].form&&this.vs[this.av].form.setSizes()};this.obj.attachStatusBar=function(){if(!this.vs[this.av].sb){var a=document.createElement("DIV");a.className=this._isCell?"dhxcont_sb_container_layoutcell":"dhxcont_sb_container";a.id="sbobj_"+this._genStr(12);a.innerHTML="<div class='dhxcont_statusbar'></div>";this.cv==this.av?this.vs[this.av].dhxcont.insertBefore(a,this.vs[this.av].dhxcont.childNodes[this.vs[this.av].dhxcont.childNodes.length-
1]):c.st.appendChild(a);a.setText=function(a){this.childNodes[0].innerHTML=a};a.getText=function(){return this.childNodes[0].innerHTML};a.onselectstart=function(a){a=a||event;return a.returnValue=!1};this.vs[this.av].sb=a;this.vs[this.av].sbHeight=this.skin=="dhx_web"?41:this.skin=="dhx_skyblue"?23:a.offsetHeight;this.vs[this.av].sbId=a.id;this._doOnAttachStatusBar&&this._doOnAttachStatusBar("init");this.adjust();return this.vs[this._viewRestore()].sb}};this.obj.detachStatusBar=function(){if(this.vs[this.av].sb)this.vs[this.av].sb.setText=
null,this.vs[this.av].sb.getText=null,this.vs[this.av].sb.onselectstart=null,this.vs[this.av].sb.parentNode.removeChild(this.vs[this.av].sb),this.vs[this.av].sb=null,this.vs[this.av].sbHeight=null,this.vs[this.av].sbId=null,this._viewRestore(),this._doOnAttachStatusBar&&this._doOnAttachStatusBar("unload")};this.obj.getFrame=function(){return this.getView()._frame};this.obj.getView=function(a){return this.vs[a||this.av]};this.obj.attachMenu=function(a){if(!this.vs[this.av].menu){var b=document.createElement("DIV");
b.style.position="relative";b.style.overflow="hidden";b.id="dhxmenu_"+this._genStr(12);this.cv==this.av?this.vs[this.av].dhxcont.insertBefore(b,this.vs[this.av].dhxcont.childNodes[0]):c.st.appendChild(b);typeof a!="object"?this.vs[this.av].menu=new dhtmlXMenuObject(b.id,a||this.skin):(a.parent=b.id,this.vs[this.av].menu=new dhtmlXMenuObject(a));this.vs[this.av].menuHeight=this.skin=="dhx_web"?29:b.offsetHeight;this.vs[this.av].menuId=b.id;this._doOnAttachMenu&&this._doOnAttachMenu("init");this.adjust();
return this.vs[this._viewRestore()].menu}};this.obj.detachMenu=function(){if(this.vs[this.av].menu){var a=document.getElementById(this.vs[this.av].menuId);this.vs[this.av].menu.unload();this.vs[this.av].menu=null;this.vs[this.av].menuId=null;this.vs[this.av].menuHeight=null;a&&a.parentNode.removeChild(a);a=null;this._viewRestore();this._doOnAttachMenu&&this._doOnAttachMenu("unload")}};this.obj.attachToolbar=function(a){if(!this.vs[this.av].toolbar){var b=document.createElement("DIV");b.style.position=
"relative";b.style.overflow="hidden";b.id="dhxtoolbar_"+this._genStr(12);this.cv==this.av?this.vs[this.av].dhxcont.insertBefore(b,this.vs[this.av].dhxcont.childNodes[this.vs[this.av].menu!=null?1:0]):c.st.appendChild(b);typeof a!="object"?this.vs[this.av].toolbar=new dhtmlXToolbarObject(b.id,a||this.skin):(a.parent=b.id,this.vs[this.av].toolbar=new dhtmlXToolbarObject(a));this.vs[this.av].toolbarHeight=this.skin=="dhx_web"?41:b.offsetHeight+(this._isLayout&&this.skin=="dhx_skyblue"?2:0);this.vs[this.av].toolbarId=
b.id;this._doOnAttachToolbar&&this._doOnAttachToolbar("init");this.adjust();return this.vs[this._viewRestore()].toolbar}};this.obj.detachToolbar=function(){if(this.vs[this.av].toolbar){var a=document.getElementById(this.vs[this.av].toolbarId);this.vs[this.av].toolbar.unload();this.vs[this.av].toolbar=null;this.vs[this.av].toolbarId=null;this.vs[this.av].toolbarHeight=null;a&&a.parentNode.removeChild(a);a=null;this._viewRestore();this._doOnAttachToolbar&&this._doOnAttachToolbar("unload")}};this.obj.attachGrid=
function(){if(this._isWindow&&this.skin=="dhx_skyblue")this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this._redraw();var a=document.createElement("DIV");a.id="dhxGridObj_"+this._genStr(12);a.style.width="100%";a.style.height="100%";a.cmp="grid";document.body.appendChild(a);this.attachObject(a.id,!1,!0);this.vs[this.av].grid=new dhtmlXGridObject(a.id);this.vs[this.av].grid.setSkin(this.skin);if(this.skin!="dhx_web")this.vs[this.av].grid.entBox.style.border="0px solid white",
this.vs[this.av].grid._sizeFix=0;this.vs[this.av].gridId=a.id;this.vs[this.av].gridObj=a;return this.vs[this._viewRestore()].grid};this.obj.attachScheduler=function(a,b,c){if(c)g=document.getElementById(c);else{var g=document.createElement("DIV");g.id="dhxSchedObj_"+this._genStr(12);g.innerHTML='<div id="'+g.id+'" class="dhx_cal_container" style="width:100%; height:100%;"><div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;</div><div class="dhx_cal_next_button">&nbsp;</div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div><div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"></div></div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div></div>';
document.body.appendChild(g.firstChild)}this.attachObject(g.id,!1,!0);this.vs[this.av].sched=scheduler;this.vs[this.av].schedId=g.id;scheduler.setSizes=scheduler.update_view;scheduler.destructor=function(){};scheduler.init(g.id,a,b);return this.vs[this._viewRestore()].sched};this.obj.attachTree=function(a){if(this._isWindow&&this.skin=="dhx_skyblue")this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this._redraw();var b=document.createElement("DIV");b.id="dhxTreeObj_"+this._genStr(12);
b.style.width="100%";b.style.height="100%";b.cmp="tree";document.body.appendChild(b);this.attachObject(b.id,!1,!0);this.vs[this.av].tree=new dhtmlXTreeObject(b.id,"100%","100%",a||0);this.vs[this.av].tree.setSkin(this.skin);this.vs[this.av].tree.allTree.childNodes[0].style.marginTop="2px";this.vs[this.av].tree.allTree.childNodes[0].style.marginBottom="2px";this.vs[this.av].treeId=b.id;this.vs[this.av].treeObj=b;return this.vs[this._viewRestore()].tree};this.obj.attachTabbar=function(a){if(this._isWindow&&
this.skin=="dhx_skyblue")this.vs[this.av].dhxcont.style.border="none",this.setDimension(this.w,this.h);var b=document.createElement("DIV");b.id="dhxTabbarObj_"+this._genStr(12);b.style.width="100%";b.style.height="100%";b.style.overflow="hidden";b.cmp="tabbar";document.body.appendChild(b);this.attachObject(b.id,!1,!0);this.className=="dhtmlxLayoutSinglePoly"&&this.hideHeader();this.vs[this.av].tabbar=new dhtmlXTabBar(b.id,a||"top",20);if(!this._isWindow)this.vs[this.av].tabbar._s.expand=!0;this.vs[this.av].tabbar.setSkin(this.skin);
this.vs[this.av].tabbar.adjustOuterSize();this.vs[this.av].tabbarId=b.id;this.vs[this.av].tabbarObj=b;return this.vs[this._viewRestore()].tabbar};this.obj.attachFolders=function(){if(this._isWindow&&this.skin=="dhx_skyblue")this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this._redraw();var a=document.createElement("DIV");a.id="dhxFoldersObj_"+this._genStr(12);a.style.width="100%";a.style.height="100%";a.style.overflow="hidden";a.cmp="folders";document.body.appendChild(a);
this.attachObject(a.id,!1,!0);this.vs[this.av].folders=new dhtmlxFolders(a.id);this.vs[this.av].folders.setSizes();this.vs[this.av].foldersId=a.id;this.vs[this.av].foldersObj=a;return this.vs[this._viewRestore()].folders};this.obj.attachAccordion=function(){if(this._isWindow&&this.skin=="dhx_skyblue")this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this._redraw();var a=document.createElement("DIV");a.id="dhxAccordionObj_"+this._genStr(12);this.skin=="dhx_web"?(a.style.left=
"0px",a.style.top="0px",a.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+"px",a.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+"px"):(a.style.left="-1px",a.style.top="-1px",a.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+2+"px",a.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+2+"px");a.style.position="relative";a.cmp="accordion";document.body.appendChild(a);this.attachObject(a.id,
!1,!0);this.vs[this.av].accordion=new dhtmlXAccordion(a.id,this.skin);this.vs[this.av].accordion.setSizes();this.vs[this.av].accordionId=a.id;this.vs[this.av].accordionObj=a;return this.vs[this._viewRestore()].accordion};this.obj.attachLayout=function(a,b){if(this._isCell&&this.skin=="dhx_skyblue")this.hideHeader(),this.vs[this.av].dhxcont.style.border="0px solid white",this.adjustContent(this.childNodes[0],0);this._isCell&&this.skin=="dhx_web"&&this.hideHeader();var c=document.createElement("DIV");
c.id="dhxLayoutObj_"+this._genStr(12);c.style.overflow="hidden";c.style.position="absolute";c.style.left="0px";c.style.top="0px";c.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+"px";c.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+"px";if((this._isTabbarCell||this._isAcc)&&this.skin=="dhx_skyblue")c.style.left="-1px",c.style.top="-1px",c.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+2+"px",c.style.height=
parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+2+"px";c.dhxContExists=!0;c.cmp="layout";document.body.appendChild(c);this.attachObject(c.id,!1,!0);this.vs[this.av].layout=new dhtmlXLayoutObject(c,a,b||this.skin);this._isWindow&&this.attachEvent("_onBeforeTryResize",this.vs[this.av].layout._defineWindowMinDimension);this.vs[this.av].layoutId=c.id;this.vs[this.av].layoutObj=c;return this.vs[this._viewRestore()].layout};this.obj.attachEditor=function(){if(this._isWindow&&this.skin==
"dhx_skyblue")this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this._redraw();var a=document.createElement("DIV");a.id="dhxEditorObj_"+this._genStr(12);a.style.position="relative";a.style.display="none";a.style.overflow="hidden";a.style.width="100%";a.style.height="100%";a.cmp="editor";document.body.appendChild(a);this.attachObject(a.id,!1,!0);this.vs[this.av].editor=new dhtmlXEditor(a.id,this.skin);this.vs[this.av].editorId=a.id;this.vs[this.av].editorObj=a;return this.vs[this._viewRestore()].editor};
this.obj.attachMap=function(a){var b=document.createElement("DIV");b.id="GMapsObj_"+this._genStr(12);b.style.position="relative";b.style.display="none";b.style.overflow="hidden";b.style.width="100%";b.style.height="100%";b.cmp="gmaps";document.body.appendChild(b);this.attachObject(b.id,!1,!0);a||(a={center:new google.maps.LatLng(40.719837,-73.992348),zoom:11,mapTypeId:google.maps.MapTypeId.ROADMAP});this.vs[this.av].gmaps=new google.maps.Map(b,a);return this.vs[this.av].gmaps};this.obj.attachObject=
function(a,b,c){typeof a=="string"&&(a=document.getElementById(a));if(b){a.style.visibility="hidden";a.style.display="";var g=a.offsetWidth,f=a.offsetHeight}this._attachContent("obj",a);if(b&&this._isWindow)a.style.visibility="",this._adjustToContent(g,f);c||this._viewRestore()};this.obj.detachObject=function(a,b){for(var c=null,g=null,f="tree,grid,layout,tabbar,accordion,folders".split(","),i=0;i<f.length;i++)if(this.vs[this.av][f[i]]){c=this.vs[this.av][f[i]];g=this.vs[this.av][f[i]+"Obj"];if(a){c.unload&&
c.unload();for(c.destructor&&c.destructor();g.childNodes.length>0;)g.removeChild(g.childNodes[0]);g.parentNode.removeChild(g);c=g=null}else document.body.appendChild(g),g.style.display="none";this.vs[this.av][f[i]]=null;this.vs[this.av][f[i]+"Id"]=null;this.vs[this.av][f[i]+"Obj"]=null}if(c!=null&&g!=null)return[c,g];if(a&&this.vs[this.av]._frame)this._detachURLEvents(),this.vs[this.av]._frame=null;for(var j=this.vs[this.av].dhxcont.mainCont[this.av];j.childNodes.length>0;)if(a==!0)j.removeChild(j.childNodes[0]);
else{var k=j.childNodes[0];b!=null?(typeof b!="object"&&(b=document.getElementById(b)),b.appendChild(k)):document.body.appendChild(k);k.style.display="none"}};this.obj.appendObject=function(a){typeof a=="string"&&(a=document.getElementById(a));this._attachContent("obj",a,!0)};this.obj.attachHTMLString=function(a){this._attachContent("str",a);for(var b=a.match(/<script[^>]*>[^\f]*?<\/script>/g)||[],c=0;c<b.length;c++){var g=b[c].replace(/<([\/]{0,1})script[^>]*>/g,"");g&&(window.execScript?window.execScript(g):
window.eval(g))}};this.obj.attachURL=function(a,b){this._attachContent(b==!0?"urlajax":"url",a,!1);this._viewRestore()};this.obj.adjust=function(){if(this.skin=="dhx_skyblue"){if(this.vs[this.av].menu){if(this._isWindow||this._isLayout)this.vs[this.av].menu._topLevelOffsetLeft=0,document.getElementById(this.vs[this.av].menuId).style.height="26px",this.vs[this.av].menuHeight=document.getElementById(this.vs[this.av].menuId).offsetHeight,this._doOnAttachMenu&&this._doOnAttachMenu("show");if(this._isCell)document.getElementById(this.vs[this.av].menuId).className+=
" in_layoutcell",this.vs[this.av].menuHeight=25;if(this._isAcc)document.getElementById(this.vs[this.av].menuId).className+=" in_acccell",this.vs[this.av].menuHeight=25;this._doOnAttachMenu&&this._doOnAttachMenu("adjust")}if(this.vs[this.av].toolbar){if(this._isWindow||this._isLayout)document.getElementById(this.vs[this.av].toolbarId).style.height="29px",this.vs[this.av].toolbarHeight=document.getElementById(this.vs[this.av].toolbarId).offsetHeight,this._doOnAttachToolbar&&this._doOnAttachToolbar("show");
this._isCell&&(document.getElementById(this.vs[this.av].toolbarId).className+=" in_layoutcell");this._isAcc&&(document.getElementById(this.vs[this.av].toolbarId).className+=" in_acccell")}}};this.obj._attachContent=function(a,b,c){if(c!==!0){if(this.vs[this.av]._frame)this._detachURLEvents(),this.vs[this.av]._frame=null;for(;this.vs[this.av].dhxcont.mainCont[this.av].childNodes.length>0;)this.vs[this.av].dhxcont.mainCont[this.av].removeChild(this.vs[this.av].dhxcont.mainCont[this.av].childNodes[0])}if(a==
"url"){if(this._isWindow&&b.cmp==null&&this.skin=="dhx_skyblue")this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this._redraw();var g=document.createElement("IFRAME");g.frameBorder=0;g.border=0;g.style.width="100%";g.style.height="100%";g.setAttribute("src","javascript:false;");this.vs[this.av].dhxcont.mainCont[this.av].appendChild(g);g.src=b;this.vs[this.av]._frame=g;this._attachURLEvents()}else if(a=="urlajax"){if(this._isWindow&&b.cmp==null&&this.skin=="dhx_skyblue")this.vs[this.av].dhxcont.mainCont[this.av].style.border=
"#a4bed4 1px solid",this.vs[this.av].dhxcont.mainCont[this.av].style.backgroundColor="#FFFFFF",this._redraw();var f=this,i=String(this.av).valueOf(),j=function(){var a=f.av;f.av=i;f.attachHTMLString(this.xmlDoc.responseText,this);f.av=a;f._doOnFrameContentLoaded&&f._doOnFrameContentLoaded();this.destructor()},k=new dtmlXMLLoaderObject(j,window);k.dhxWindowObject=this;k.loadXML(b)}else if(a=="obj"){if(this._isWindow&&b.cmp==null&&this.skin=="dhx_skyblue")this.vs[this.av].dhxcont.mainCont[this.av].style.border=
"#a4bed4 1px solid",this.vs[this.av].dhxcont.mainCont[this.av].style.backgroundColor="#FFFFFF",this._redraw();this.vs[this.av].dhxcont._frame=null;this.vs[this.av].dhxcont.mainCont[this.av].appendChild(b);this.vs[this.av].dhxcont.mainCont[this.av].style.overflow=c===!0?"auto":"hidden";b.style.display=""}else if(a=="str"){if(this._isWindow&&b.cmp==null&&this.skin=="dhx_skyblue")this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this.vs[this.av].dhxcont.mainCont[this.av].style.backgroundColor=
"#FFFFFF",this._redraw();this.vs[this.av].dhxcont._frame=null;this.vs[this.av].dhxcont.mainCont[this.av].innerHTML=b}};this.obj._attachURLEvents=function(){var a=this,b=this.vs[this.av]._frame;_isIE?b.onreadystatechange=function(){if(b.readyState=="complete"){try{b.contentWindow.document.body.onmousedown=function(){a._doOnFrameMouseDown&&a._doOnFrameMouseDown()}}catch(c){}try{a._doOnFrameContentLoaded&&a._doOnFrameContentLoaded()}catch(g){}}}:b.onload=function(){try{b.contentWindow.onmousedown=function(){a._doOnFrameMouseDown&&
a._doOnFrameMouseDown()}}catch(c){}try{a._doOnFrameContentLoaded&&a._doOnFrameContentLoaded()}catch(g){}}};this.obj._detachURLEvents=function(){if(_isIE)try{this.vs[this.av]._frame.onreadystatechange=null,this.vs[this.av]._frame.contentWindow.document.body.onmousedown=null,this.vs[this.av]._frame.onload=null}catch(a){}else try{this.vs[this.av]._frame.contentWindow.onmousedown=null,this.vs[this.av]._frame.onload=null}catch(b){}};this.obj.showMenu=function(){if(this.vs[this.av].menu&&this.vs[this.av].menuId&&
document.getElementById(this.vs[this.av].menuId).style.display=="none")this.vs[this.av].menuHidden=!1,this._doOnAttachMenu&&this._doOnAttachMenu("show"),document.getElementById(this.vs[this.av].menuId).style.display="",this._viewRestore()};this.obj.hideMenu=function(){if(this.vs[this.av].menu&&this.vs[this.av].menuId&&document.getElementById(this.vs[this.av].menuId).style.display!="none")document.getElementById(this.vs[this.av].menuId).style.display="none",this.vs[this.av].menuHidden=!0,this._doOnAttachMenu&&
this._doOnAttachMenu("hide"),this._viewRestore()};this.obj.showToolbar=function(){if(this.vs[this.av].toolbar&&this.vs[this.av].toolbarId&&document.getElementById(this.vs[this.av].toolbarId).style.display=="none")this.vs[this.av].toolbarHidden=!1,this._doOnAttachToolbar&&this._doOnAttachToolbar("show"),document.getElementById(this.vs[this.av].toolbarId).style.display="",this._viewRestore()};this.obj.hideToolbar=function(){if(this.vs[this.av].toolbar&&this.vs[this.av].toolbarId&&document.getElementById(this.vs[this.av].toolbarId).style.display!=
"none")this.vs[this.av].toolbarHidden=!0,document.getElementById(this.vs[this.av].toolbarId).style.display="none",this._doOnAttachToolbar&&this._doOnAttachToolbar("hide"),this._viewRestore()};this.obj.showStatusBar=function(){if(this.vs[this.av].sb&&this.vs[this.av].sbId&&document.getElementById(this.vs[this.av].sbId).style.display=="none")this.vs[this.av].sbHidden=!1,this._doOnAttachStatusBar&&this._doOnAttachStatusBar("show"),document.getElementById(this.vs[this.av].sbId).style.display="",this._viewRestore()};
this.obj.hideStatusBar=function(){if(this.vs[this.av].sb&&this.vs[this.av].sbId&&document.getElementById(this.vs[this.av].sbId).style.display!="none")this.vs[this.av].sbHidden=!0,document.getElementById(this.vs[this.av].sbId).style.display="none",this._doOnAttachStatusBar&&this._doOnAttachStatusBar("hide"),this._viewRestore()};this.obj._dhxContDestruct=function(){var a=this.av,b;for(b in this.vs)this.av=b,this.detachMenu(),this.detachToolbar(),this.detachStatusBar(),this.detachObject(!0),this.vs[b].dhxcont.mainCont[b].parentNode.removeChild(this.vs[b].dhxcont.mainCont[b]),
this.vs[b].dhxcont.mainCont[b]=null;this.vs[this.dv].dhxcont.mainCont=null;this.vs[this.dv].dhxcont.parentNode.removeChild(this.vs[this.dv].dhxcont);for(b in this.vs)this.vs[b].dhxcont=null;this._dhxContDestruct=this._genStr=this._init=this._setPadding=this._viewRestore=this._detachURLEvents=this._attachURLEvents=this._attachContent=this.updateNestedObjects=this.hideCoverBlocker=this.showCoverBlocker=this.coverBlocker=this.adjustContent=this.moveContentTo=this.setMinContentSize=this.adjust=this.show=
this.view=this.attachURL=this.attachHTMLString=this.appendObject=this.detachObject=this.attachObject=this.attachEditor=this.attachLayout=this.attachAccordion=this.attachFolders=this.attachTabbar=this.attachTree=this.attachScheduler=this.attachGrid=this.hideStatusBar=this.hideToolbar=this.hideMenu=this.showStatusBar=this.showToolbar=this.showMenu=this.detachStatusBar=this.detachToolbar=this.detachMenu=this.attachStatusBar=this.attachToolbar=this.attachMenu=this.vs=null;c.st.parentNode.removeChild(c.st);
c.st=null;c.setContent=null;c.dhxcont=null;c=c.obj=null;if(dhtmlx.detaches)for(b in dhtmlx.detaches)dhtmlx.detaches[b](this)};if(dhtmlx.attaches)for(var b in dhtmlx.attaches)this.obj[b]=dhtmlx.attaches[b]}
function dhtmlXCalendarObject(a,c){this.i={};this.uid=function(){if(!this.uidd)this.uidd=(new Date).getTime();return this.uidd++};var b=null,d=typeof a=="string"?document.getElementById(a):a;d&&typeof d=="object"&&d.tagName&&String(d.tagName).toLowerCase()!="input"&&(b=d);d=null;if(typeof a!="object"||!a.length)a=[a];for(var e=0;e<a.length;e++)typeof a[e]=="string"&&(a[e]=document.getElementById(a[e])||null),a[e]!=null&&a[e].tagName&&String(a[e].tagName).toLowerCase()=="input"&&(this.i[this.uid()]=
a[e]),a[e]=null;this.skin=c||"dhx_skyblue";this.setSkin=function(a){this.skin=a;this.base.className="dhtmlxcalendar_container dhtmlxcalendar_skin_"+this.skin;this._ifrSize()};this.base=document.createElement("DIV");this.base.className="dhtmlxcalendar_container";this.base.style.display="none";b!=null?(this._hasParent=!0,b.appendChild(this.base),b=null):document.body.appendChild(this.base);this.setParent=function(a){this._hasParent&&(typeof a=="object"?a.appendChild(this.base):typeof a=="string"&&document.getElementById(a).appendChild(this.base))};
this.setSkin(this.skin);this.base.onclick=function(a){a=a||event;a.cancelBubble=!0};this.loadUserLanguage=function(a){if(this.langData[a]&&(this.lang=a,this.setWeekStartDay(this.langData[this.lang].weekstart),this.msCont))for(var b=0,c=0;c<this.msCont.childNodes.length;c++)for(var d=0;d<this.msCont.childNodes[c].childNodes.length;d++)this.msCont.childNodes[c].childNodes[d].innerHTML=this.langData[this.lang].monthesSNames[b++]};this.contMonth=document.createElement("DIV");this.contMonth.className=
"dhtmlxcalendar_month_cont";this.contMonth.onselectstart=function(a){a=a||event;a.cancelBubble=!0;return a.returnValue=!1};this.base.appendChild(this.contMonth);var h=document.createElement("UL");h.className="dhtmlxcalendar_line";this.contMonth.appendChild(h);var g=document.createElement("LI");g.className="dhtmlxcalendar_cell dhtmlxcalendar_month_hdr";g.innerHTML="<div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left\";'></div><span class='dhtmlxcalendar_month_label_month'>Month</span><span class='dhtmlxcalendar_month_label_year'>Year</span><div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right\";'></div>";
h.appendChild(g);var f=this;g.onclick=function(a){var a=a||event,b=a.target||a.srcElement;if(b.className&&b.className.indexOf("dhtmlxcalendar_month_arrow")===0){f._hideSelector();var c=b.parentNode.firstChild==b?-1:1;f._drawMonth(new Date(f._activeMonth.getFullYear(),f._activeMonth.getMonth()+c,1,0,0,0,0))}else b.className&&b.className=="dhtmlxcalendar_month_label_month"?(a.cancelBubble=!0,f._showSelector("month",31,21,"selector_month",!0)):b.className&&b.className=="dhtmlxcalendar_month_label_year"?
(a.cancelBubble=!0,f._showSelector("year",42,21,"selector_year",!0)):f._hideSelector()};this.contDays=document.createElement("DIV");this.contDays.className="dhtmlxcalendar_days_cont";this.base.appendChild(this.contDays);this.setWeekStartDay=function(a){a==0&&(a=7);this._wStart=Math.min(Math.max(isNaN(a)?1:a,1),7);this._drawDaysOfWeek()};this._drawDaysOfWeek=function(){if(this.contDays.childNodes.length==0){var a=document.createElement("UL");a.className="dhtmlxcalendar_line";this.contDays.appendChild(a)}else a=
this.contDays.firstChild;var b=this._wStart,c=this.langData[this.lang].daysSNames;c.push(String(this.langData[this.lang].daysSNames[0]).valueOf());for(var d=0;d<7;d++){if(a.childNodes[d]==null){var e=document.createElement("LI");a.appendChild(e)}else e=a.childNodes[d];e.className="dhtmlxcalendar_cell"+(b>=6?" dhtmlxcalendar_day_weekday_cell":"")+(d==0?"_first":"");e.innerHTML=c[b];++b>7&&(b=1)}this._activeMonth!=null&&this._drawMonth(this._activeMonth)};this._wStart=this.langData[this.lang].weekstart;
this.setWeekStartDay(this._wStart);this.contDates=document.createElement("DIV");this.contDates.className="dhtmlxcalendar_dates_cont";this.base.appendChild(this.contDates);this.contDates.onclick=function(a){var a=a||event,b=a.target||a.srcElement;if(b._date!=null&&!b._css_dis){var c=f._activeDate.getHours(),d=f._activeDate.getMinutes();if(!f.checkEvent("onBeforeChange")||f.callEvent("onBeforeChange",[new Date(b._date.getFullYear(),b._date.getMonth(),b._date.getDate(),c,d)])){if(f._activeDateCell!=
null)f._activeDateCell._css_date=!1,f._updateCellStyle(f._activeDateCell._q,f._activeDateCell._w);var e=f._hasParent&&f._activeDate.getFullYear()+"_"+f._activeDate.getMonth()!=b._date.getFullYear()+"_"+b._date.getMonth();f._nullDate=!1;f._activeDate=new Date(b._date.getFullYear(),b._date.getMonth(),b._date.getDate(),c,d);f._activeDateCell=b;f._activeDateCell._css_date=!0;f._activeDateCell._css_hover=!1;f._lastHover=null;f._updateCellStyle(f._activeDateCell._q,f._activeDateCell._w);e&&f._drawMonth(f._activeDate);
if(f._activeInp&&f.i[f._activeInp])f.i[f._activeInp].value=f._dateToStr(new Date(f._activeDate.getTime()));f._hasParent||f._hide();f.callEvent("onClick",[new Date(f._activeDate.getTime())])}}};this.contDates.onmouseover=function(a){var a=a||event,b=a.target||a.srcElement;if(b._date!=null)b._css_hover=!0,f._updateCellStyle(b._q,b._w),f._lastHover=b};this.contDates.onmouseout=function(){f._clearDayHover()};this._lastHover=null;this._clearDayHover=function(){if(this._lastHover)this._lastHover._css_hover=
!1,this._updateCellStyle(this._lastHover._q,this._lastHover._w),this._lastHover=null};for(e=0;e<6;e++){h=document.createElement("UL");h.className="dhtmlxcalendar_line";this.contDates.appendChild(h);for(var i=0;i<7;i++)g=document.createElement("LI"),g.className="dhtmlxcalendar_cell",h.appendChild(g)}this.contTime=document.createElement("DIV");this.contTime.className="dhtmlxcalendar_time_cont";this.base.appendChild(this.contTime);this.showTime=function(){if(String(this.base.className).search("dhtmlxcalendar_time_hidden")>
0)this.base.className=String(this.base.className).replace(/dhtmlxcalendar_time_hidden/gi,"");this._ifrSize()};this.hideTime=function(){String(this.base.className).search("dhtmlxcalendar_time_hidden")<0&&(this.base.className+=" dhtmlxcalendar_time_hidden");this._ifrSize()};h=document.createElement("UL");h.className="dhtmlxcalendar_line";this.contTime.appendChild(h);g=document.createElement("LI");g.className="dhtmlxcalendar_cell dhtmlxcalendar_time_hdr";g.innerHTML="<div class='dhtmlxcalendar_time_label'></div><span class='dhtmlxcalendar_label_hours'></span><span class='dhtmlxcalendar_label_colon'>:</span><span class='dhtmlxcalendar_label_minutes'></span>";
h.appendChild(g);g.onclick=function(a){var a=a||event,b=a.target||a.srcElement;b.className&&b.className=="dhtmlxcalendar_label_hours"?(a.cancelBubble=!0,f._showSelector("hours",3,115,"selector_hours",!0)):b.className&&b.className=="dhtmlxcalendar_label_minutes"?(a.cancelBubble=!0,f._showSelector("minutes",59,115,"selector_minutes",!0)):f._hideSelector()};this._activeMonth=null;this._activeDate=new Date;this._activeDateCell=null;this.setDate=function(a){this._nullDate=typeof a=="undefined"||a===""||
!a;a instanceof Date||(a=this._strToDate(String(a)),a=="Invalid Date"&&(a=new Date));var b=a.getTime();if(!this._isOutOfRange(b))this._activeDate=new Date(b),this._drawMonth(this._nullDate?new Date:this._activeDate),this._updateVisibleHours(),this._updateVisibleMinutes()};this.getDate=function(a){if(this._nullDate)return null;var b=new Date(this._activeDate.getTime());return a?this._dateToStr(b):b};this._drawMonth=function(a){if(a instanceof Date){isNaN(a.getFullYear())&&(a=new Date(this._activeMonth.getFullYear(),
this._activeMonth.getMonth(),1,0,0,0,0));this._activeMonth=new Date(a.getFullYear(),a.getMonth(),1,0,0,0,0);this._activeDateCell=null;var b=new Date(this._activeMonth.getTime()),c=b.getDay(),d=c-this._wStart;d<0&&(d+=7);b.setDate(b.getDate()-d);for(var e=a.getMonth(),f=(new Date(this._activeDate.getFullYear(),this._activeDate.getMonth(),this._activeDate.getDate(),0,0,0,0)).getTime(),g=0,h=0;h<6;h++)for(var i=this._wStart,j=0;j<7;j++){var q=new Date(b.getFullYear(),b.getMonth(),b.getDate()+g++,0,0,
0,0);this.contDates.childNodes[h].childNodes[j].innerHTML=q.getDate();var v=q.getDay(),w=q.getTime();this.contDates.childNodes[h].childNodes[j]._date=new Date(w);this.contDates.childNodes[h].childNodes[j]._q=h;this.contDates.childNodes[h].childNodes[j]._w=j;this.contDates.childNodes[h].childNodes[j]._css_month=q.getMonth()==e;this.contDates.childNodes[h].childNodes[j]._css_date=!this._nullDate&&w==f;this.contDates.childNodes[h].childNodes[j]._css_weekend=i>=6;this.contDates.childNodes[h].childNodes[j]._css_dis=
this._isOutOfRange(w);this.contDates.childNodes[h].childNodes[j]._css_holiday=this._holidays[w]==!0;this._updateCellStyle(h,j);if(w==f)this._activeDateCell=this.contDates.childNodes[h].childNodes[j];++i>7&&(i=1)}this.contMonth.firstChild.firstChild.childNodes[1].innerHTML=this.langData[this.lang].monthesFNames[a.getMonth()];this.contMonth.firstChild.firstChild.childNodes[2].innerHTML=a.getFullYear()}};this._updateCellStyle=function(a,b){var c=this.contDates.childNodes[a].childNodes[b],d="dhtmlxcalendar_cell dhtmlxcalendar_cell";
d+=c._css_month?"_month":"";d+=c._css_date?"_date":"";d+=c._css_weekend?"_weekend":"";d+=c._css_holiday?"_holiday":"";d+=c._css_dis?"_dis":"";d+=c._css_hover&&!c._css_dis?"_hover":"";c.className=d;c=null};this._initSelector=function(a,b){if(!this._selCover)this._selCover=document.createElement("DIV"),this._selCover.className="dhtmlxcalendar_selector_cover",this.base.appendChild(this._selCover);if(!this._sel)this._sel=document.createElement("DIV"),this._sel.className="dhtmlxcalendar_selector_obj",
this.base.appendChild(this._sel),this._sel.appendChild(document.createElement("TABLE")),this._sel.firstChild.className="dhtmlxcalendar_selector_table",this._sel.firstChild.cellSpacing=0,this._sel.firstChild.cellPadding=0,this._sel.firstChild.border=0,this._sel.firstChild.appendChild(document.createElement("TBODY")),this._sel.firstChild.firstChild.appendChild(document.createElement("TR")),this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),
this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),this._sel.firstChild.firstChild.firstChild.childNodes[0].className="dhtmlxcalendar_selector_cell_left",this._sel.firstChild.firstChild.firstChild.childNodes[1].className="dhtmlxcalendar_selector_cell_middle",this._sel.firstChild.firstChild.firstChild.childNodes[2].className="dhtmlxcalendar_selector_cell_right",this._sel.firstChild.firstChild.firstChild.childNodes[0].innerHTML="&nbsp;",this._sel.firstChild.firstChild.firstChild.childNodes[2].innerHTML=
"&nbsp;",this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_left dhtmlxcalendar_selector_cell_left_hover"},this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseout=function(){this.className="dhtmlxcalendar_selector_cell_left"},this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_right dhtmlxcalendar_selector_cell_right_hover"},this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseout=
function(){this.className="dhtmlxcalendar_selector_cell_right"},this._sel.firstChild.firstChild.firstChild.childNodes[0].onclick=function(a){a=a||event;a.cancelBubble=!0;f._scrollYears(-1)},this._sel.firstChild.firstChild.firstChild.childNodes[2].onclick=function(a){a=a||event;a.cancelBubble=!0;f._scrollYears(1)},this._sel._ta={},this._selHover=null,this._sel.onmouseover=function(a){var a=a||event,b=a.target||a.srcElement;if(b._cell===!0&&(f._selHover!=b&&f._clearSelHover(),String(b.className).match(/^\s{0,}dhtmlxcalendar_selector_cell\s{0,}$/gi)!=
null))b.className+=" dhtmlxcalendar_selector_cell_hover",f._selHover=b},this._sel.onmouseout=function(){f._clearSelHover()},this._sel.appendChild(document.createElement("DIV")),this._sel.lastChild.className="dhtmlxcalendar_selector_obj_arrow";if(this._sel._ta[a]!=!0){if(a=="month"){this._msCells={};this.msCont=document.createElement("DIV");this.msCont.className="dhtmlxcalendar_area_"+b;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.msCont);for(var c=0,d=0;d<4;d++){var e=
document.createElement("UL");e.className="dhtmlxcalendar_selector_line";this.msCont.appendChild(e);for(var h=0;h<3;h++){var g=document.createElement("LI");g.innerHTML=this.langData[this.lang].monthesSNames[c];g.className="dhtmlxcalendar_selector_cell";e.appendChild(g);g._month=c;g._cell=!0;this._msCells[c++]=g}}this.msCont.onclick=function(a){a=a||event;a.cancelBubble=!0;var b=a.target||a.srcElement;b._month!=null&&(f._hideSelector(),f._updateActiveMonth(),f._drawMonth(new Date(f._activeMonth.getFullYear(),
b._month,1,0,0,0,0)),f._doOnSelectorChange())}}if(a=="year"){this._ysCells={};this.ysCont=document.createElement("DIV");this.ysCont.className="dhtmlxcalendar_area_"+b;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.ysCont);for(d=0;d<4;d++){e=document.createElement("UL");e.className="dhtmlxcalendar_selector_line";this.ysCont.appendChild(e);for(h=0;h<3;h++)g=document.createElement("LI"),g.className="dhtmlxcalendar_selector_cell",g._cell=!0,e.appendChild(g)}this.ysCont.onclick=
function(a){a=a||event;a.cancelBubble=!0;var b=a.target||a.srcElement;b._year!=null&&(f._hideSelector(),f._drawMonth(new Date(b._year,f._activeMonth.getMonth(),1,0,0,0,0)),f._doOnSelectorChange())}}if(a=="hours"){this._hsCells={};this.hsCont=document.createElement("DIV");this.hsCont.className="dhtmlxcalendar_area_"+b;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.hsCont);for(d=c=0;d<4;d++){e=document.createElement("UL");e.className="dhtmlxcalendar_selector_line";this.hsCont.appendChild(e);
for(h=0;h<6;h++)g=document.createElement("LI"),g.innerHTML=this._fixLength(c,2),g.className="dhtmlxcalendar_selector_cell",e.appendChild(g),g._hours=c,g._cell=!0,this._hsCells[c++]=g}this.hsCont.onclick=function(a){a=a||event;a.cancelBubble=!0;var b=a.target||a.srcElement;b._hours!=null&&(f._hideSelector(),f._activeDate.setHours(b._hours),f._updateActiveHours(),f._updateVisibleHours(),f._doOnSelectorChange())}}if(a=="minutes"){this._rsCells={};this.rsCont=document.createElement("DIV");this.rsCont.className=
"dhtmlxcalendar_area_"+b;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.rsCont);for(d=c=0;d<4;d++){e=document.createElement("UL");e.className="dhtmlxcalendar_selector_line";this.rsCont.appendChild(e);for(h=0;h<3;h++)g=document.createElement("LI"),g.innerHTML=this._fixLength(c,2),g.className="dhtmlxcalendar_selector_cell",e.appendChild(g),g._minutes=c,g._cell=!0,this._rsCells[c]=g,c+=5}this.rsCont.onclick=function(a){a=a||event;a.cancelBubble=!0;var b=a.target||a.srcElement;
b._minutes!=null&&(f._hideSelector(),f._activeDate.setMinutes(b._minutes),f._updateActiveMinutes(),f._updateVisibleMinutes(),f._doOnSelectorChange())}}this._sel._ta[a]=!0}};this._showSelector=function(a,b,c,d,e){e===!0&&this._sel!=null&&this._isSelectorVisible()&&a==this._sel._t?this._hideSelector():((!this._sel||!this._sel._ta[a])&&this._initSelector(a,d),this._selCover.style.display="",this._sel._t=a,this._sel.style.left=b+"px",this._sel.style.top=c+"px",this._sel.style.display="",this._sel.className=
"dhtmlxcalendar_selector_obj dhtmlxcalendar_"+d,this._doOnSelectorShow(a))};this._doOnSelectorShow=function(a){a=="month"&&this._updateActiveMonth();a=="year"&&this._updateYearsList(this._activeMonth);a=="hours"&&this._updateActiveHours();a=="minutes"&&this._updateActiveMinutes()};this._hideSelector=function(){if(this._sel)this._sel.style.display="none",this._selCover.style.display="none"};this._isSelectorVisible=function(){return!this._sel?!1:this._sel.style.display!="none"};this._doOnSelectorChange=
function(a){this.callEvent("onChange",[new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),this._activeDate.getDate(),this._activeDate.getHours(),this._activeDate.getMinutes(),this._activeDate.getSeconds()),a])};this._clearSelHover=function(){if(this._selHover)this._selHover.className=String(this._selHover.className.replace(/dhtmlxcalendar_selector_cell_hover/gi,"")),this._selHover=null};this._updateActiveMonth=function(){if(typeof this._msActive!="undefined"&&typeof this._msCells[this._msActive]!=
"undefined")this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell";this._msActive=this._activeMonth.getMonth();this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateActiveYear=function(){var a=this._activeMonth.getFullYear();if(this._ysCells[a])this._ysCells[a].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateYearsList=function(a){for(var b in this._ysCells)this._ysCells[b]=null,
delete this._ysCells[b];for(var c=12*Math.floor(a.getFullYear()/12),d=0;d<4;d++)for(var e=0;e<3;e++)this.ysCont.childNodes[d].childNodes[e].innerHTML=c,this.ysCont.childNodes[d].childNodes[e]._year=c,this.ysCont.childNodes[d].childNodes[e].className="dhtmlxcalendar_selector_cell",this._ysCells[c++]=this.ysCont.childNodes[d].childNodes[e];this._updateActiveYear()};this._scrollYears=function(a){var b=(a<0?this.ysCont.firstChild.firstChild._year:this.ysCont.lastChild.lastChild._year)+a,c=new Date(b,
this._activeMonth.getMonth(),1,0,0,0,0);this._updateYearsList(c)};this._updateActiveHours=function(){if(typeof this._hsActive!="undefined"&&typeof this._hsCells[this._hsActive]!="undefined")this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell";this._hsActive=this._activeDate.getHours();this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateVisibleHours=function(){this.contTime.firstChild.firstChild.childNodes[1].innerHTML=
this._fixLength(this._activeDate.getHours(),2)};this._updateActiveMinutes=function(){if(typeof this._rsActive!="undefined"&&typeof this._rsCells[this._rsActive]!="undefined")this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell";this._rsActive=this._activeDate.getMinutes();if(typeof this._rsCells[this._rsActive]!="undefined")this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateVisibleMinutes=function(){this.contTime.firstChild.firstChild.childNodes[3].innerHTML=
this._fixLength(this._activeDate.getMinutes(),2)};this._fixLength=function(a,b){for(;String(a).length<b;)a="0"+String(a);return a};this._dateFormat="";this._dateFormatRE=null;this.setDateFormat=function(a){this._dateFormat=a;this._dateFormatRE=RegExp(String(this._dateFormat).replace(/%[a-zA-Z]+/g,function(a){var b=a.replace(/%/,"");switch(b){case "n":case "j":case "g":case "G":return"\\d{1,2}";case "m":case "d":case "H":case "i":case "s":case "y":return"\\d{2}";case "Y":return"\\d{4}";case "M":return"("+
f.langData[f.lang].monthesSNames.join("|").toLowerCase()+"){1,}";case "F":return"("+f.langData[f.lang].monthesFNames.join("|").toLowerCase()+"){1,}"}return a}),"i")};this.setDateFormat("%Y-%m-%d");this._getInd=function(a,b){for(var c=0;c<b.length;c++)if(b[c].toLowerCase()==a)return c;return-1};this._strToDate=function(a,b){var b=b||this._dateFormat,c=a.match(/[a-z0-9]{1,}/gi),d=b.match(/%[a-zA-Z]/g);if(!c)return"Invalid Date";for(var e=new Date,g=0;g<c.length;g++)switch(d[g]){case "%d":case "%j":case "%d":case "%j":case "%n":case "%m":case "%Y":case "%H":case "%G":case "%i":case "%s":if(!isNaN(c[g]))e[{"%d":"setDate",
"%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds"}[d[g]]](Number(c[g])+(d[g]=="%m"||d[g]=="%n"?-1:0));break;case "%M":case "%F":var h=this._getInd(c[g].toLowerCase(),f.langData[f.lang][{"%M":"monthesSNames","%F":"monthesFNames"}[d[g]]]);h>=0&&e.setMonth(h);break;case "%y":if(!isNaN(c[g])){var i=Number(c[g]);e.setFullYear(i+(i>50?1900:2E3))}break;case "%g":case "%h":isNaN(c[g])||(i=Number(c[g]),i<=12&&i>=0&&e.setHours(i+
(this._getInd("pm",c)>=0?12:0)))}return e};this._dateToStr=function(a,b){if(a instanceof Date)var c=function(a){return String(a).length==1?"0"+String(a):a},d=function(b){switch(b){case "%d":return c(a.getDate());case "%j":return a.getDate();case "%D":return f.langData[f.lang].daysSNames[a.getDay()];case "%l":return f.langData[f.lang].daysFNames[a.getDay()];case "%m":return c(a.getMonth()+1);case "%n":return a.getMonth()+1;case "%M":return f.langData[f.lang].monthesSNames[a.getMonth()];case "%F":return f.langData[f.lang].monthesFNames[a.getMonth()];
case "%y":return c(a.getYear()%100);case "%Y":return a.getFullYear();case "%g":return(a.getHours()+11)%12+1;case "%h":return c((a.getHours()+11)%12+1);case "%G":return a.getHours();case "%H":return c(a.getHours());case "%i":return c(a.getMinutes());case "%s":return c(a.getSeconds());case "%a":return a.getHours()>11?"pm":"am";case "%A":return a.getHours()>11?"PM":"AM";default:return b}},e=String(b||this._dateFormat).replace(/%[a-zA-Z]/g,d);return e||String(a)};this._updateDateStr=function(a){if(a==
"")this.setDate(new Date),this.callEvent("onChange",[null,!0]);else if(this._dateFormatRE&&a.match(this._dateFormatRE)){var b=this._strToDate(a);if(b instanceof Date)this._nullDate=!1,this._activeDate=b,this._drawMonth(this._nullDate?new Date:this._activeDate),this._updateVisibleMinutes(),this._updateVisibleHours(),this._sel&&this._isSelectorVisible()&&this._doOnSelectorShow(this._sel._t),this._doOnSelectorChange(!0)}};this.setFormatedDate=function(a,b,c,d){var e=this._strToDate(b,a);if(d)return e;
this.setDate(e)};this.getFormatedDate=function(a,b){if(this._nullDate)return"";b&&b instanceof Date||(b=new Date(this._activeDate));return this._dateToStr(b,a)};this.show=function(a){if(!a&&this._hasParent)this._show();else if(typeof a=="object"&&typeof a._dhtmlxcalendar_uid!="undefined"&&this.i[a._dhtmlxcalendar_uid]==a)this._show(a._dhtmlxcalendar_uid);else{if(typeof a=="undefined")for(var b in this.i)a||(a=b);a&&this._show(a)}};this.hide=function(){this._isVisible()&&this._hide()};this.isVisible=
function(){return this._isVisible()};this.draw=function(){this.show()};this.close=function(){this.hide()};this._activeInp=null;this.pos="bottom";this.setPosition=function(a,b){this._py=this._px=null;if(a=="right"||a=="bottom")this.pos=a;else{this.pos="int";if(typeof a!="undefined"&&!isNaN(a))this.base.style.left=a+"px",this._px=a;if(typeof b!="undefined"&&!isNaN(b))this.base.style.top=b+"px",this._py=b;this._ifrSize()}};this._show=function(a,b){if(b===!0&&this._activeInp==a&&this._isVisible())this._hide();
else if(a?(this.pos=="right"?(this.base.style.left=this._getLeft(this.i[a])+this.i[a].offsetWidth-1+"px",this.base.style.top=this._getTop(this.i[a])+"px"):this.pos=="bottom"?(this.base.style.left=this._getLeft(this.i[a])+"px",this.base.style.top=this._getTop(this.i[a])+this.i[a].offsetHeight-1+"px"):(this.base.style.left=(this._px||0)+"px",this.base.style.top=(this._py||0)+"px"),this._activeInp=a):this._px&&this._py?(this.base.style.left=this._px+"px",this.base.style.top=this._py+"px"):(this.base.style.left=
"0px",this.base.style.top="0px"),this._hideSelector(),this.base.style.display="",this._ifrSize(),this._ifr)this._ifr.style.display=""};this._hide=function(){this._hideSelector();this.base.style.display="none";this._activeInp=null;if(this._ifr)this._ifr.style.display="none"};this._isVisible=function(){return this.base.style.display!="none"};this._getLeft=function(a){return this._posGetOffset(a).left};this._getTop=function(a){return this._posGetOffset(a).top};this._posGetOffsetSum=function(a){for(var b=
0,c=0;a;)b+=parseInt(a.offsetTop),c+=parseInt(a.offsetLeft),a=a.offsetParent;return{top:b,left:c}};this._posGetOffsetRect=function(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,g=d.clientTop||c.clientTop||0,h=d.clientLeft||c.clientLeft||0,i=b.top+e-g,j=b.left+f-h;return{top:Math.round(i),left:Math.round(j)}};this._posGetOffset=function(a){return this[a.getBoundingClientRect?
"_posGetOffsetRect":"_posGetOffsetSum"](a)};this._rangeActive=!1;this._rangeTo=this._rangeFrom=null;this._rangeSet={};this.setInsensitiveDays=function(a){for(var b=this._extractDates(a),c=0;c<b.length;c++)this._rangeSet[(new Date(b[c].getFullYear(),b[c].getMonth(),b[c].getDate(),0,0,0,0)).getTime()]=!0;this._drawMonth(this._activeMonth)};this.clearInsensitiveDays=function(){this._clearRangeSet();this._drawMonth(this._activeMonth)};this._holidays={};this.setHolidays=function(a){if(a==null)this._clearHolidays();
else if(a!=null)for(var b=this._extractDates(a),c=0;c<b.length;c++)this._holidays[(new Date(b[c].getFullYear(),b[c].getMonth(),b[c].getDate(),0,0,0,0)).getTime()]=!0;this._drawMonth(this._activeMonth)};this._extractDates=function(a){if(typeof a=="string"||a instanceof Date)a=[a];for(var b=[],c=0;c<a.length;c++)if(typeof a[c]=="string")for(var d=a[c].split(","),e=0;e<d.length;e++)b.push(this._strToDate(d[e]));else a[c]instanceof Date&&b.push(a[c]);return b};this._clearRange=function(){this._rangeActive=
!1;this._rangeTo=this._rangeFrom=this._rangeType=null};this._clearRangeSet=function(){for(var a in this._rangeSet)this._rangeSet[a]=null,delete this._rangeSet[a]};this._clearHolidays=function(){for(var a in this._holidays)this._holidays[a]=null,delete this._holidays[a]};this._isOutOfRange=function(a){if(this._rangeSet[a]==!0)return!0;if(this._rangeActive){if(this._rangeType=="in"&&(a<this._rangeFrom||a>this._rangeTo))return!0;if(this._rangeType=="out"&&a>=this._rangeFrom&&a<=this._rangeTo)return!0;
if(this._rangeType=="from"&&a<this._rangeFrom)return!0;if(this._rangeType=="to"&&a>this._rangeTo)return!0}var b=new Date(a);return this._rangeWeek&&this._rangeWeekData[b.getDay()]===!0?!0:this._rangeMonth&&this._rangeMonthData[b.getDate()]===!0?!0:this._rangeYear&&this._rangeYearData[b.getMonth()+"_"+b.getDate()]===!0?!0:!1};this.clearSensitiveRange=function(){this._clearRange();this._drawMonth(this._activeMonth)};this.setSensitiveRange=function(a,b,c){var d=!1;if(a!=null&&b!=null){a instanceof Date||
(a=this._strToDate(a));b instanceof Date||(b=this._strToDate(b));if(a.getTime()>b.getTime())return;this._rangeFrom=(new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)).getTime();this._rangeTo=(new Date(b.getFullYear(),b.getMonth(),b.getDate(),0,0,0,0)).getTime();this._rangeActive=!0;this._rangeType="in";d=!0}if(!d&&a!=null&&b==null)a instanceof Date||(a=this._strToDate(a)),this._rangeFrom=(new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)).getTime(),this._rangeTo=null,c===!0&&this._rangeFrom++,
this._rangeActive=!0,this._rangeType="from",d=!0;if(!d&&a==null&&b!=null)b instanceof Date||(b=this._strToDate(b)),this._rangeFrom=null,this._rangeTo=(new Date(b.getFullYear(),b.getMonth(),b.getDate(),0,0,0,0)).getTime(),c===!0&&this._rangeTo--,this._rangeActive=!0,this._rangeType="to",d=!0;d&&this._drawMonth(this._activeMonth)};this.setInsensitiveRange=function(a,b){if(a!=null&&b!=null){if(a instanceof Date||(a=this._strToDate(a)),b instanceof Date||(b=this._strToDate(b)),!(a.getTime()>b.getTime()))this._rangeFrom=
(new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)).getTime(),this._rangeTo=(new Date(b.getFullYear(),b.getMonth(),b.getDate(),0,0,0,0)).getTime(),this._rangeActive=!0,this._rangeType="out",this._drawMonth(this._activeMonth)}else a!=null&&b==null?this.setSensitiveRange(null,a,!0):a==null&&b!=null&&this.setSensitiveRange(b,null,!0)};this.disableDays=function(a,b){if(a=="week"){typeof b!="object"&&typeof b.length=="undefined"&&(b=[b]);if(!this._rangeWeekData)this._rangeWeekData={};for(var c in this._rangeWeekData)this._rangeWeekData[c]=
!1,delete this._rangeWeekData[c];for(var d=0;d<b.length;d++)this._rangeWeekData[b[d]]=!0,b[d]==7&&(this._rangeWeekData[0]=!0);this._rangeWeek=!0}if(a=="month"){typeof b!="object"&&typeof b.length=="undefined"&&(b=[b]);if(!this._rangeMonthData)this._rangeMonthData={};for(c in this._rangeMonthData)this._rangeMonthData[c]=!1,delete this._rangeMonthData[c];for(d=0;d<b.length;d++)this._rangeMonthData[b[d]]=!0;this._rangeMonth=!0}if(a=="year"){var e=this._extractDates(b);if(!this._rangeYearData)this._rangeYearData=
{};for(c in this._rangeYearData)this._rangeYearData[c]=!1,delete this._rangeYearData[c];for(d=0;d<e.length;d++)this._rangeYearData[e[d].getMonth()+"_"+e[d].getDate()]=!0;this._rangeYear=!0}this._drawMonth(this._activeMonth)};this.enableDays=function(a){if(a=="week")this._rangeWeek=!1;if(a=="month")this._rangeMonth=!1;if(a=="year")this._rangeYear=!1;this._drawMonth(this._activeMonth)};this._doOnClick=function(a){var a=a||event,b=a.target||a.srcElement;if(b._dhtmlxcalendar_uid&&b._dhtmlxcalendar_uid!=
f._activeInp&&f._isVisible()&&f._activeInp)f._hide();else if(!b._dhtmlxcalendar_uid||!f.i[b._dhtmlxcalendar_uid])f._isSelectorVisible()?f._hideSelector():!f._hasParent&&f._isVisible()&&f._hide()};this._doOnKeyDown=function(a){a=a||event;if(a.keyCode==27||a.keyCode==13)f._isSelectorVisible()?f._hideSelector():f._isVisible()&&!f._hasParent&&f._hide()};this._doOnInpClick=function(a){var a=a||event,b=a.target||a.srcElement;b._dhtmlxcalendar_uid&&(f._nullInInput&&b.value.replace(/\s/g,"").length==0?f.setDate(null):
f._updateDateStr(b.value),f._show(b._dhtmlxcalendar_uid,!0))};this._doOnInpKeyUp=function(a){var a=a||event,b=a.target||a.srcElement;a.keyCode!=13&&b._dhtmlxcalendar_uid&&(f._nullInInput&&b.value.replace(/\s/g,"").length==0?f.setDate(null):f._updateDateStr(b.value))};this._doOnUnload=function(){f.unload()};window.addEventListener?(document.body.addEventListener("click",f._doOnClick,!1),window.addEventListener("keydown",f._doOnKeyDown,!1),window.addEventListener("unload",f._doOnUnload,!1)):(document.body.attachEvent("onclick",
f._doOnClick),document.body.attachEvent("onkeydown",f._doOnKeyDown),window.attachEvent("onunload",f._doOnUnload));this.attachObj=function(a){var b=this.uid();this.i[b]=a;this._attachEventsToObject(b)};this.detachObj=function(a){var b=a._dhtmlxcalendar_uid;if(this.i[b]!=null)this._detachEventsFromObject(b),this.i[b]._dhtmlxcalendar_uid=null,this.i[b]=null,delete this.i[b]};this._attachEventsToObject=function(a){this.i[a]._dhtmlxcalendar_uid=a;window.addEventListener?(this.i[a].addEventListener("click",
f._doOnInpClick,!1),this.i[a].addEventListener("keyup",f._doOnInpKeyUp,!1)):(this.i[a].attachEvent("onclick",f._doOnInpClick),this.i[a].attachEvent("onkeyup",f._doOnInpKeyUp))};this._detachEventsFromObject=function(a){window.addEventListener?(this.i[a].removeEventListener("click",f._doOnInpClick,!1),this.i[a].removeEventListener("keyup",f._doOnInpKeyUp,!1)):(this.i[a].detachEvent("onclick",f._doOnInpClick),this.i[a].detachEvent("onkeyup",f._doOnInpKeyUp))};for(var j in this.i)this._attachEventsToObject(j);
this.evs={};this.attachEvent=function(a,b){var c=this.uid();this.evs[c]={name:String(a).toLowerCase(),func:b};return c};this.detachEvent=function(a){if(this.evs[a])this.evs[a].name=null,this.evs[a].func=null,this.evs[a]=null,delete this.evs[a]};this.callEvent=function(a,b){var c=!0,d=String(a).toLowerCase(),b=b||[],e;for(e in this.evs)if(this.evs[e].name==d)var f=this.evs[e].func.apply(this,b),c=c&&f;return c};this.checkEvent=function(a){var b=!1,c=String(a).toLowerCase(),d;for(d in this.evs)b=b||
this.evs[d].name==c;return b};this.unload=function(){this.uidd=this.uid=this._lastHover=this._dateFormatRE=this._dateFormat=this._activeMonth=this._activeInp=this._activeDateCell=this._activeDate=null;window.addEventListener?(document.body.removeEventListener("click",f._doOnClick,!1),window.removeEventListener("keydown",f._doOnKeyDown,!1),window.removeEventListener("unload",f._doOnUnload,!1)):(document.body.detachEvent("onclick",f._doOnClick),document.body.detachEvent("onkeydown",f._doOnKeyDown),
window.detachEvent("onunload",f._doOnKeyDown));this._doOnUnload=this._doOnKeyDown=this._doOnClick=null;for(var a in this.i)this.i[a]._dhtmlxcalendar_uid=null,window.addEventListener?(this.i[a].removeEventListener("click",f._doOnInpClick,!1),this.i[a].removeEventListener("keyup",f._doOnInpKeyUp,!1)):(this.i[a].detachEvent("onclick",f._doOnInpClick),this.i[a].detachEvent("onkeyup",f._doOnInpKeyUp)),this.i[a]=null,delete this.i[a];this._doOnInpKeyUp=this._doOnInpClick=this.i=null;for(a in this.evs)this.detachEvent(a);
this.callEvent=this.checkEvent=this.detachEvent=this.attachEvent=this.evs=null;this.contMonth.onselectstart=null;this.contMonth.firstChild.firstChild.onclick=null;this.contMonth.firstChild.firstChild.firstChild.onmouseover=null;this.contMonth.firstChild.firstChild.firstChild.onmouseout=null;this.contMonth.firstChild.firstChild.lastChild.onmouseover=null;for(this.contMonth.firstChild.firstChild.lastChild.onmouseout=null;this.contMonth.firstChild.firstChild.childNodes.length>0;)this.contMonth.firstChild.firstChild.removeChild(this.contMonth.firstChild.firstChild.lastChild);
this.contMonth.firstChild.removeChild(this.contMonth.firstChild.firstChild);this.contMonth.removeChild(this.contMonth.firstChild);this.contMonth.parentNode.removeChild(this.contMonth);for(this.contMonth=null;this.contDays.firstChild.childNodes.length>0;)this.contDays.firstChild.removeChild(this.contDays.firstChild.lastChild);this.contDays.removeChild(this.contDays.firstChild);this.contDays.parentNode.removeChild(this.contDays);this.contDays=null;this.contDates.onclick=null;this.contDates.onmouseover=
null;for(this.contDates.onmouseout=null;this.contDates.childNodes.length>0;){for(;this.contDates.lastChild.childNodes.length>0;)this.contDates.lastChild.lastChild._css_date=null,this.contDates.lastChild.lastChild._css_month=null,this.contDates.lastChild.lastChild._css_weekend=null,this.contDates.lastChild.lastChild._css_hover=null,this.contDates.lastChild.lastChild._date=null,this.contDates.lastChild.lastChild._q=null,this.contDates.lastChild.lastChild._w=null,this.contDates.lastChild.removeChild(this.contDates.lastChild.lastChild);
this.contDates.removeChild(this.contDates.lastChild)}this.contDates.parentNode.removeChild(this.contDates);this.contDates=null;for(this.contTime.firstChild.firstChild.onclick=null;this.contTime.firstChild.firstChild.childNodes.length>0;)this.contTime.firstChild.firstChild.removeChild(this.contTime.firstChild.firstChild.lastChild);this.contTime.firstChild.removeChild(this.contTime.firstChild.firstChild);this.contTime.removeChild(this.contTime.firstChild);this.contTime.parentNode.removeChild(this.contTime);
this._lastHover=this.contTime=null;if(this.msCont){this._msActive=this.msCont.onclick=null;for(a in this._msCells)this._msCells[a]._cell=null,this._msCells[a]._month=null,this._msCells[a].parentNode.removeChild(this._msCells[a]),this._msCells[a]=null;for(this._msCells=null;this.msCont.childNodes.length>0;)this.msCont.removeChild(this.msCont.lastChild);this.msCont.parentNode.removeChild(this.msCont);this.msCont=null}if(this.ysCont){this.ysCont.onclick=null;for(a in this._ysCells)this._ysCells[a]._cell=
null,this._ysCells[a]._year=null,this._ysCells[a].parentNode.removeChild(this._ysCells[a]),this._ysCells[a]=null;for(this._ysCells=null;this.ysCont.childNodes.length>0;)this.ysCont.removeChild(this.ysCont.lastChild);this.ysCont.parentNode.removeChild(this.ysCont);this.ysCont=null}if(this.hsCont){this._hsActive=this.hsCont.onclick=null;for(a in this._hsCells)this._hsCells[a]._cell=null,this._hsCells[a]._hours=null,this._hsCells[a].parentNode.removeChild(this._hsCells[a]),this._hsCells[a]=null;for(this._hsCells=
null;this.hsCont.childNodes.length>0;)this.hsCont.removeChild(this.hsCont.lastChild);this.hsCont.parentNode.removeChild(this.hsCont);this.hsCont=null}if(this.rsCont){this._rsActive=this.rsCont.onclick=null;for(a in this._rsCells)this._rsCells[a]._cell=null,this._rsCells[a]._minutes=null,this._rsCells[a].parentNode.removeChild(this._rsCells[a]),this._rsCells[a]=null;for(this._rsCells=null;this.rsCont.childNodes.length>0;)this.rsCont.removeChild(this.rsCont.lastChild);this.rsCont.parentNode.removeChild(this.rsCont);
this.rsCont=null}if(this._selCover)this._selCover.parentNode.removeChild(this._selCover),this._selCover=null;if(this._sel){for(a in this._sel._ta)this._sel._ta[a]=null;this._sel._ta=null;this._sel._t=null;this._sel.onmouseover=null;for(this._sel.onmouseout=null;this._sel.firstChild.firstChild.firstChild.childNodes.length>0;)this._sel.firstChild.firstChild.firstChild.lastChild.onclick=null,this._sel.firstChild.firstChild.firstChild.lastChild.onmouseover=null,this._sel.firstChild.firstChild.firstChild.lastChild.onmouseout=
null,this._sel.firstChild.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild.lastChild);this._sel.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild);for(this._sel.firstChild.removeChild(this._sel.firstChild.firstChild);this._sel.childNodes.length>0;)this._sel.removeChild(this._sel.lastChild);this._sel.parentNode.removeChild(this._sel);this._sel=null}this.base.onclick=null;this.base.parentNode.removeChild(this.base);this.unload=this.showTime=this.show=
this.setDateFormat=this.setDate=this.hideTime=this.hide=this._updateYearsList=this._updateVisibleMinutes=this._updateVisibleHours=this._updateDateStr=this._updateCellStyle=this._updateActiveYear=this._updateActiveMonth=this._updateActiveMinutes=this._updateActiveHours=this._strToDate=this._showSelector=this._show=this._scrollYears=this._posGetOffsetSum=this._posGetOffsetRect=this._posGetOffset=this._isVisible=this._isSelectorVisible=this._initSelector=this._hideSelector=this._hide=this._getTop=this._getLeft=
this._fixLength=this._drawMonth=this._doOnSelectorShow=this._doOnSelectorChange=this._clearSelHover=this._clearDayHover=this.base=null;for(a in this)delete this[a];a=f=null};this.setDate(this._activeDate);return this}dhtmlXCalendarObject.prototype.setYearsRange=function(){};dhtmlXCalendarObject.prototype.lang="en";
dhtmlXCalendarObject.prototype.langData={en:{dateformat:"%Y-%m-%d",monthesFNames:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),monthesSNames:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),daysFNames:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),daysSNames:"Su,Mo,Tu,We,Th,Fr,Sa".split(","),weekstart:1}};
dhtmlXCalendarObject.prototype.enableIframe=function(a){if(a==!0){if(!this._ifr)this._ifr=document.createElement("IFRAME"),this._ifr.frameBorder=0,this._ifr.border=0,this._ifr.setAttribute("src","javascript:false;"),this._ifr.className="dhtmlxcalendar_ifr",this._ifr.onload=function(){this.onload=null;this.contentWindow.document.open("text/html","replace");this.contentWindow.document.write("<html><head><style>html,body{width:100%;height:100%;overflow:hidden;margin:0px;}</style></head><body</body></html>")},
this.base.parentNode.insertBefore(this._ifr,this.base),this._ifrSize()}else if(this._ifr)this._ifr.parentNode.removeChild(this._ifr),this._ifr=null};dhtmlXCalendarObject.prototype._ifrSize=function(){if(this._ifr)this._ifr.style.left=this.base.style.left,this._ifr.style.top=this.base.style.top,this._ifr.style.width=this.base.offsetWidth+"px",this._ifr.style.height=this.base.offsetHeight+"px"};dhtmlxCalendarObject=dhtmlXCalendarObject;function dhtmlXAccordionItem(){}
function dhtmlXAccordion(a,c){if(window.dhtmlXContainer){var b=this;this.skin=c!=null?c:"dhx_skyblue";if(a==document.body){this._isAccFS=!0;document.body.className+=" dhxacc_fullscreened";var d=document.createElement("DIV");d.className="dhxcont_global_layout_area";a.appendChild(d);this.cont=new dhtmlXContainer(a);this.cont.setContent(d);a.adjustContent(a,0);this.base=document.createElement("DIV");this.base.className="dhx_acc_base_"+this.skin;this.base.style.overflow="hidden";this.base.style.position=
"absolute";this._adjustToFullScreen=function(){this.base.style.left="2px";this.base.style.top="2px";this.base.style.width=parseInt(d.childNodes[0].style.width)-4+"px";this.base.style.height=parseInt(d.childNodes[0].style.height)-4+"px"};this._adjustToFullScreen();d.childNodes[0].appendChild(this.base);this._resizeTM=null;this._resizeTMTime=400;this._doOnResize=function(){window.clearTimeout(b._resizeTM);b._resizeTM=window.setTimeout(function(){b._adjustAccordion()},b._resizeTMTime)};this._adjustAccordion=
function(){document.body.adjustContent(document.body,0);this._adjustToFullScreen();this.setSizes()};dhtmlxEvent(window,"resize",this._doOnResize)}else this.base=typeof a=="string"?document.getElementById(a):a,this.base.className="dhx_acc_base_"+this.skin,this.base.innerHTML="";this.w=this.base.offsetWidth;this.h=this.base.offsetHeight;this.skinParams={dhx_blue:{cell_height:24,cell_space:1,content_offset:1},dhx_skyblue:{cell_height:27,cell_space:-1,content_offset:-1},dhx_black:{cell_height:24,cell_space:1,
content_offset:1},dhx_web:{cell_height:26,cell_space:9,content_offset:0,cell_pading_max:1,cell_pading_min:0}};this.sk=this.skinParams[this.skin];this.setSkinParameters=function(a,b){isNaN(a)||(this.sk.cell_space=a);isNaN(b)||(this.sk.content_offset=b);this._reopenItem()};this.setSkin=function(a){if(this.skinParams[a]){this.skin=a;this.sk=this.skinParams[this.skin];this.base.className="dhx_acc_base_"+this.skin+(this._r?" dhx_acc_rtl":"");for(var b in this.idPull)this.idPull[b].skin=this.skin;this._reopenItem()}};
this.idPull={};this.opened=null;this.cells=function(a){return this.idPull[a]==null?null:this.idPull[a]};this.itemH=90;this.multiMode=!1;this.enableMultiMode=function(){var a=0,b;for(b in this.idPull)a++;if(a==0)this.userOffset||(this.skinParams.dhx_skyblue.cell_space=3),this.multiMode=!0};this.userOffset=!1;this.setOffset=function(a,b){this.userOffset=!0;isNaN(a)||(this.skinParams[this.skin].cell_space=a);isNaN(b)||(this.skinParams[this.skin].content_offset=b);this.setSizes()};this.imagePath="";this.setIconsPath=
function(a){this.imagePath=a};this.addItem=function(a,c){var d=document.createElement("DIV");d.className="dhx_acc_item";d.dir="ltr";d._isAcc=!0;d.skin=this.skin;this.base.appendChild(d);if(this.multiMode)d.h=this.itemH;var f=document.createElement("DIV");f._idd=a;f.className="dhx_acc_item_label";f.innerHTML="<span>"+c+"</span><div class='dhx_acc_item_label_btmbrd'>&nbsp;</div><div class='dhx_acc_item_arrow'></div><div class='dhx_acc_hdr_line_l'></div><div class='dhx_acc_hdr_line_r'></div>";f.onselectstart=
function(a){a=a||event;a.returnValue=!1};f.onclick=function(){if(b.multiMode||!b.idPull[this._idd]._isActive)b.multiMode?b.idPull[this._idd]._isActive?b.checkEvent("onBeforeActive")?b.callEvent("onBeforeActive",[this._idd,"close"])&&b.closeItem(this._idd,"dhx_accord_outer_event"):b.closeItem(this._idd,"dhx_accord_outer_event"):b.checkEvent("onBeforeActive")?b.callEvent("onBeforeActive",[this._idd,"open"])&&b.openItem(this._idd,"dhx_accord_outer_event"):b.openItem(this._idd,"dhx_accord_outer_event"):
b.checkEvent("onBeforeActive")?b.callEvent("onBeforeActive",[this._idd,"open"])&&b.openItem(this._idd,"dhx_accord_outer_event"):b.openItem(this._idd,"dhx_accord_outer_event")};f.onmouseover=function(){this.className="dhx_acc_item_label dhx_acc_item_lavel_hover"};f.onmouseout=function(){this.className="dhx_acc_item_label"};d.appendChild(f);var i=document.createElement("DIV");i.className="dhxcont_global_content_area";d.appendChild(i);var j=new dhtmlXContainer(d);j.setContent(i);d.adjustContent(d,this.sk.cell_height+
this.sk.content_offset);d._id=a;this.idPull[a]=d;d.getId=function(){return this._id};d.setText=function(a){b.setText(this._id,a)};d.getText=function(){return b.getText(this._id)};d.open=function(){b.openItem(this._id)};d.isOpened=function(){return b.isActive(this._id)};d.close=function(){b.closeItem(this._id)};d.setIcon=function(a){b.setIcon(this._id,a)};d.clearIcon=function(){b.clearIcon(this._id)};d.dock=function(){b.dockItem(this._id)};d.undock=function(){b.undockItem(this._id)};d.show=function(){b.showItem(this._id)};
d.hide=function(){b.hideItem(this._id)};d.setHeight=function(a){b.setItemHeight(this._id,a)};d.moveOnTop=function(){b.moveOnTop(this._id)};d._doOnAttachMenu=function(){b._reopenItem()};d._doOnAttachToolbar=function(){b._reopenItem()};d._doOnAttachStatusBar=function(){b._reopenItem()};d._doOnFrameContentLoaded=function(){b.callEvent("onContentLoaded",[this])};this.openItem(a);this.multiMode||this._defineLastItem();return d};this.openItem=function(a,b,c){if(!this._openBuzy)if(this._enableOpenEffect&&
!c)(!this.multiMode||!this.idPull[a]._isActive)&&this._openWithEffect(a,null,null,null,null,b);else if(this.multiMode)for(var d in this.idPull){if(this.idPull[d]._isActive||d==a)this.idPull[d].style.height=this.idPull[d].h+"px",this.idPull[d].childNodes[1].style.display="",this.skin=="dhx_web"&&this.idPull[d]._setPadding(this.skinParams[this.skin].cell_pading_max,"dhxcont_acc_dhx_web"),this.idPull[d].adjustContent(this.idPull[d],this.sk.cell_height+this.sk.content_offset,null,null,this.idPull[d]==
this._lastVisible()&&this.skin!="dhx_web"?0:this.sk.cell_space),this.idPull[d].updateNestedObjects(),this.idPull[d]._isActive=!0,this._updateArrows(),b=="dhx_accord_outer_event"&&d==a&&this.callEvent("onActive",[a,!0])}else if(!a||!this.idPull[a]._isActive||c){var i=0;for(d in this.idPull)if(this.idPull[d].style.height=this.sk.cell_height+(this.idPull[d]!=this._lastVisible()&&d!=a?this.sk.cell_space:0)+"px",d!=a)this.idPull[d].childNodes[1].style.display="none",this.skin=="dhx_web"&&this.idPull[d]._setPadding(this.skinParams[this.skin].cell_pading_min,
""),this.idPull[d]._isActive=!1,i+=this.idPull[d].offsetHeight;i=this.base.offsetHeight-i;if(a)this.idPull[a].style.height=i+"px",this.idPull[a].childNodes[1].style.display="",this.skin=="dhx_web"&&this.idPull[a]._setPadding(this.skinParams[this.skin].cell_pading_max,"dhxcont_acc_dhx_web"),this.idPull[a].adjustContent(this.idPull[a],this.sk.cell_height+this.sk.content_offset,null,null,this.idPull[a]==this._lastVisible()?0:this.sk.cell_space),this.idPull[a].updateNestedObjects(),this.idPull[a]._isActive=
!0,b=="dhx_accord_outer_event"&&this.callEvent("onActive",[a,!0]);this._updateArrows()}};this._lastVisible=function(){for(var a=null,b=this.base.childNodes.length-1;b>=0;b--)!this.base.childNodes[b]._isHidden&&!a&&(a=this.base.childNodes[b]);return a};this.closeItem=function(a,b){if(this.idPull[a]!=null&&this.idPull[a]._isActive&&!this._openBuzy)this._enableOpenEffect?this._openWithEffect(this.multiMode?a:null,null,null,null,null,b):(this.idPull[a].style.height=this.sk.cell_height+(this.idPull[a]!=
this._lastVisible()?this.sk.cell_space:0)+"px",this.idPull[a].childNodes[1].style.display="none",this.skin=="dhx_web"&&this.idPull[a]._setPadding(this.skinParams[this.skin].cell_pading_min,""),this.idPull[a]._isActive=!1,b=="dhx_accord_outer_event"&&this.callEvent("onActive",[a,!1]),this._updateArrows())};this._updateArrows=function(){for(var a in this.idPull){for(var b=this.idPull[a].childNodes[0],c=null,d=0;d<b.childNodes.length;d++)String(b.childNodes[d].className).search("dhx_acc_item_arrow")!=
-1&&(c=b.childNodes[d]);if(c!=null)c.className="dhx_acc_item_arrow "+(this.idPull[a]._isActive?"item_opened":"item_closed"),c=null}};this.setText=function(a,c,d){if(b.idPull[a]!=null){for(var f=b.idPull[a].childNodes[0],i=null,j=0;j<f.childNodes.length;j++)f.childNodes[j].tagName!=null&&String(f.childNodes[j].tagName).toLowerCase()=="span"&&(i=f.childNodes[j]);isNaN(d)?i.innerHTML=c:(i.style.paddingLeft=d+"px",i.style.paddingRight=d+"px")}};this.getText=function(a){if(b.idPull[a]!=null){for(var c=
b.idPull[a].childNodes[0],d=null,f=0;f<c.childNodes.length;f++)c.childNodes[f].tagName!=null&&String(c.childNodes[f].tagName).toLowerCase()=="span"&&(d=c.childNodes[f]);return d.innerHTML}};this._initWindows=function(a){if(window.dhtmlXWindows){if(!this.dhxWins&&(this.dhxWins=new dhtmlXWindows,this.dhxWins.setSkin(this.skin),this.dhxWins.setImagePath(this.imagePath),this.dhxWinsIdPrefix="",!a))return;var b=this.dhxWinsIdPrefix+a;if(this.dhxWins.window(b))this.dhxWins.window(b).show();else{var c=this,
d=this.dhxWins.createWindow(b,20,20,320,200);d.setText(this.getText(a));d.button("close").hide();d.attachEvent("onClose",function(a){a.hide()});d.addUserButton("dock",99,this.dhxWins.i18n.dock,"dock");d.button("dock").attachEvent("onClick",function(){c.cells(a).dock()})}}};this.dockWindow=function(a){if(this.idPull[a]._isUnDocked&&this.dhxWins&&this.dhxWins.window(this.dhxWinsIdPrefix+a))this.dhxWins.window(this.dhxWinsIdPrefix+a).moveContentTo(this.idPull[a]),this.dhxWins.window(this.dhxWinsIdPrefix+
a).close(),this.idPull[a]._isUnDocked=!1,this.showItem(a),this.callEvent("onDock",[a])};this.undockWindow=function(a){if(!this.idPull[a]._isUnDocked)this._initWindows(a),this.idPull[a].moveContentTo(this.dhxWins.window(this.dhxWinsIdPrefix+a)),this.idPull[a]._isUnDocked=!0,this.hideItem(a),this.callEvent("onUnDock",[a])};this.setSizes=function(){this._reopenItem()};this.showItem=function(a){if(this.idPull[a]!=null&&this.idPull[a]._isHidden)this.idPull[a]._isUnDocked?this.dockItem(a):(this.idPull[a].className=
"dhx_acc_item",this.idPull[a]._isHidden=!1,this._defineLastItem(),this._reopenItem())};this.hideItem=function(a){if(this.idPull[a]!=null&&!this.idPull[a]._isHidden)this.closeItem(a),this.idPull[a].className="dhx_acc_item_hidden",this.idPull[a]._isHidden=!0,this._defineLastItem(),this._reopenItem()};this._reopenItem=function(){var a=null,b;for(b in this.idPull)this.idPull[b]._isActive&&!this.idPull[b]._isHidden&&(a=b);this.openItem(a,null,!0)};this.forEachItem=function(a){for(var b in this.idPull)a(this.idPull[b])};
this._enableOpenEffect=!1;this._openStep=10;this._openStepIncrement=5;this._openStepTimeout=10;this._openBuzy=!1;this.setEffect=function(a){this._enableOpenEffect=a==!0?!0:!1};this._openWithEffect=function(a,b,c,d,i,j){if(this.multiMode){if(!i)this._openBuzy=!0,i=this._openStep,this.idPull[a]._isActive?(b=a,a=null,c=this.sk.cell_height+(this.idPull[b]!=this._lastVisible()?this.sk.cell_space:0),this.idPull[b].childNodes[1].style.display=""):(d=this.idPull[a].h,this.idPull[a].childNodes[1].style.display=
"");var k=!1;if(a){var l=parseInt(this.idPull[a].style.height)+i;l>d&&(l=d,k=!0);this.idPull[a].style.height=l+"px"}if(b)l=parseInt(this.idPull[b].style.height)-i,l<c&&(l=c,k=!0),this.idPull[b].style.height=l+"px";i+=this._openStepIncrement;if(k){if(a)this.idPull[a].adjustContent(this.idPull[a],this.sk.cell_height+this.sk.content_offset,null,null,this.idPull[a]==this._lastVisible()?0:this.sk.cell_space),this.idPull[a].updateNestedObjects(),this.idPull[a]._isActive=!0;if(b)this.idPull[b].childNodes[1].style.display=
"none",this.idPull[b]._isActive=!1;this._updateArrows();this._openBuzy=!1;a&&j=="dhx_accord_outer_event"&&this.callEvent("onActive",[a,!0]);b&&j=="dhx_accord_outer_event"&&this.callEvent("onActive",[b,!1])}else{var m=this;window.setTimeout(function(){m._openWithEffect(a,b,c,d,i,j)},this._openStepTimeout)}}else{if(!i&&(this._openBuzy=!0,i=this._openStep,a))this.idPull[a].childNodes[1].style.display="";if(!b||!c||!d){var d=c=0,o;for(o in this.idPull){var n=this.sk.cell_height+(this.idPull[o]!=this._lastVisible()&&
o!=a?this.sk.cell_space:0);this.idPull[o]._isActive&&a!=o&&(b=o,c=n);o!=a&&(d+=n)}d=this.base.offsetHeight-d}k=!1;if(a){var p=parseInt(this.idPull[a].style.height)+i;p>d&&(k=!0)}if(b){var r=parseInt(this.idPull[b].style.height)-i;r<c&&(k=!0)}i+=this._openStepIncrement;k&&(p=d,r=c);if(b)this.idPull[b].style.height=r+"px";if(a)this.idPull[a].style.height=p+"px";if(k){if(b)this.idPull[b].childNodes[1].style.display="none",this.idPull[b]._isActive=!1;if(a)this.idPull[a].adjustContent(this.idPull[a],this.sk.cell_height+
this.sk.content_offset,null,null,this.idPull[a]==this._lastVisible()?0:this.sk.cell_space),this.idPull[a].updateNestedObjects(),this.idPull[a]._isActive=!0;this._updateArrows();this._openBuzy=!1;j=="dhx_accord_outer_event"&&a&&this.callEvent("onActive",[a,!0])}else m=this,window.setTimeout(function(){m._openWithEffect(a,b,c,d,i,j)},this._openStepTimeout)}};this.setActive=function(a){this.openItem(a)};this.isActive=function(a){return this.idPull[a]._isActive===!0?!0:!1};this.dockItem=function(a){this.dockWindow(a)};
this.undockItem=function(a){this.undockWindow(a)};this.setItemHeight=function(a,b){if(this.multiMode&&!isNaN(b))this.idPull[a].h=b,this._reopenItem()};this.setIcon=function(a,b){if(this.idPull[a]!=null){for(var c=this.idPull[a].childNodes[0],d=null,i=0;i<c.childNodes.length;i++)c.childNodes[i].className=="dhx_acc_item_icon"&&(d=c.childNodes[i]);if(d==null)d=document.createElement("IMG"),d.className="dhx_acc_item_icon",c.insertBefore(d,c.childNodes[0]),this.setText(a,null,20);d.src=this.imagePath+
b}};this.clearIcon=function(a){if(this.idPull[a]!=null){for(var b=this.idPull[a].childNodes[0],c=null,d=0;d<b.childNodes.length;d++)b.childNodes[d].className=="dhx_acc_item_icon"&&(c=b.childNodes[d]);c!=null&&(b.removeChild(c),c=null,this.setText(a,null,0))}};this.moveOnTop=function(a){this.idPull[a]&&!(this.base.childNodes.length<=1)&&(this.base.insertBefore(this.idPull[a],this.base.childNodes[0]),this.setSizes())};this._defineLastItem=function(){if(!this.multiMode)for(var a=!1,b=this.base.childNodes.length-
1;b>=0;b--)if(this.base.childNodes[b].className.search("last_item")>=0){if(this.base.childNodes[b]._isHidden||a)this.base.childNodes[b].className=String(this.base.childNodes[b].className).replace(/last_item/gi,"")}else!this.base.childNodes[b]._isHidden&&!a&&(this.base.childNodes[b].className+=" last_item",a=!0)};this.removeItem=function(a){var b=this.idPull[a],c=b.childNodes[0];c.onclick=null;c.onmouseover=null;c.onmouseout=null;c.onselectstart=null;c._idd=null;c.className="";for(b._dhxContDestruct();c.childNodes.length>
0;)c.removeChild(c.childNodes[0]);c.parentNode&&c.parentNode.removeChild(c);for(c=null;b.childNodes.length>0;)b.removeChild(b.childNodes[0]);b._dhxContDestruct=null;b._doOnAttachMenu=null;b._doOnAttachToolbar=null;b._doOnAttachStatusBar=null;b.clearIcon=null;b.close=null;b.dock=null;b.getId=null;b.getText=null;b.hide=null;b.isOpened=null;b.open=null;b.setHeight=null;b.setIcon=null;b.setText=null;b.show=null;b.undock=null;b.parentNode&&b.parentNode.removeChild(b);b=null;this.idPull[a]=null;try{delete this.idPull[a]}catch(d){}};
this.unload=function(){for(var a in this.skinParams){this.skinParams[a]=null;try{delete this.skinParams[a]}catch(b){}}this.skinParams=null;for(a in this.idPull)this.removeItem(a);this.userOffset=this.unload=this.undockWindowunload=this.undockWindow=this.undockItem=this.w=this.skin=this.showItem=this.setText=this.setSkinParameters=this.setSkin=this.setSizes=this.setOffset=this.setItemHeight=this.setIconsPath=this.setIcon=this.setEffect=this.setActive=this.removeItem=this.openItem=this.multiMode=this.itemH=
this.isActive=this.imagePath=this.hideItem=this.h=this.getText=this.forEachItem=this.eventCatcher=this.enableMultiMode=this.dockWindow=this.dockItem=this.detachEvent=this.closeItem=this.clearIcon=this.checkEvent=this.cells=this.callEvent=this.attachEvent=this.addItem=this._updateArrows=this._reopenItem=this._lastVisible=this._initWindows=this.sk=this.idPull=null;if(this._isAccFS==!0)_isIE?window.detachEvent("onresize",this._doOnResize):window.removeEventListener("resize",this._doOnResize,!1),this._resizeTMTime=
this._resizeTM=this._adjustToFullScreen=this._adjustAccordion=this._doOnResize=this._isAccFS=null,document.body.className=String(document.body.className).replace("dhxacc_fullscreened",""),this.cont.obj._dhxContDestruct(),this.cont.dhxcont.parentNode&&this.cont.dhxcont.parentNode.removeChild(this.cont.dhxcont),this.cont.dhxcont=null,this.cont=this.cont.setContent=null;if(this.dhxWins)this.dhxWins.unload(),this.dhxWins=null;this.base.className="";this.base=null;for(a in this)try{delete this[a]}catch(c){}};
this._initWindows();dhtmlxEventable(this);return this}else alert(this.i18n.dhxcontalert)}dhtmlXAccordion.prototype.i18n={dhxcontalert:"dhtmlxcontainer.js is missed on the page"};
(function(){dhtmlx.extend_api("dhtmlXAccordion",{_init:function(a){return[a.parent,a.skin]},icon_path:"setIconsPath",items:"_items",effect:"setEffect",multi_mode:"enableMultiMode"},{_items:function(a){for(var c=[],b=[],d=0;d<a.length;d++){var e=a[d];this.addItem(e.id,e.text);e.img&&this.cells(e.id).setIcon(e.img);e.height&&this.cells(e.id).setHeight(e.height);if(e.open===!0)c[c.length]=e.id;if(e.open===!1)b[b.length]=e.id}for(var h=0;h<c.length;h++)this.cells(c[h]).open();for(h=0;h<b.length;h++)this.cells(b[h]).close()}})})();
function dataProcessor(a){this.serverProcessor=a;this.action_param="!nativeeditor_status";this.object=null;this.updatedRows=[];this.autoUpdate=!0;this.updateMode="cell";this._tMode="GET";this.post_delim="_";this._waitMode=0;this._in_progress={};this._invalid={};this.mandatoryFields=[];this.messages=[];this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",clear:"font-weight:normal;text-decoration:none;"};
this.enableUTFencoding(!0);dhtmlxEventable(this);return this}
dataProcessor.prototype={setTransactionMode:function(a,c){this._tMode=a;this._tSend=c},escape:function(a){return this._utf?encodeURIComponent(a):escape(a)},enableUTFencoding:function(a){this._utf=convertStringToBoolean(a)},setDataColumns:function(a){this._columns=typeof a=="string"?a.split(","):a},getSyncState:function(){return!this.updatedRows.length},enableDataNames:function(a){this._endnm=convertStringToBoolean(a)},enablePartialDataSend:function(a){this._changed=convertStringToBoolean(a)},setUpdateMode:function(a,
c){this.autoUpdate=a=="cell";this.updateMode=a;this.dnd=c},ignore:function(a,c){this._silent_mode=!0;a.call(c||window);this._silent_mode=!1},setUpdated:function(a,c,b){if(!this._silent_mode){var d=this.findRow(a),b=b||"updated",e=this.obj.getUserData(a,this.action_param);e&&b=="updated"&&(b=e);c?(this.set_invalid(a,!1),this.updatedRows[d]=a,this.obj.setUserData(a,this.action_param,b),this._in_progress[a]&&(this._in_progress[a]="wait")):this.is_invalid(a)||(this.updatedRows.splice(d,1),this.obj.setUserData(a,
this.action_param,""));c||this._clearUpdateFlag(a);this.markRow(a,c,b);c&&this.autoUpdate&&this.sendData(a)}},_clearUpdateFlag:function(){},markRow:function(a,c,b){var d="",e=this.is_invalid(a);e&&(d=this.styles[e],c=!0);if(this.callEvent("onRowMark",[a,c,b,e])&&(d=this.styles[c?b:"clear"]+d,this.obj[this._methods[0]](a,d),e&&e.details)){d+=this.styles[e+"_cell"];for(var h=0;h<e.details.length;h++)if(e.details[h])this.obj[this._methods[1]](a,h,d)}},getState:function(a){return this.obj.getUserData(a,
this.action_param)},is_invalid:function(a){return this._invalid[a]},set_invalid:function(a,c,b){b&&(c={value:c,details:b,toString:function(){return this.value.toString()}});this._invalid[a]=c},checkBeforeUpdate:function(){return!0},sendData:function(a){if(!this._waitMode||!(this.obj.mytype=="tree"||this.obj._h2)){this.obj.editStop&&this.obj.editStop();if(typeof a=="undefined"||this._tSend)return this.sendAllData();if(this._in_progress[a])return!1;this.messages=[];if(!this.checkBeforeUpdate(a)&&this.callEvent("onValidationError",
[a,this.messages]))return!1;this._beforeSendData(this._getRowData(a),a)}},_beforeSendData:function(a,c){if(!this.callEvent("onBeforeUpdate",[c,this.getState(c),a]))return!1;this._sendData(a,c)},serialize:function(a,c){if(typeof a=="string")return a;if(typeof c!="undefined")return this.serialize_one(a,"");else{var b=[],d=[],e;for(e in a)a.hasOwnProperty(e)&&(b.push(this.serialize_one(a[e],e+this.post_delim)),d.push(e));b.push("ids="+this.escape(d.join(",")));return b.join("&")}},serialize_one:function(a,
c){if(typeof a=="string")return a;var b=[],d;for(d in a)a.hasOwnProperty(d)&&b.push(this.escape((c||"")+d)+"="+this.escape(a[d]));return b.join("&")},_sendData:function(a,c){if(a){if(!this.callEvent("onBeforeDataSending",c?[c,this.getState(c),a]:[null,null,a]))return!1;c&&(this._in_progress[c]=(new Date).valueOf());var b=new dtmlXMLLoaderObject(this.afterUpdate,this,!0),d=this.serverProcessor+(this._user?getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,
"version")].join("&"):"");this._tMode!="POST"?b.loadXML(d+(d.indexOf("?")!=-1?"&":"?")+this.serialize(a,c)):b.loadXML(d,!0,this.serialize(a,c));this._waitMode++}},sendAllData:function(){if(this.updatedRows.length){this.messages=[];for(var a=!0,c=0;c<this.updatedRows.length;c++)a&=this.checkBeforeUpdate(this.updatedRows[c]);if(!a&&!this.callEvent("onValidationError",["",this.messages]))return!1;if(this._tSend)this._sendData(this._getAllData());else for(c=0;c<this.updatedRows.length;c++)if(!this._in_progress[this.updatedRows[c]]&&
!this.is_invalid(this.updatedRows[c])&&(this._beforeSendData(this._getRowData(this.updatedRows[c]),this.updatedRows[c]),this._waitMode&&(this.obj.mytype=="tree"||this.obj._h2)))break}},_getAllData:function(){for(var a={},c=!1,b=0;b<this.updatedRows.length;b++){var d=this.updatedRows[b];!this._in_progress[d]&&!this.is_invalid(d)&&this.callEvent("onBeforeUpdate",[d,this.getState(d)])&&(a[d]=this._getRowData(d,d+this.post_delim),c=!0,this._in_progress[d]=(new Date).valueOf())}return c?a:null},setVerificator:function(a,
c){this.mandatoryFields[a]=c||function(a){return a!=""}},clearVerificator:function(a){this.mandatoryFields[a]=!1},findRow:function(a){for(var c=0,c=0;c<this.updatedRows.length;c++)if(a==this.updatedRows[c])break;return c},defineAction:function(a,c){if(!this._uActions)this._uActions=[];this._uActions[a]=c},afterUpdateCallback:function(a,c,b,d){var e=a,h=b!="error"&&b!="invalid";h||this.set_invalid(a,b);if(this._uActions&&this._uActions[b]&&!this._uActions[b](d))return delete this._in_progress[e];this._in_progress[e]!=
"wait"&&this.setUpdated(a,!1);var g=a;switch(b){case "inserted":case "insert":c!=a&&(this.obj[this._methods[2]](a,c),a=c);break;case "delete":case "deleted":return this.obj.setUserData(a,this.action_param,"true_deleted"),this.obj[this._methods[3]](a),delete this._in_progress[e],this.callEvent("onAfterUpdate",[a,b,c,d])}this._in_progress[e]!="wait"?(h&&this.obj.setUserData(a,this.action_param,""),delete this._in_progress[e]):(delete this._in_progress[e],this.setUpdated(c,!0,this.obj.getUserData(a,
this.action_param)));this.callEvent("onAfterUpdate",[a,b,c,d])},afterUpdate:function(a,c,b,d,e){e.getXMLTopNode("data");if(e.xmlDoc.responseXML){for(var h=e.doXPath("//data/action"),g=0;g<h.length;g++){var f=h[g],i=f.getAttribute("type"),j=f.getAttribute("sid"),k=f.getAttribute("tid");a.afterUpdateCallback(j,k,i,f)}a.finalizeUpdate()}},finalizeUpdate:function(){this._waitMode&&this._waitMode--;(this.obj.mytype=="tree"||this.obj._h2)&&this.updatedRows.length&&this.sendData();this.callEvent("onAfterUpdateFinish",
[]);this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(a){this.obj=a;this.obj._dp_init&&this.obj._dp_init(this)},setOnAfterUpdate:function(a){this.attachEvent("onAfterUpdate",a)},enableDebug:function(){},setOnBeforeUpdateHandler:function(a){this.attachEvent("onBeforeDataSending",a)},setAutoUpdate:function(a,c){a=a||2E3;this._user=c||(new Date).valueOf();this._need_update=!1;this._loader=null;this._update_busy=!1;this.attachEvent("onAfterUpdate",function(a,b,c,g){this.afterAutoUpdate(a,
b,c,g)});this.attachEvent("onFullSync",function(){this.fullSync()});var b=this;window.setInterval(function(){b.loadUpdate()},a)},afterAutoUpdate:function(a,c){return c=="collision"?(this._need_update=!0,!1):!0},fullSync:function(){if(this._need_update==!0)this._need_update=!1,this.loadUpdate();return!0},getUpdates:function(a,c){if(this._update_busy)return!1;else this._update_busy=!0;this._loader=this._loader||new dtmlXMLLoaderObject(!0);this._loader.async=!0;this._loader.waitCall=c;this._loader.loadXML(a)},
_v:function(a){return a.firstChild?a.firstChild.nodeValue:""},_a:function(a){for(var c=[],b=0;b<a.length;b++)c[b]=this._v(a[b]);return c},loadUpdate:function(){var a=this,c=this.obj.getUserData(0,"version"),b=this.serverProcessor+getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+c].join("&"),b=b.replace("editing=true&","");this.getUpdates(b,function(){var b=a._loader.doXPath("//userdata");a.obj.setUserData(0,"version",a._v(b[0]));var c=a._loader.doXPath("//update");if(c.length){a._silent_mode=
!0;for(var h=0;h<c.length;h++){var g=c[h].getAttribute("status"),f=c[h].getAttribute("id"),i=c[h].getAttribute("parent");switch(g){case "inserted":a.callEvent("insertCallback",[c[h],f,i]);break;case "updated":a.callEvent("updateCallback",[c[h],f,i]);break;case "deleted":a.callEvent("deleteCallback",[c[h],f,i])}}a._silent_mode=!1}a._update_busy=!1;a=null})}};dhtmlx.skin="dhx_skyblue";
